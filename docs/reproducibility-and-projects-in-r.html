<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Week 4 Reproducibility and Projects in R | EPI 563: Spatial Epidemiology, Fall 2021</title>
<meta name="author" content="Michael Kramer">
<meta name="description" content="Additional Resources R Markdown Cheatsheet Comprehensive guide to using R Markdown Chapter within the R Markdown guide specific to Notebooks Epidemiologist R Handbook - Working with projects...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="Week 4 Reproducibility and Projects in R | EPI 563: Spatial Epidemiology, Fall 2021">
<meta property="og:type" content="book">
<meta property="og:description" content="Additional Resources R Markdown Cheatsheet Comprehensive guide to using R Markdown Chapter within the R Markdown guide specific to Notebooks Epidemiologist R Handbook - Working with projects...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Week 4 Reproducibility and Projects in R | EPI 563: Spatial Epidemiology, Fall 2021">
<meta name="twitter:description" content="Additional Resources R Markdown Cheatsheet Comprehensive guide to using R Markdown Chapter within the R Markdown guide specific to Notebooks Epidemiologist R Handbook - Working with projects...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.10/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.5.1/tabs.js"></script><script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">EPI 563: Spatial Epidemiology, Fall 2021</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">How to use this eBook</a></li>
<li class="book-part">Getting ready…</li>
<li><a class="" href="software-installation.html">Software installation</a></li>
<li><a class="" href="installing-packages-for-this-course.html">Installing packages for this course</a></li>
<li class="book-part">Weekly Modules</li>
<li><a class="" href="locating-spatial-epidemiology.html"><span class="header-section-number">1</span> Locating Spatial Epidemiology</a></li>
<li><a class="" href="cartography-for-epidemiology-i.html"><span class="header-section-number">2</span> Cartography for Epidemiology I</a></li>
<li><a class="" href="cartography-for-epidemiology-ii.html"><span class="header-section-number">3</span> Cartography for Epidemiology II</a></li>
<li class="book-part">Appendices</li>
<li><a class="active" href="reproducibility-and-projects-in-r.html"><span class="header-section-number">4</span> Reproducibility and Projects in R</a></li>
<li><a class="" href="introduction-to-r-notebooks.html"><span class="header-section-number">5</span> Introduction to R Notebooks</a></li>
<li><a class="" href="formatting-markdown-and-notebooks.html"><span class="header-section-number">6</span> Formatting Markdown and Notebooks</a></li>
<li><a class="" href="sf-overview.html"><span class="header-section-number">7</span> Tips for working with sf data class</a></li>
<li><a class="" href="dplyr.html"><span class="header-section-number">8</span> Tips for using dplyr</a></li>
<li><a class="" href="intro-tmap.html"><span class="header-section-number">9</span> Tips for using tmap</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/mkram01/EPI563-SpatialEPI">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="reproducibility-and-projects-in-r" class="section level1" number="4">
<h1>
<span class="header-section-number">Week 4</span> Reproducibility and Projects in <code>R</code><a class="anchor" aria-label="anchor" href="#reproducibility-and-projects-in-r"><i class="fas fa-link"></i></a>
</h1>
<div id="additional-resources-3" class="section level2 unnumbered">
<h2>Additional Resources<a class="anchor" aria-label="anchor" href="#additional-resources-3"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/rmarkdown.pdf">R Markdown Cheatsheet</a></li>
<li>
<a href="https://bookdown.org/yihui/rmarkdown/">Comprehensive guide to using R Markdown</a>
<ul>
<li><a href="https://bookdown.org/yihui/rmarkdown/notebook.html">Chapter within the R Markdown guide specific to Notebooks</a></li>
</ul>
</li>
<li><a href="https://epirhandbook.com/r-projects.html">Epidemiologist R Handbook - Working with projects</a></li>
<li><a href="https://epirhandbook.com/reports-with-r-markdown.html#r-markdown-components">Epidemiologist R Handbook - R markdown</a></li>
<li><a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">Working with <em>Projects</em> in <code>R</code></a></li>
<li><a href="https://r4ds.had.co.nz/workflow-projects.html">R for Data Science - Workflow Projects</a></li>
</ul>
</div>
<div id="the-benefits-of-code-reproducibility" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> The benefits of code reproducibility<a class="anchor" aria-label="anchor" href="#the-benefits-of-code-reproducibility"><i class="fas fa-link"></i></a>
</h2>
<p><em>Reproducibility</em> refers to the capacity for any process you create to be fully and independently replicable either by yourself in the future or by another person. Non-reproducibility of scientific findings has been cited as a leading problem and some of the problem comes from the <em>ad-hoc</em> and thus non-reproducible conduct of data preparation and analysis.</p>
<p>Spatial epidemiology requires intensive data preparation, cleaning, and management, and often complex sequence of analytic steps. In other words it would be difficult for another analyst or a future version of yourself to repeat the process in exactly the same way unless there is a perfect record of what was done. For this reason, reproducibility of analysis is emphasized and required in this course.</p>
<p>For an analysis to be reproducible you be sure that all data stays paired with all code, and that all (or as many as possible) steps that change or manipulate data are written in your scripts rather than done ‘by hand’ (e.g. in Excel or some other editor).</p>
</div>
<div id="workflows-to-enhance-reproducibility" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Workflows to enhance reproducibility<a class="anchor" aria-label="anchor" href="#workflows-to-enhance-reproducibility"><i class="fas fa-link"></i></a>
</h2>
<p>Because <code>R</code> and RStudio are often used for data preparation, analysis, and reporting, the fundamental importance of <em>reproducibility</em> (making analytic processes transparent, interpretable and repeatable) is built-in through many features. This Appendix introduces several strategies that are important for reproducibility broadly, and also important for the work you do in this course.</p>
<p>First, there is a brief introduction to <em>projects</em> in RStudio, and then there is a slightly more in-depth description of a specific file format, <code>rmarkdown</code> and how it can be used to create Notebooks.</p>
<div id="using-projects-in-r" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> Using Projects in <code>R</code><a class="anchor" aria-label="anchor" href="#using-projects-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>A <strong>project</strong> in <code>R</code> organizes your work much as you might use <em>folders</em> on your computer to sort and separate into some logical scheme. In other words, it is a place where you put multiple documents or files that are related to one another.</p>
<p>For instance, you might choose to have a single project for each week of this class, and perhaps a separate project for each assignment. In each <em>project directory</em> (folder) you could store the data, the scripts or code, and any outputs (e.g. saved maps or other saved objects) that are specific to that week or assignment.</p>
<p>The advantage of creating a formal <em>project</em> in RStudio (rather than just a regular folder, for example), is that RStudio projects have certain benefits for your coding workflow.</p>
<ul>
<li>When you open a project, the <em>working directory</em> (e.g. the root directory or file path where <code>R</code> looks for files when you import) is automatically set to be inside the project folder. This means that if you keep your data inside the project, you will never have to worry about broken links or incorrect file paths that occur because data was moved.</li>
<li>Projects remember environmental settings in RStudio, so you may customize something to a specific project and that will be remembered each time you open the project.</li>
<li>If you ever work with a version control system such as Github, projects are the natural strategy to contain a repository</li>
</ul>
<div class="rmd-caution">
<p><strong>You should avoid using <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> in <code>R</code></strong>! That function changes the <em>working directory</em> and you may have been taught to do this to make it easier. This is bad because whatever pathname you put inside the <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> will amost never work on another computer. That means your code is fragile and specific to your computer, and probably to your computer at only a specific point in time.</p>
<p>If you find yourself relying on <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> or any other strategy to <em>hard code</em> file pathnames, please consider learning about projects. They help make code <em>less fragile</em> and <em>more robust</em> for sharing and reproducing.</p>
</div>
<p><strong>To create a new project</strong>:</p>
<p>1.Look in the upper-right corner of RStudio for the blue-ish R symbol that will likely say ‘<em>Project</em>.’ Click the pull-down menu and select New Project
2. You will see the Project Wizard open with three options:
+ If you have not yet created the folder on your computer that will be your project, choose <em>New Directory</em>
+ If you already have a folder (e.g. perhaps it is named ‘Week1’), choose <em>Existing Directory</em>
+ If you are are forking or checking out a repository from Github, GitLab or other system, choose <em>Version Control</em>
3. Navigate to the location you want your <em>new folder</em> to be, or else the location where you <em>existing folder</em> already is
4. Name the project and click Create Project</p>
<p>Once the project is created, you can navigate via your finder to that folder. You will notice a new file with extension <code>.Rproj</code>. If you double-click this file, your project will open, including whatever files and settings you have already worked on.</p>
<div class="rmdtip">
<p>Get in the habit of opening <code>R</code> by double-clicking on the <code>xxx.Rproj</code> icon in your project folder. Doing this makes sure that the working directory is set and helps you maintain <em>relative</em> rather than <em>absolute</em> file pathnames within your project folder.</p>
</div>
</div>
</div>
<div id="organizing-projects" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Organizing projects<a class="anchor" aria-label="anchor" href="#organizing-projects"><i class="fas fa-link"></i></a>
</h2>
<p>Some projects or analyses are simple and perhaps only involve a single script document and use built-in data. But most projects are more complex than that, involving dataset(s), one or more files with code scripts, possibly output including datasets as well as images saved from figures, and markdown files or reports. It is good practice to have a standard strategy for organizing these.</p>
<div id="make-scripts-that-do-discrete-tasks" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> Make scripts that do discrete tasks<a class="anchor" aria-label="anchor" href="#make-scripts-that-do-discrete-tasks"><i class="fas fa-link"></i></a>
</h3>
<p>You may be used to having one file with hundreds or even thousands of lines of code to do every part of an analysis. This isn’t inherently wrong, but it can make it difficult to find the particular snippets of code where you defined a recoded variable, or carried out descriptive analyses. For larger projects, consider creating separate scripts for discrete steps. If you do have many different <code>R</code> scripts in a given project, consider storing them in a sub-folder perhaps labeled <code>code/</code>. You might break your work down into separate scripts like this:</p>
<ol style="list-style-type: decimal">
<li>A script for data preparation. This allows you to quickly return to the process of retrieving and preparing your data to make changes.</li>
<li>Scripts for descriptive analysis. You may want to revisit your descriptives in the future and having them separate makes that easier.</li>
<li>Scripts (one or more) for more complex analyses including modeling, figure preparation, or simulation.</li>
</ol>
<p>Each script should have an informative name such as <code>project-x-data-prep.R</code> or <code>project-x-create-final-maps.R</code>.</p>
</div>
<div id="always-store-data-with-code-and-output" class="section level3" number="4.3.2">
<h3>
<span class="header-section-number">4.3.2</span> Always store data with code and output<a class="anchor" aria-label="anchor" href="#always-store-data-with-code-and-output"><i class="fas fa-link"></i></a>
</h3>
<p>If you are creating maps, the raw (and possibly post-processed, or intermediate) data that supports those maps should be stored <strong>inside your project folder</strong>. This is the only way to guarantee that you can return in a year and recreate the map exactly. If you have multiple data files, you might consider putting this content in a sub-folder, possibly labeled <code>data/</code>.</p>
</div>
<div id="maintain-all-output-files-figures-cleaned-datasets-etc" class="section level3" number="4.3.3">
<h3>
<span class="header-section-number">4.3.3</span> Maintain all output files (figures, cleaned datasets, etc)<a class="anchor" aria-label="anchor" href="#maintain-all-output-files-figures-cleaned-datasets-etc"><i class="fas fa-link"></i></a>
</h3>
<p>Just as you want to store code and data together, you should also plan to store all output content in the main project folder or possibly in one or more sub-folders (e.g. <code>images/</code> or <code>reports/</code>). There are several kinds of outputs that might be generated including:</p>
<ul>
<li>Images or figures</li>
<li>Maps</li>
<li>Cleaned or prepared datasets (either stored as <code>.xlsx</code> or <code>.csv</code> or possibly stored in <code>R</code> binary format such as <code>.rds</code>)</li>
<li>Reports (e.g. rendered from R-markdown either as <code>html</code> or <code>pdf</code>)</li>
</ul>
</div>
</div>
<div id="use-the-here-package-to-maintain-robust-relative-pathnames" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Use the <code>here</code> package to maintain robust relative pathnames<a class="anchor" aria-label="anchor" href="#use-the-here-package-to-maintain-robust-relative-pathnames"><i class="fas fa-link"></i></a>
</h2>
<p>There are many reasons to keep your work organized, but one is to maintain a known and constant relationship between where data and code are stored. As discussed above, the use of <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> creates a rigid or <em>absolute</em> pointer to where a file (e.g. your data might be at <code>C:\MyDocuments\EPI563\Week1</code>) are stored. But if you changed computers or changed your file structure on your current computer, that <em>absolute</em> path would likely fail making the code non-reproducible (your code could not <em>find</em> you data)!</p>
<p>Instead, please try to preference <em>relative</em> pathnames. That is a way of describing where something is <em>relative to</em> a given starting point. In the case of projects in R-studio, that starting point is always the folder containing the project. Thus, the location of a dataset stored in a sub-folder called <em>data</em> is: <code>data/mydataset.xlsx</code>; it is assumed that the folder <code>data</code> is a sub-folder of the parent or project folder. As long as you keep your project as a self-contained folder (e.g. copy/paste it as a folder or share it as a folder with all contents), this <em>relative</em> location will be robust.</p>
<p>The <code>here</code> package was developed to try to make some of this a bit easier. The package named <code>here</code> also has a function named <code>here()</code> (I know it feels a bit repetitive!). The function, <code>here()</code> serves to describe the hierarchical nesting of folders that locates the file or location you desire (e.g. where to import a dataset from or where to save a figure to). This is some examples of how to use <code>here()</code>:</p>
<ul>
<li>
<strong>Importing data</strong>: <code>mydata &lt;- read.csv(here('data', 'wave1', 'wave1_data.csv))</code>. In this code, we create a new object (named <code>mydata</code>) that results from using the function <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code>. The data is located <em>within the project folder</em> at this relative path location: <code>data/wave1/wave1_data.csv</code>.</li>
<li>
<strong>Saving output</strong>: <code>ggsave(here('figures', 'figure1.png'))</code>. In this code, we save the <code>ggplot()</code> figure to our computer at this location within the overall project folder: <code>figures/figure1.png</code>.</li>
</ul>
<div class="rmdcaution">
<p><strong>Caution</strong>: If you work in a Windows OS environment, be careful how you designate file pathnames. <code>R</code> uses notation that is similar to <em>Unix OS</em>, and also the one adopted by Mac OS, which is to define a set of nested folders with a <em>forward slash</em> as in: <code>H:/mkram02/gis-file</code> . Unfortunately that is <em>the opposite</em> of how Windows describes pathnames (e.g. in Windows the above would use <em>back slash</em> like this: <code>H:\mkram02\gis-file</code>). Using the <code>here</code> packages avoids this confusion.</p>
</div>
<div id="specify-a-relative-location-outside-the-working-directory" class="section level3" number="4.4.1">
<h3>
<span class="header-section-number">4.4.1</span> Specify a relative location outside the working directory<a class="anchor" aria-label="anchor" href="#specify-a-relative-location-outside-the-working-directory"><i class="fas fa-link"></i></a>
</h3>
<p>What if you have one folder for this entire course, and inside it you have a separate project directory for each week. If you are working on the project for <code>Week2</code>, you might wish to load a file that you saved previously in <code>Week1</code>. In other words it is not a sub-folder, but is actually <em>outside</em> of the current directory. You could use the <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> function to change the location, but that creates a possibly fragile <em>absolute pathname</em> and can be dangerous. Instead you could create a more robust <em>relative pathname</em> by referring to the other file in relation to your current location.</p>
<p>Using two dots in a pathname tells <code>R</code> to <strong>go up a level</strong> in the directory. So to if the <code>georgia.csv</code> file I referred to above were in your <code>Week1</code> directory, but your are currently woring in <code>Week2</code> you could do this:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="st">'../data/death-data/georgia.csv'</span><span class="op">)</span></code></pre></div>
<p>This means “<em>go up a level, then look in the data folder, then the death-data folder, then load the georgia.csv file</em>.” If you need to go up two (or more) levels, simply repeat: <code>../../data/death-data.georgia.csv</code></p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="cartography-for-epidemiology-ii.html"><span class="header-section-number">3</span> Cartography for Epidemiology II</a></div>
<div class="next"><a href="introduction-to-r-notebooks.html"><span class="header-section-number">5</span> Introduction to R Notebooks</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#reproducibility-and-projects-in-r"><span class="header-section-number">4</span> Reproducibility and Projects in R</a></li>
<li><a class="nav-link" href="#additional-resources-3">Additional Resources</a></li>
<li><a class="nav-link" href="#the-benefits-of-code-reproducibility"><span class="header-section-number">4.1</span> The benefits of code reproducibility</a></li>
<li>
<a class="nav-link" href="#workflows-to-enhance-reproducibility"><span class="header-section-number">4.2</span> Workflows to enhance reproducibility</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#using-projects-in-r"><span class="header-section-number">4.2.1</span> Using Projects in R</a></li></ul>
</li>
<li>
<a class="nav-link" href="#organizing-projects"><span class="header-section-number">4.3</span> Organizing projects</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#make-scripts-that-do-discrete-tasks"><span class="header-section-number">4.3.1</span> Make scripts that do discrete tasks</a></li>
<li><a class="nav-link" href="#always-store-data-with-code-and-output"><span class="header-section-number">4.3.2</span> Always store data with code and output</a></li>
<li><a class="nav-link" href="#maintain-all-output-files-figures-cleaned-datasets-etc"><span class="header-section-number">4.3.3</span> Maintain all output files (figures, cleaned datasets, etc)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#use-the-here-package-to-maintain-robust-relative-pathnames"><span class="header-section-number">4.4</span> Use the here package to maintain robust relative pathnames</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#specify-a-relative-location-outside-the-working-directory"><span class="header-section-number">4.4.1</span> Specify a relative location outside the working directory</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/mkram01/EPI563-SpatialEPI/blob/master/80-reproducibility.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/mkram01/EPI563-SpatialEPI/edit/master/80-reproducibility.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>EPI 563: Spatial Epidemiology, Fall 2021</strong>" was written by Michael Kramer. It was last built on Last updated: 2021-08-25.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>

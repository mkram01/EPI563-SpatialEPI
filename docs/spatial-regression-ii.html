<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 11 Spatial Regression II | EPI 563: Spatial Epidemiology, Fall 2020</title>
  <meta name="description" content="Week 11 Spatial Regression II | EPI 563: Spatial Epidemiology, Fall 2020" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 11 Spatial Regression II | EPI 563: Spatial Epidemiology, Fall 2020" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="mkram01/EPI563-SpatialEPI" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 11 Spatial Regression II | EPI 563: Spatial Epidemiology, Fall 2020" />
  
  
  

<meta name="author" content="Michael Kramer" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatreg1.html"/>
<link rel="next" href="spatial-regression-iii.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EPI 563: Spatial Epidemiology, Fall 2020</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>How to use this eBook</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#strategy-for-using-this-ebook"><i class="fa fa-check"></i>Strategy for using this eBook</a></li>
</ul></li>
<li class="part"><span><b>I Getting ready…</b></span></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html"><i class="fa fa-check"></i>Software installation</a>
<ul>
<li><a href="software-installation.html#installing-r-on-your-computer">Installing <code>R</code> on your computer</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#installing-rstudio-on-your-computer"><i class="fa fa-check"></i>Installing RStudio on your computer</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html"><i class="fa fa-check"></i>Installing packages for this course</a>
<ul>
<li><a href="installing-packages-for-this-course.html#installing-rtools40">Installing <code>Rtools40</code></a></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html#installing-packages-used-for-general-data-science"><i class="fa fa-check"></i>Installing packages used for general data science</a></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html#installing-packages-use-for-geographic-data"><i class="fa fa-check"></i>Installing packages use for geographic data</a></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html#installing-packages-used-for-spatial-data-manipulation-visualization"><i class="fa fa-check"></i>Installing packages used for spatial data manipulation &amp; visualization</a></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html#installing-packages-used-for-spatial-analysis"><i class="fa fa-check"></i>Installing packages used for spatial analysis</a></li>
</ul></li>
<li class="part"><span><b>II Weekly Modules</b></span></li>
<li class="chapter" data-level="1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html"><i class="fa fa-check"></i><b>1</b> Locating Spatial Epidemiology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#getting-ready"><i class="fa fa-check"></i><b>1.1</b> Getting Ready</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#learning-objectives"><i class="fa fa-check"></i><b>1.1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.1.2" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#additional-resources"><i class="fa fa-check"></i><b>1.1.2</b> Additional Resources</a></li>
<li class="chapter" data-level="1.1.3" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#important-vocabulary"><i class="fa fa-check"></i><b>1.1.3</b> Important Vocabulary</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#spatial-thinking-in-epidemiology"><i class="fa fa-check"></i><b>1.2</b> Spatial Thinking in Epidemiology</a></li>
<li class="chapter" data-level="1.3" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#spatial-analysis-in-epidemiology"><i class="fa fa-check"></i><b>1.3</b> Spatial Analysis in Epidemiology</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#spatial-data-storage-foramts"><i class="fa fa-check"></i><b>1.3.1</b> Spatial data storage foramts</a></li>
<li class="chapter" data-level="1.3.2" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#representing-spatial-data-in-r"><i class="fa fa-check"></i><b>1.3.2</b> Representing spatial data in <code>R</code></a></li>
<li class="chapter" data-level="1.3.3" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#benefits-of-sf-data-classes"><i class="fa fa-check"></i><b>1.3.3</b> Benefits of <code>sf</code> data classes</a></li>
<li class="chapter" data-level="1.3.4" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#working-with-spatial-data-in-r"><i class="fa fa-check"></i><b>1.3.4</b> Working with spatial data in <code>R</code></a></li>
<li class="chapter" data-level="1.3.5" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#basic-visual-inspectionplots"><i class="fa fa-check"></i><b>1.3.5</b> Basic visual inspection/plots</a></li>
<li class="chapter" data-level="1.3.6" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#working-with-crs-and-projection"><i class="fa fa-check"></i><b>1.3.6</b> Working with CRS and projection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html"><i class="fa fa-check"></i><b>2</b> Cartography for Epidemiology I</a>
<ul>
<li class="chapter" data-level="2.1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#getting-ready"><i class="fa fa-check"></i><b>2.1</b> Getting Ready</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#learning-objectives-w2"><i class="fa fa-check"></i><b>2.1.1</b> Learning objectives, w2</a></li>
<li class="chapter" data-level="2.1.2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#additional-resources-w2"><i class="fa fa-check"></i><b>2.1.2</b> Additional Resources, w2</a></li>
<li class="chapter" data-level="2.1.3" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#important-vocabulary-w2"><i class="fa fa-check"></i><b>2.1.3</b> Important Vocabulary, w2</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#spatial-thinking-in-epidemiology-w2"><i class="fa fa-check"></i><b>2.2</b> Spatial Thinking in Epidemiology, w2</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#color-choices"><i class="fa fa-check"></i><b>2.2.1</b> Color choices</a></li>
<li class="chapter" data-level="2.2.2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#choropleth-binning-styles"><i class="fa fa-check"></i><b>2.2.2</b> Choropleth binning styles</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#spatial-analysis-in-epidemiology-w2"><i class="fa fa-check"></i><b>2.3</b> Spatial Analysis in Epidemiology, w2</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#obtaining-and-preparing-numerator-data"><i class="fa fa-check"></i><b>2.3.1</b> Obtaining and preparing numerator data</a></li>
<li class="chapter" data-level="2.3.2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#obtaining-and-preparing-denominator-or-contextual-data"><i class="fa fa-check"></i><b>2.3.2</b> Obtaining and preparing denominator or contextual data</a></li>
<li class="chapter" data-level="2.3.3" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#obtaining-and-preparing-geographic-data"><i class="fa fa-check"></i><b>2.3.3</b> Obtaining and preparing geographic data</a></li>
<li class="chapter" data-level="2.3.4" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#merging-attributes-and-geography"><i class="fa fa-check"></i><b>2.3.4</b> Merging Attributes and Geography</a></li>
<li class="chapter" data-level="2.3.5" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#mapping-mortality-uninsured"><i class="fa fa-check"></i><b>2.3.5</b> Mapping Mortality &amp; Uninsured</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html"><i class="fa fa-check"></i><b>3</b> Cartography for Epidemiology II</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#learning-objectives-w3"><i class="fa fa-check"></i><b>3.1</b> Learning objectives, w3</a></li>
<li class="chapter" data-level="3.2" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#additional-resources-w3"><i class="fa fa-check"></i><b>3.2</b> Additional resources, w3</a></li>
<li class="chapter" data-level="3.3" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#important-vocabulary-w3"><i class="fa fa-check"></i><b>3.3</b> Important Vocabulary, w3</a></li>
<li class="chapter" data-level="3.4" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#spatial-thinking-in-epidemiology-w3"><i class="fa fa-check"></i><b>3.4</b> Spatial Thinking in Epidemiology, w3</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#risks-of-privacy-breaches-in-collection-of-geospatial-information"><i class="fa fa-check"></i><b>3.4.1</b> Risks of privacy breaches in collection of geospatial information</a></li>
<li class="chapter" data-level="3.4.2" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#risk-of-confidentiality-breaches-through-unintentional-de-identification"><i class="fa fa-check"></i><b>3.4.2</b> Risk of confidentiality breaches through unintentional de-identification</a></li>
<li class="chapter" data-level="3.4.3" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#risk-of-stigmatization-of-place"><i class="fa fa-check"></i><b>3.4.3</b> Risk of stigmatization of place</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html"><i class="fa fa-check"></i><b>4</b> Disease Mapping I</a>
<ul>
<li class="chapter" data-level="4.1" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#getting-ready-w4"><i class="fa fa-check"></i><b>4.1</b> Getting ready, w4</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#learning-objectives-w4"><i class="fa fa-check"></i><b>4.1.1</b> Learning objectives, w4</a></li>
<li class="chapter" data-level="4.1.2" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#additional-resources-w4"><i class="fa fa-check"></i><b>4.1.2</b> Additional Resources, w4</a></li>
<li class="chapter" data-level="4.1.3" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#important-vocabulary-w4"><i class="fa fa-check"></i><b>4.1.3</b> Important Vocabulary, w4</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#spatial-thinking-in-epidemiology-w4"><i class="fa fa-check"></i><b>4.2</b> Spatial Thinking in Epidemiology, w4</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#why-do-we-need-disease-mapping"><i class="fa fa-check"></i><b>4.2.1</b> Why do we need disease mapping?</a></li>
<li class="chapter" data-level="4.2.2" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#using-statistics-and-probability-models-to-improve-disease-mapping"><i class="fa fa-check"></i><b>4.2.2</b> Using statistics and probability models to improve disease mapping</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#spatial-analysis-in-epidemiology-w4"><i class="fa fa-check"></i><b>4.3</b> Spatial Analysis in Epidemiology, w4</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#disease-mapping-is-there-spatial-heterogeneity"><i class="fa fa-check"></i><b>4.3.1</b> Disease mapping: Is there spatial heterogeneity?</a></li>
<li class="chapter" data-level="4.3.2" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#disease-mapping-how-precise-are-county-estimates"><i class="fa fa-check"></i><b>4.3.2</b> Disease mapping: How precise are county estimates?</a></li>
<li class="chapter" data-level="4.3.3" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#disease-mapping-adjusting-for-covariates"><i class="fa fa-check"></i><b>4.3.3</b> Disease mapping: Adjusting for covariates</a></li>
<li class="chapter" data-level="4.3.4" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#disease-mapping-rate-stabilization-with-global-empirical-bayes"><i class="fa fa-check"></i><b>4.3.4</b> Disease mapping: Rate stabilization with global Empirical Bayes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html"><i class="fa fa-check"></i><b>5</b> Disease Mapping II</a>
<ul>
<li class="chapter" data-level="5.1" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#getting-ready-w5"><i class="fa fa-check"></i><b>5.1</b> Getting Ready, w5</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#w5-learning-objectives"><i class="fa fa-check"></i><b>5.1.1</b> w5 Learning objectives</a></li>
<li class="chapter" data-level="5.1.2" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#additional-resources-w5"><i class="fa fa-check"></i><b>5.1.2</b> Additional Resources, w5</a></li>
<li class="chapter" data-level="5.1.3" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#important-vocabulary-w5"><i class="fa fa-check"></i><b>5.1.3</b> Important Vocabulary, w5</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#spatial-thinking-in-epidemiology-w5"><i class="fa fa-check"></i><b>5.2</b> Spatial Thinking in Epidemiology, w5</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#an-argument-for-the-relevance-of-space"><i class="fa fa-check"></i><b>5.2.1</b> An argument for the relevance of space</a></li>
<li class="chapter" data-level="5.2.2" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#on-making-meaning-from-neighbors"><i class="fa fa-check"></i><b>5.2.2</b> On making meaning from neighbors</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#spatial-analysis-in-epidemiology-w5"><i class="fa fa-check"></i><b>5.3</b> Spatial Analysis in Epidemiology, w5</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#creating-contiguity-neighbor-objects"><i class="fa fa-check"></i><b>5.3.1</b> Creating contiguity neighbor objects</a></li>
<li class="chapter" data-level="5.3.2" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#creating-k-nearest-neighbors"><i class="fa fa-check"></i><b>5.3.2</b> Creating k-nearest neighbors</a></li>
<li class="chapter" data-level="5.3.3" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#creating-graph-based-triangle-neighbor-objects"><i class="fa fa-check"></i><b>5.3.3</b> Creating Graph-based triangle neighbor objects</a></li>
<li class="chapter" data-level="5.3.4" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#creating-fixed-distance-neighbors"><i class="fa fa-check"></i><b>5.3.4</b> Creating fixed-distance neighbors</a></li>
<li class="chapter" data-level="5.3.5" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#from-spatial-neighbors-to-spatial-disease-mapping"><i class="fa fa-check"></i><b>5.3.5</b> From spatial neighbors to spatial Disease Mapping</a></li>
<li class="chapter" data-level="5.3.6" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#spatial-empirical-bayes"><i class="fa fa-check"></i><b>5.3.6</b> Spatial Empirical Bayes</a></li>
<li class="chapter" data-level="5.3.7" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#final-thoughts-making-choices"><i class="fa fa-check"></i><b>5.3.7</b> Final thoughts: Making choices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html"><i class="fa fa-check"></i><b>6</b> Disease Mapping III</a>
<ul>
<li class="chapter" data-level="6.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#getting-ready-w6"><i class="fa fa-check"></i><b>6.1</b> Getting Ready, w6</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#learning-objectives-w6"><i class="fa fa-check"></i><b>6.1.1</b> Learning objectives, w6</a></li>
<li class="chapter" data-level="6.1.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#additional-resources-w6"><i class="fa fa-check"></i><b>6.1.2</b> Additional Resources, w6</a></li>
<li class="chapter" data-level="6.1.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#important-vocabulary-w6"><i class="fa fa-check"></i><b>6.1.3</b> Important Vocabulary, w6</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#spatial-thinking-in-epidemiology-w6"><i class="fa fa-check"></i><b>6.2</b> Spatial Thinking in Epidemiology, w6</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#revisiting-spatial-point-processes"><i class="fa fa-check"></i><b>6.2.1</b> Revisiting spatial point processes</a></li>
<li class="chapter" data-level="6.2.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#what-is-a-kernel-density-estimator"><i class="fa fa-check"></i><b>6.2.2</b> What is a kernel density estimator?</a></li>
<li class="chapter" data-level="6.2.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#limitations-in-kernel-density-estimation"><i class="fa fa-check"></i><b>6.2.3</b> Limitations in kernel density estimation</a></li>
<li class="chapter" data-level="6.2.4" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#uses-for-kernel-density-estimation-kde-in-spatial-epidemiology"><i class="fa fa-check"></i><b>6.2.4</b> Uses for kernel density estimation (KDE) in spatial epidemiology</a></li>
<li class="chapter" data-level="6.2.5" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#guide-to-the-rest-of-this-section"><i class="fa fa-check"></i><b>6.2.5</b> Guide to the rest of this section…</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#spatial-analysis-in-epidemiology-kernel-estimation-of-point-processes"><i class="fa fa-check"></i><b>6.3</b> Spatial Analysis in Epidemiology: Kernel estimation of point processes</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#preparing-packages-and-data"><i class="fa fa-check"></i><b>6.3.1</b> Preparing packages and data</a></li>
<li class="chapter" data-level="6.3.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#introducing-a-new-spatial-data-class-ppp"><i class="fa fa-check"></i><b>6.3.2</b> Introducing a new spatial data class: <code>ppp</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#creating-the-ppp-objects"><i class="fa fa-check"></i><b>6.3.3</b> Creating the <code>ppp</code> objects</a></li>
<li class="chapter" data-level="6.3.4" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#bandwidth-selection"><i class="fa fa-check"></i><b>6.3.4</b> Bandwidth selection</a></li>
<li class="chapter" data-level="6.3.5" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#estimating-kernel-density-surfaces"><i class="fa fa-check"></i><b>6.3.5</b> Estimating Kernel Density surfaces</a></li>
<li class="chapter" data-level="6.3.6" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#creating-relative-risk-surface-manually"><i class="fa fa-check"></i><b>6.3.6</b> Creating relative risk surface manually</a></li>
<li class="chapter" data-level="6.3.7" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#creating-relative-risk-surface-with-risk-function"><i class="fa fa-check"></i><b>6.3.7</b> Creating relative risk surface with <code>risk()</code> function</a></li>
<li class="chapter" data-level="6.3.8" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#using-functions-to-map-rr-with-tmap"><i class="fa fa-check"></i><b>6.3.8</b> Using functions to map RR with <code>tmap</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#gwss"><i class="fa fa-check"></i><b>6.4</b> Spatial Analysis in Epidemiology: Kernel estimation of areal data</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#packages-and-data"><i class="fa fa-check"></i><b>6.4.1</b> Packages and data</a></li>
<li class="chapter" data-level="6.4.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#what-bandwidth-for-kernel-density-estimates"><i class="fa fa-check"></i><b>6.4.2</b> What bandwidth for kernel density estimates?</a></li>
<li class="chapter" data-level="6.4.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#geographically-weighted-summary-statistics-gwss"><i class="fa fa-check"></i><b>6.4.3</b> Geographically weighted summary statistics: <code>gwss()</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#calculating-pseudo-p-values-for-smoothed-estimates"><i class="fa fa-check"></i><b>6.4.4</b> Calculating pseudo p-values for smoothed estimates</a></li>
<li class="chapter" data-level="6.4.5" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#estimating-geographically-weighted-bivariate-statistics"><i class="fa fa-check"></i><b>6.4.5</b> Estimating geographically-weighted bivariate statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html"><i class="fa fa-check"></i><b>7</b> Disease Mapping IV</a>
<ul>
<li class="chapter" data-level="7.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#getting-ready-w7"><i class="fa fa-check"></i><b>7.1</b> Getting Ready, w7</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#learning-objectives-w7"><i class="fa fa-check"></i><b>7.1.1</b> Learning objectives, w7</a></li>
<li class="chapter" data-level="7.1.2" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#additional-resources-w7"><i class="fa fa-check"></i><b>7.1.2</b> Additional Resources, w7</a></li>
<li class="chapter" data-level="7.1.3" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#important-vocabulary-w7"><i class="fa fa-check"></i><b>7.1.3</b> Important Vocabulary, w7</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#spatial-thinking-in-epidemiology-w7"><i class="fa fa-check"></i><b>7.2</b> Spatial Thinking in Epidemiology, w7</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#what-is-bayesian-inference"><i class="fa fa-check"></i><b>7.2.1</b> What is <em>Bayesian Inference</em>?</a></li>
<li class="chapter" data-level="7.2.2" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#bayesian-inference-in-spatial-epidemiology"><i class="fa fa-check"></i><b>7.2.2</b> Bayesian inference in spatial epidemiology</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#spatial-analysis-in-epidemiology-w7"><i class="fa fa-check"></i><b>7.3</b> Spatial Analysis in Epidemiology, w7</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#packages-data"><i class="fa fa-check"></i><b>7.3.1</b> Packages &amp; Data</a></li>
<li class="chapter" data-level="7.3.2" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#preparing-for-carbayes"><i class="fa fa-check"></i><b>7.3.2</b> Preparing for <code>CARBayes()</code></a></li>
<li class="chapter" data-level="7.3.3" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#fitting-a-besag-york-mollie-bym-bayesian-model"><i class="fa fa-check"></i><b>7.3.3</b> Fitting a <em>Besag-York-Mollie (BYM)</em> Bayesian model</a></li>
<li class="chapter" data-level="7.3.4" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#summarizing-carbayes-model-output"><i class="fa fa-check"></i><b>7.3.4</b> Summarizing <code>CARBayes</code> model output</a></li>
<li class="chapter" data-level="7.3.5" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#making-inference-from-bayesian-posteriors"><i class="fa fa-check"></i><b>7.3.5</b> Making inference from Bayesian posteriors</a></li>
<li class="chapter" data-level="7.3.6" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#extracting-summaries-for-mapping-or-analysis"><i class="fa fa-check"></i><b>7.3.6</b> Extracting summaries for mapping or analysis</a></li>
<li class="chapter" data-level="7.3.7" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#plot-raw-versus-smoothed"><i class="fa fa-check"></i><b>7.3.7</b> Plot raw versus smoothed</a></li>
<li class="chapter" data-level="7.3.8" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#mapping-rates"><i class="fa fa-check"></i><b>7.3.8</b> Mapping rates</a></li>
<li class="chapter" data-level="7.3.9" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#mapping-exceedance-probability"><i class="fa fa-check"></i><b>7.3.9</b> Mapping exceedance probability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html"><i class="fa fa-check"></i><b>8</b> Spatial Structure and Clustering I</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#getting-ready-w8"><i class="fa fa-check"></i><b>8.1</b> Getting Ready, w8</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#learning-objectives-w8"><i class="fa fa-check"></i><b>8.1.1</b> Learning objectives, w8</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#additional-resources-w8"><i class="fa fa-check"></i><b>8.1.2</b> Additional Resources, w8</a></li>
<li class="chapter" data-level="8.1.3" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#important-vocabulary-w8"><i class="fa fa-check"></i><b>8.1.3</b> Important Vocabulary, w8</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#spatial-thinking-in-epidemiology-w8"><i class="fa fa-check"></i><b>8.2</b> Spatial Thinking in Epidemiology, w8</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#two-big-questions"><i class="fa fa-check"></i><b>8.2.1</b> Two big questions…</a></li>
<li class="chapter" data-level="8.2.2" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#why-does-structure-or-clustering-matter"><i class="fa fa-check"></i><b>8.2.2</b> Why does structure or clustering matter?</a></li>
<li class="chapter" data-level="8.2.3" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#making-meaning-of-hypotheses-in-spatial-structure-testing"><i class="fa fa-check"></i><b>8.2.3</b> Making meaning of hypotheses in spatial structure testing</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#spatial-analysis-in-epidemiology-w8"><i class="fa fa-check"></i><b>8.3</b> Spatial Analysis in Epidemiology, w8</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#packages-data"><i class="fa fa-check"></i><b>8.3.1</b> Packages &amp; Data</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#global-morans-i"><i class="fa fa-check"></i><b>8.3.2</b> Global Moran’s I</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#local-morans-i"><i class="fa fa-check"></i><b>8.3.3</b> Local Moran’s I</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html"><i class="fa fa-check"></i><b>9</b> Spatial Structure and Clustering II</a>
<ul>
<li class="chapter" data-level="9.1" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#getting-ready-w9"><i class="fa fa-check"></i><b>9.1</b> Getting Ready, w9</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#learning-objectives-w9"><i class="fa fa-check"></i><b>9.1.1</b> Learning objectives, w9</a></li>
<li class="chapter" data-level="9.1.2" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#additional-resources-w9"><i class="fa fa-check"></i><b>9.1.2</b> Additional Resources, w9</a></li>
<li class="chapter" data-level="9.1.3" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#important-vocabulary-w9"><i class="fa fa-check"></i><b>9.1.3</b> Important Vocabulary, w9</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#spatial-thinking-in-epidemiology-conceptual-tools-for-thinking-about-clusters"><i class="fa fa-check"></i><b>9.2</b> Spatial Thinking in Epidemiology: Conceptual tools for thinking about ‘clusters’</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#the-clustering-conundrum"><i class="fa fa-check"></i><b>9.2.1</b> The clustering conundrum</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#spatial-scan-statistics"><i class="fa fa-check"></i><b>9.3</b> Spatial Scan Statistics</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#packages-data"><i class="fa fa-check"></i><b>9.3.1</b> Packages &amp; Data</a></li>
<li class="chapter" data-level="9.3.2" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#overview-of-kulldorff-nagarwalla-scan-statistic"><i class="fa fa-check"></i><b>9.3.2</b> Overview of <em>Kulldorff &amp; Nagarwalla</em> scan statistic</a></li>
<li class="chapter" data-level="9.3.3" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#spatio-temporal-scan-statistics"><i class="fa fa-check"></i><b>9.3.3</b> Spatio-temporal scan statistics</a></li>
<li class="chapter" data-level="9.3.4" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#estimating-spatial-only-kulldorff-scan-statistics"><i class="fa fa-check"></i><b>9.3.4</b> Estimating <em>spatial-only</em> Kulldorff scan statistics</a></li>
<li class="chapter" data-level="9.3.5" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#estimating-spatio-temporal-kuldorff-scan-statistic"><i class="fa fa-check"></i><b>9.3.5</b> Estimating <em>spatio-temporal</em> Kuldorff scan statistic</a></li>
<li class="chapter" data-level="9.3.6" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#concluding-thoughts"><i class="fa fa-check"></i><b>9.3.6</b> Concluding thoughts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="spatreg1.html"><a href="spatreg1.html"><i class="fa fa-check"></i><b>10</b> Spatial Regression I</a>
<ul>
<li class="chapter" data-level="10.1" data-path="spatreg1.html"><a href="spatreg1.html#getting-ready-w10"><i class="fa fa-check"></i><b>10.1</b> Getting Ready, w10</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="spatreg1.html"><a href="spatreg1.html#learning-objectives-w10"><i class="fa fa-check"></i><b>10.1.1</b> Learning objectives, w10</a></li>
<li class="chapter" data-level="10.1.2" data-path="spatreg1.html"><a href="spatreg1.html#important-vocabulary-w10"><i class="fa fa-check"></i><b>10.1.2</b> Important Vocabulary, w10</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="spatreg1.html"><a href="spatreg1.html#multivariable-regression-for-exploring-spatial-data"><i class="fa fa-check"></i><b>10.2</b> Multivariable regression for exploring spatial data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="spatreg1.html"><a href="spatreg1.html#data-generating-process"><i class="fa fa-check"></i><b>10.2.1</b> Data Generating Process</a></li>
<li class="chapter" data-level="10.2.2" data-path="spatreg1.html"><a href="spatreg1.html#model-residuals-are-not-just-mistakes"><i class="fa fa-check"></i><b>10.2.2</b> Model residuals are not just mistakes</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="spatreg1.html"><a href="spatreg1.html#spatializing-aspatial-regression"><i class="fa fa-check"></i><b>10.3</b> Spatializing aspatial regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="spatreg1.html"><a href="spatreg1.html#data-packages"><i class="fa fa-check"></i><b>10.3.1</b> Data &amp; Packages</a></li>
<li class="chapter" data-level="10.3.2" data-path="spatreg1.html"><a href="spatreg1.html#fitting-unconditional-empty-model"><i class="fa fa-check"></i><b>10.3.2</b> Fitting unconditional (empty) model</a></li>
<li class="chapter" data-level="10.3.3" data-path="spatreg1.html"><a href="spatreg1.html#fitting-conditional-model"><i class="fa fa-check"></i><b>10.3.3</b> Fitting conditional model</a></li>
<li class="chapter" data-level="10.3.4" data-path="spatreg1.html"><a href="spatreg1.html#mapping-residuals"><i class="fa fa-check"></i><b>10.3.4</b> Mapping residuals</a></li>
<li class="chapter" data-level="10.3.5" data-path="spatreg1.html"><a href="spatreg1.html#morans-i-tests-on-lm-models"><i class="fa fa-check"></i><b>10.3.5</b> Moran’s I tests on <code>lm</code> models</a></li>
<li class="chapter" data-level="10.3.6" data-path="spatreg1.html"><a href="spatreg1.html#morans-i-tests-on-glm-models"><i class="fa fa-check"></i><b>10.3.6</b> Moran’s I tests on <code>glm</code> models</a></li>
<li class="chapter" data-level="10.3.7" data-path="spatreg1.html"><a href="spatreg1.html#mapping-glm-residuals"><i class="fa fa-check"></i><b>10.3.7</b> Mapping <code>glm</code> residuals</a></li>
<li class="chapter" data-level="10.3.8" data-path="spatreg1.html"><a href="spatreg1.html#morans-i-for-glm"><i class="fa fa-check"></i><b>10.3.8</b> Moran’s I for <code>glm</code></a></li>
<li class="chapter" data-level="10.3.9" data-path="spatreg1.html"><a href="spatreg1.html#final-words"><i class="fa fa-check"></i><b>10.3.9</b> Final words</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html"><i class="fa fa-check"></i><b>11</b> Spatial Regression II</a>
<ul>
<li class="chapter" data-level="11.1" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#getting-ready-w11"><i class="fa fa-check"></i><b>11.1</b> Getting Ready, w11</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#learning-objectives-w11"><i class="fa fa-check"></i><b>11.1.1</b> Learning objectives, w11</a></li>
<li class="chapter" data-level="11.1.2" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#important-vocabulary-w11"><i class="fa fa-check"></i><b>11.1.2</b> Important Vocabulary, w11</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#spatially-varying-relationships"><i class="fa fa-check"></i><b>11.2</b> Spatially varying relationships</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#non-stationarity-in-context-of-spatial-epidemiology"><i class="fa fa-check"></i><b>11.2.1</b> Non-stationarity in context of spatial epidemiology</a></li>
<li class="chapter" data-level="11.2.2" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#introducing-geographically-weighted-regression"><i class="fa fa-check"></i><b>11.2.2</b> Introducing geographically weighted regression</a></li>
<li class="chapter" data-level="11.2.3" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#making-epidemiologic-meaning-of-spatially-varying-coefficients"><i class="fa fa-check"></i><b>11.2.3</b> Making epidemiologic meaning of spatially varying coefficients</a></li>
<li class="chapter" data-level="11.2.4" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#distinguishing-variation-in-prevalence-from-variation-in-correlation"><i class="fa fa-check"></i><b>11.2.4</b> Distinguishing variation in <strong>prevalence</strong> from variation in <strong>correlation</strong></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#estimating-geogrpahically-weighted-regression-models"><i class="fa fa-check"></i><b>11.3</b> Estimating geogrpahically weighted regression models</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#packages-and-data"><i class="fa fa-check"></i><b>11.3.1</b> Packages and Data</a></li>
<li class="chapter" data-level="11.3.2" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#preparing-for-using-gwmodel"><i class="fa fa-check"></i><b>11.3.2</b> Preparing for using <code>GWModel</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#defining-local-optimizing-kernel-bandwidths"><i class="fa fa-check"></i><b>11.3.3</b> Defining local: optimizing kernel bandwidths</a></li>
<li class="chapter" data-level="11.3.4" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#geographically-weighted-regression"><i class="fa fa-check"></i><b>11.3.4</b> Geographically weighted regression</a></li>
<li class="chapter" data-level="11.3.5" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#checking-local-multi-collinearity"><i class="fa fa-check"></i><b>11.3.5</b> Checking local multi-collinearity</a></li>
<li class="chapter" data-level="11.3.6" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#adjusting-for-multiple-comparisons"><i class="fa fa-check"></i><b>11.3.6</b> Adjusting for multiple comparisons</a></li>
<li class="chapter" data-level="11.3.7" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#visualizing-model-inference"><i class="fa fa-check"></i><b>11.3.7</b> Visualizing model inference</a></li>
<li class="chapter" data-level="11.3.8" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#extensions"><i class="fa fa-check"></i><b>11.3.8</b> Extensions</a></li>
<li class="chapter" data-level="11.3.9" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#data-models"><i class="fa fa-check"></i><b>11.3.9</b> Data models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html"><i class="fa fa-check"></i><b>12</b> Spatial Regression III</a>
<ul>
<li class="chapter" data-level="12.1" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#getting-ready-w12"><i class="fa fa-check"></i><b>12.1</b> Getting Ready, w12</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#learning-objectives-w12"><i class="fa fa-check"></i><b>12.1.1</b> Learning objectives, w12</a></li>
<li class="chapter" data-level="12.1.2" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#important-vocabulary-w12"><i class="fa fa-check"></i><b>12.1.2</b> Important Vocabulary, w12</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#spatial-econometric-models-putting-dependence-right-in-the-model"><i class="fa fa-check"></i><b>12.2</b> Spatial econometric models: Putting dependence right in the model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#comparing-spatial-econometric-models"><i class="fa fa-check"></i><b>12.2.1</b> Comparing spatial econometric models</a></li>
<li class="chapter" data-level="12.2.2" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#comparing-and-selecting-spatial-econometric-models"><i class="fa fa-check"></i><b>12.2.2</b> Comparing and selecting spatial econometric models</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#estimating-spatial-econometrics-models"><i class="fa fa-check"></i><b>12.3</b> Estimating spatial econometrics models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#package-data"><i class="fa fa-check"></i><b>12.3.1</b> Package &amp; Data</a></li>
<li class="chapter" data-level="12.3.2" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#defining-the-study-question"><i class="fa fa-check"></i><b>12.3.2</b> Defining the study question</a></li>
<li class="chapter" data-level="12.3.3" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#defining-competing-definitions-of-local"><i class="fa fa-check"></i><b>12.3.3</b> Defining competing definitions of <em>local</em></a></li>
<li class="chapter" data-level="12.3.4" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#two-extremes"><i class="fa fa-check"></i><b>12.3.4</b> Two extremes</a></li>
<li class="chapter" data-level="12.3.5" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#fitting-multivariable-regression-models"><i class="fa fa-check"></i><b>12.3.5</b> Fitting multivariable regression models</a></li>
<li class="chapter" data-level="12.3.6" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#spatial-error-model-1"><i class="fa fa-check"></i><b>12.3.6</b> Spatial Error Model</a></li>
<li class="chapter" data-level="12.3.7" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#hausman-test-of-coefficients"><i class="fa fa-check"></i><b>12.3.7</b> Hausman test of coefficients</a></li>
<li class="chapter" data-level="12.3.8" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#spatial-lag-model"><i class="fa fa-check"></i><b>12.3.8</b> Spatial Lag Model</a></li>
<li class="chapter" data-level="12.3.9" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#spatial-durbin-model-1"><i class="fa fa-check"></i><b>12.3.9</b> Spatial Durbin Model</a></li>
<li class="chapter" data-level="12.3.10" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#comparing-models"><i class="fa fa-check"></i><b>12.3.10</b> Comparing Models</a></li>
<li class="chapter" data-level="12.3.11" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#impact-assessments"><i class="fa fa-check"></i><b>12.3.11</b> Impact Assessments</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Appendices</b></span></li>
<li class="chapter" data-level="13" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html"><i class="fa fa-check"></i><b>13</b> Tips for reproducibility in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#additional-resources"><i class="fa fa-check"></i>Additional Resources</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#workflows-to-enhance-reproducibility"><i class="fa fa-check"></i>Workflows to enhance reproducibility</a>
<ul>
<li><a href="tips-for-reproducibility-in-r.html#using-projects-in-r">Using Projects in <code>R</code></a></li>
</ul></li>
<li><a href="tips-for-reproducibility-in-r.html#understanding-directory-and-file-path-names-in-r">Understanding directory and file path names in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#specify-a-location-within-the-working-directory"><i class="fa fa-check"></i>Specify a location within the working directory</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#specify-a-relative-location-outside-the-working-directory"><i class="fa fa-check"></i>Specify a relative location outside the working directory</a></li>
</ul></li>
<li><a href="tips-for-reproducibility-in-r.html#why-r-notebooks">Why <code>R Notebooks</code>?</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#what-you-need-to-know"><i class="fa fa-check"></i>What you need to know</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#important-r-notebook-functions"><i class="fa fa-check"></i>Important R Notebook functions</a>
<ul>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#the-yaml"><i class="fa fa-check"></i>The YAML</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#typing-text"><i class="fa fa-check"></i>Typing text</a></li>
<li><a href="tips-for-reproducibility-in-r.html#adding-r-code">Adding <code>R</code> Code</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#making-tables"><i class="fa fa-check"></i>Making tables</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#workflow"><i class="fa fa-check"></i>Workflow</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#optional-functions"><i class="fa fa-check"></i>Optional functions</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#customizing-your-yaml"><i class="fa fa-check"></i>Customizing your YAML</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#simple-formatting-of-your-notebook"><i class="fa fa-check"></i>Simple formatting of your Notebook</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#text-formatting"><i class="fa fa-check"></i>Text formatting</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#final-note"><i class="fa fa-check"></i>Final Note</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="sf-overview.html"><a href="sf-overview.html"><i class="fa fa-check"></i><b>14</b> Tips for working with <code>sf</code> data class</a>
<ul>
<li class="chapter" data-level="14.1" data-path="sf-overview.html"><a href="sf-overview.html#st_set_geom"><i class="fa fa-check"></i><b>14.1</b> <code>st_set_geom()</code></a></li>
<li class="chapter" data-level="14.2" data-path="sf-overview.html"><a href="sf-overview.html#st-as-sf"><i class="fa fa-check"></i><b>14.2</b> <code>st_as_sf()</code></a></li>
<li class="chapter" data-level="14.3" data-path="sf-overview.html"><a href="sf-overview.html#st_crs"><i class="fa fa-check"></i><b>14.3</b> <code>st_crs()</code></a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>15</b> Tips for using <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="15.1" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>15.1</b> <code>select()</code></a></li>
<li class="chapter" data-level="15.2" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>15.2</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="15.3" data-path="dplyr.html"><a href="dplyr.html#filter"><i class="fa fa-check"></i><b>15.3</b> <code>filter()</code></a></li>
<li class="chapter" data-level="15.4" data-path="dplyr.html"><a href="dplyr.html#arrange"><i class="fa fa-check"></i><b>15.4</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="15.5" data-path="dplyr.html"><a href="dplyr.html#pipe-operator"><i class="fa fa-check"></i><b>15.5</b> <code>%&gt;%</code> Pipe operator</a></li>
<li class="chapter" data-level="15.6" data-path="dplyr.html"><a href="dplyr.html#group_by-and-summarise"><i class="fa fa-check"></i><b>15.6</b> <code>group_by()</code> and <code>summarise()</code></a></li>
<li class="chapter" data-level="15.7" data-path="dplyr.html"><a href="dplyr.html#join"><i class="fa fa-check"></i><b>15.7</b> <code>join()</code></a></li>
<li class="chapter" data-level="15.8" data-path="dplyr.html"><a href="dplyr.html#pivot_"><i class="fa fa-check"></i><b>15.8</b> Reshaping (transposing) data</a>
<ul>
<li class="chapter" data-level="15.8.1" data-path="dplyr.html"><a href="dplyr.html#pivot_longer-for-going-from-wide-to-long"><i class="fa fa-check"></i><b>15.8.1</b> <code>pivot_longer()</code> for going from wide to long</a></li>
<li class="chapter" data-level="15.8.2" data-path="dplyr.html"><a href="dplyr.html#pivot_wider"><i class="fa fa-check"></i><b>15.8.2</b> <code>pivot_wider()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="intro-tmap.html"><a href="intro-tmap.html"><i class="fa fa-check"></i><b>16</b> Tips for using <code>tmap</code></a>
<ul>
<li class="chapter" data-level="16.1" data-path="intro-tmap.html"><a href="intro-tmap.html#tmap-mode"><i class="fa fa-check"></i><b>16.1</b> <code>tmap</code> mode</a></li>
<li class="chapter" data-level="16.2" data-path="intro-tmap.html"><a href="intro-tmap.html#qtm"><i class="fa fa-check"></i><b>16.2</b> Quick maps: <code>qtm()</code></a>
<ul>
<li class="chapter" data-level="16.2.1" data-path="intro-tmap.html"><a href="intro-tmap.html#customizing-qtm-for-polygons"><i class="fa fa-check"></i><b>16.2.1</b> Customizing <code>qtm()</code> for polygons</a></li>
<li class="chapter" data-level="16.2.2" data-path="intro-tmap.html"><a href="intro-tmap.html#customizing-qtm-for-lines"><i class="fa fa-check"></i><b>16.2.2</b> Customizing <code>qtm()</code> for lines</a></li>
<li class="chapter" data-level="16.2.3" data-path="intro-tmap.html"><a href="intro-tmap.html#customizing-qtm-for-points"><i class="fa fa-check"></i><b>16.2.3</b> Customizing <code>qtm()</code> for points</a></li>
<li class="chapter" data-level="16.2.4" data-path="intro-tmap.html"><a href="intro-tmap.html#finding-valid-color-options"><i class="fa fa-check"></i><b>16.2.4</b> Finding valid color options</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="intro-tmap.html"><a href="intro-tmap.html#building-maps-with-tmap"><i class="fa fa-check"></i><b>16.3</b> Building maps with <code>tmap</code></a>
<ul>
<li class="chapter" data-level="16.3.1" data-path="intro-tmap.html"><a href="intro-tmap.html#building-blocks-in-tmap"><i class="fa fa-check"></i><b>16.3.1</b> Building blocks in <code>tmap</code></a></li>
<li class="chapter" data-level="16.3.2" data-path="intro-tmap.html"><a href="intro-tmap.html#customizing-text-on-maps"><i class="fa fa-check"></i><b>16.3.2</b> Customizing text on maps</a></li>
<li class="chapter" data-level="16.3.3" data-path="intro-tmap.html"><a href="intro-tmap.html#adding-two-or-more-spatial-objects-in-one-map"><i class="fa fa-check"></i><b>16.3.3</b> Adding two or more spatial objects in one map</a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="intro-tmap.html"><a href="intro-tmap.html#controlling-layout-and-map-elements"><i class="fa fa-check"></i><b>16.4</b> Controlling layout and map elements</a>
<ul>
<li class="chapter" data-level="16.4.1" data-path="intro-tmap.html"><a href="intro-tmap.html#understanding-the-graphic-space-in-tmap"><i class="fa fa-check"></i><b>16.4.1</b> Understanding the graphic space in <code>tmap</code></a></li>
<li class="chapter" data-level="16.4.2" data-path="intro-tmap.html"><a href="intro-tmap.html#controlling-map-layout"><i class="fa fa-check"></i><b>16.4.2</b> Controlling map layout</a></li>
<li class="chapter" data-level="16.4.3" data-path="intro-tmap.html"><a href="intro-tmap.html#adding-map-elements"><i class="fa fa-check"></i><b>16.4.3</b> Adding map elements</a></li>
<li class="chapter" data-level="16.4.4" data-path="intro-tmap.html"><a href="intro-tmap.html#change-the-global-style-of-a-map"><i class="fa fa-check"></i><b>16.4.4</b> Change the global style of a map</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="intro-tmap.html"><a href="intro-tmap.html#making-small-multiple-maps"><i class="fa fa-check"></i><b>16.5</b> Making small-multiple maps</a>
<ul>
<li class="chapter" data-level="16.5.1" data-path="intro-tmap.html"><a href="intro-tmap.html#small-multiples-as-a-vector-of-variables"><i class="fa fa-check"></i><b>16.5.1</b> Small multiples as a vector of variables</a></li>
<li class="chapter" data-level="16.5.2" data-path="intro-tmap.html"><a href="intro-tmap.html#tmap-facet"><i class="fa fa-check"></i><b>16.5.2</b> Small multiples with facets</a></li>
<li class="chapter" data-level="16.5.3" data-path="intro-tmap.html"><a href="intro-tmap.html#facets-for-time-series"><i class="fa fa-check"></i><b>16.5.3</b> Facets for time-series</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="intro-tmap.html"><a href="intro-tmap.html#small-multiples-with-tmap_arrange"><i class="fa fa-check"></i><b>16.6</b> Small multiples with <code>tmap_arrange()</code></a></li>
<li class="chapter" data-level="16.7" data-path="intro-tmap.html"><a href="intro-tmap.html#summarizing-small-multiples"><i class="fa fa-check"></i><b>16.7</b> Summarizing small multiples</a></li>
<li class="chapter" data-level="16.8" data-path="intro-tmap.html"><a href="intro-tmap.html#saving-maps"><i class="fa fa-check"></i><b>16.8</b> Saving maps</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EPI 563: Spatial Epidemiology, Fall 2020</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-regression-ii" class="section level1" number="11">
<h1><span class="header-section-number">Week 11</span> Spatial Regression II</h1>
<div id="getting-ready-w11" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Getting Ready, w11</h2>
<div id="learning-objectives-w11" class="section level3" number="11.1.1">
<h3><span class="header-section-number">11.1.1</span> Learning objectives, w11</h3>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 100%; margin-left: auto; margin-right: auto;  " id="learning-ob">
<caption style="caption-side: top; text-align: center;"><span id="tab:learning-ob">TABLE 1.1: </span> Learning objectives by weekly module</caption><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 6pt; background-color: rgb(208, 211, 212); font-weight: bold;">After this module you should be able to…</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 6pt; background-color: rgb(250, 229, 211); font-weight: normal;">Explain and relate spatial non-stationarity to epidemiologic concepts of heterogeneity</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 6pt; background-color: rgb(245, 203, 167); font-weight: normal;">Use geographically weighted regression to produce and interpret epidemiologic parameters from point and polygon data</td></tr>
</table>

</div>
<div id="important-vocabulary-w11" class="section level3" number="11.1.2">
<h3><span class="header-section-number">11.1.2</span> Important Vocabulary, w11</h3>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-284">
<caption style="caption-side: top; text-align: center;"><span id="tab:unnamed-chunk-284">TABLE 11.1: </span> Vocabulary for Week 11</caption><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(84, 153, 199); font-weight: bold;"><span style="color: rgb(255, 255, 255);">Term</span></th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(84, 153, 199); font-weight: bold;"><span style="color: rgb(255, 255, 255);">Definition</span></th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(212, 230, 241); font-weight: bold;">1st order process</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(212, 230, 241); font-weight: normal;">Statistical measures where units taken one at a time. Spatial heterogeneity is about how the mean intensity varies for each unit, and is therefore primarily about first order process</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(169, 204, 227); font-weight: bold;">2nd order process</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(169, 204, 227); font-weight: normal;">Statistical measures where units considered at least two at a time. Spatial dependence is about correlation or relatedness between units and is therefore about 2nd order processes</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(212, 230, 241); font-weight: bold;">Geographically weighted regression</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(212, 230, 241); font-weight: normal;">A multivariable regression that is re-fit for multiple sub-regions within a study area, typically weighting the observations using a kernel density function. The goal of GWR is to identify statistical evidence for non-stationarity (e.g. does a locally varying regression fit the data better than a single global model, after penalizing for multiple comparisons?) and if present to quantify their values and spatial patterns.</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(169, 204, 227); font-weight: bold;">Stationarity vs non-stationarity</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(169, 204, 227); font-weight: normal;">Stationary' statistics are those for which the global value is true for all sub-groups (e.g. sub-population or places). In contrast, non-stationarity is when the value of a given statistic is not singularly global, but in fact depends on the sub-group (e.g. populatio or location). Spatia non-stationarity can refer to disease intensity (e.g. spatial heterogeneity) or to variable relationships (e.g. spatially varying coefficients).</td></tr>
</table>

</div>
</div>
<div id="spatially-varying-relationships" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Spatially varying relationships</h2>
<div id="non-stationarity-in-context-of-spatial-epidemiology" class="section level3" number="11.2.1">
<h3><span class="header-section-number">11.2.1</span> Non-stationarity in context of spatial epidemiology</h3>
<p>The latter half of the course has focused on how to estimate, describe, and test for epidemiologically relevant <em>spatial structure</em> or <em>spatial heterogeneity</em> in population health data. Briefly these have been the topics covered following the introductory Epidemiologic Cartography module:</p>
<ol style="list-style-type: decimal">
<li><em>Disease mapping of spatial heterogeneity</em> to describe epidemiologically meaningful patterns of disease over space, possibly even in the presence of sparse data that reduces certainty and precision of estimates. The tools of disease mapping focused on stabilizing and smoothing parameter estimates, possibly in formal testing for statistical deviation from expectations, and contrasting local rates to global rates (e.g. SMRs).</li>
<li><em>Global and local spatial auto correlation</em> as ways to describe the tendency for univariate data (e.g. health outcomes) to be spatially dependent. These tests described the degree to which (and in the case of <em>local tests</em>, the location <em>where</em>) outcomes clustered in space. Spatial auto correlation is a fundamental characteristic of spatial structure, and thus very useful in exploring and describing data. Importantly, testing for spatial auto correlation does not explain <strong>why</strong> population events are spatially dependent or clustered.</li>
<li><em>Spatial scan statistics</em> were a class of tests designed as an alternative (or complementary) tool for testing for the presence of spatially-clustered health events. While spatial auto correlation tested explicitly for spatial-dependence between locations, spatial scan statistics tested for statistically unusual extreme rates or risks of disease within arbitrarily small/large search windows. In that way spatial scan statistics describe spatial structure through the lens of <em>spatial homogeneity (constant risk) or heterogeneity</em>. However, spatial scan statistics share with spatial auto correlation statistics the lack of explanatory insight as to <em>how</em> or <em>why</em> disease intensity varies in space.</li>
<li><em>Spatial auto correlation tests of aspatial regression residuals</em> was the first step towards describing spatial structure as a function of <em>multi-dimensional</em> (multiple variable) predictors. By fitting multivariable regression models that could include predictors that might <em>explain</em> the reason for spatial structure, this approach began the intersection of multivariable regression with spatial structure. This approach to <em>spatializing aspatial regression</em> is a useful exploratory or diagnostic step, which could result in sufficient insight to understand why or how spatial structure is generated. However, often residual spatial auto correlation in residuals exists after inclusion of important measured variables, and the question remains: <em>What produces residual dependence?</em></li>
</ol>
<p><em>This brings us to geographically weighted statistics</em>. While the order of topics covered above is written in a somewhat hierarchical or linear-sequential manner (each step follows and expands on the preceding), the course of analysis is not always this way. In particular, geographically weighted statistics are not the culmination of all spatial analysis to date, but instead represent an alternative way to view the <em>data generating process</em>.</p>

<div class="rmdnote">
The <strong>data generating process</strong> ideally refers to the the biological, social, and ecologic mechanisms and processes that collectively give rise to or <em>generate</em> the data we observed. We often use statistical models to approximate what we believe is the underlying process that generated data. To the extent that we correctly describe the data generating process that gave rise to the data, we can most efficiently (and validly) carry out analysis on the observed data.
</div>
</div>
<div id="introducing-geographically-weighted-regression" class="section level3" number="11.2.2">
<h3><span class="header-section-number">11.2.2</span> Introducing geographically weighted regression</h3>
<p><strong>Stationarity</strong> is the assumption that a statistic or parameter estimate is, on average, constant or homogenous across samples. By extension, <strong>spatial stationarity</strong> is the assumption that a statistic for a given study region is constant regardless of the spatial location. Examples of <strong>spatial non-stationarity</strong> were previously introduced with <em>geographically weighted summary statistics</em> (e.g. in <a href="disease-mapping-iii.html#gwss">Disease Mapping 3</a>), and more generally with the idea of spatially heterogeneous mean intensity of disease, as was tested with the spatial scan statistic or Poisson tests of excess risk. This notion that some places have <em>higher</em> and some places have <em>lower</em> risk or rates suggests that a single global statistic (e.g. the overall risk or rate) is not adequate for describing the health of the population; instead a set of local statistics are needed.</p>
<p>Spatially non-stationary disease intensity (e.g. spatial heterogeneity) is an example of <em>first order spatial variation</em>. In this context, ‘<em>first order</em>’ refers to the first statistical moment which is the mean expected value. So <em>first order spatial variation</em> is a variation in the mean disease rate. But we may also be interested in <em>second order spatial variation</em>, which refers not to the mean, but to the <em>covariance</em> among variables. Therefore, second order spatial processes reflect an interest in whether <em>relationships</em> among variables are constant (global; stationary) or heterogeneous (local; non-stationary).</p>
<p><em>Geographically weighted</em> <strong>regression</strong> (GWR) is the natural extension to <em>geographically weights</em> <strong>summary statistics</strong> when we wish to go from single variable mean intensity (first order process) to describe multivariable covariance patterns (second order process) in space. GWR is quite simply multivariable regression carried out iteratively with restrictions to specific geographic sub-sets of the entire study region, with an interest in estimating not just a single set of regression coefficients, <span class="math inline">\(\beta\)</span>, but instead a set of coefficients with one for each geographic sub-region (e.g. <span class="math inline">\(\beta_{x,y}\)</span>}).</p>
<p>Just as we had tools for statistically testing whether the spatial intensity (e.g. rate, prevalence) of disease was homogeneous versus heterogeneous, we can similarly use statistical tests to compare the fit of the <em>global</em> (stationary) regression model to the fit of the <em>local</em> (non-stationary) model. If there is evidence of better fit, even after penalty for multiple comparisons, then we can proceed with interpreting results from the GWR.</p>
<p>Geographically weighted regression is therefore a powerful tool for further characterizing or understanding the data generating process. It provides insight into spatial relationships by a) permitting local analysis of multivariable relationships; and b) statistically testing whether a single global model fits the data better or worse than an ensemble of local models, even after penalizing for multiple comparison. While this tool represents a significant step forward in our ability as spatial epidemiologists to understand spatial variation in population health – even accounting for confounding and heterogeneity of effects – the methods have several well-described limitations that collectively lead us to treat GWR as an <em>exploratory</em> tool:</p>
<ul>
<li><strong>Local multi-collinearity</strong>: Regression with highly colinear (highly correlated) predictor variables can produce statistically unstable regression coefficients due to variance inflation. In a single global dataset there may be sufficient distinction among variables to avoid this problem. However – because covariates may be spatially clustered – it is common that collinearity is a greater problem when restricting to specific sub-regions. Thus, GWR estimates could suffer from bias related to variance inflation and instability.</li>
<li><strong>Multiple comparison</strong>: It is evident that the analytic strategy of GWR is to re-fit a regression model multiple times, once for each sub-region in a study area. This quite reasonably raises concerns for multiple comparisons, particularly if statistical hypothesis tests are being conducted.</li>
<li><strong>Model overfitting</strong>: A known concern in regression modeling is that coefficients can be biased when the model begins to describe the ‘<em>random error</em>’ rather than the underlying relationships, reducing the generalizability of coefficients. This can occur from including too many covariates for a given number of observations, and therefore the process of restricting the geographic region for model fitting in GWR can lead to local overfitting.</li>
<li><strong>Local sensitivity to outliers</strong>: In global regression, we are aware that it is possible for single extreme observations to have undue influence on the estimation of regression coefficient. In linear regression, residual diagnostics focus on influence statistics to diagnose this problem. With GWR, the refitting of a model in multiple subsets of the data increases the risk that at least some of the local fits will be unduly influenced by outlier observations.</li>
<li><strong>Bandwidth selection</strong>: Just as we discussed when introducing kernel density estimation in Disease Mapping, a key driver of results when using kernel density functions to smooth or weight data is the bandwidth. Bandwidth is the radius of the kernel search area. In GWR, the kernel bandwidth defines how many observations (and with what weight) will be included in each local regression. A larger bandwidth will include more of the total data, but will limit the amount of spatial variation in coefficients. In contrast a smaller bandwidth will include less data in each fit but maximize the possible identification of local spatial variation.</li>
</ul>
</div>
<div id="making-epidemiologic-meaning-of-spatially-varying-coefficients" class="section level3" number="11.2.3">
<h3><span class="header-section-number">11.2.3</span> Making epidemiologic meaning of spatially varying coefficients</h3>
<p>Although <em>spatial heterogeneity</em> has been a theme throughout this course, it may not be obvious what exactly heterogeneity in regression coefficients means or tells us as epidemiologists. One analogy – and to be clear it is only an imperfect analogy and not an exact correspondence – is to conceive of <em>spatially varying regression coefficients</em> as akin to <em>statistical interaction</em> in non-spatial models.</p>
<p>In epidemiology, a powerful and important concept for describing causal effects of exposures or interventions on health outcomes, is that of <em>effect measure modification</em>. This is the idea that the causal effect of an exposure on the outcome is not homogenous (e.g. constant; stationary), but instead varies or <em>depends on</em> the value of a second covariate (e.g. is heterogeneous or non-stationary). An example of effect measure modification in non-spatial epidemiology would be if the magnitude of the causal effect of a drug treatment for preventing death in a given disease was larger in women as compared to men.</p>
<p>While it is common for analysts of epidemiologic data to incorporate <em>interaction terms</em> in multivariable regression in an effort to identify and estimate effect measure modification, it is important to recall that statistical interaction is not always (or perhaps is rarely) an indicator of causal effect measure modification. However, statistical interactions are tests for the idea of heterogeneity or variation in the magnitude (e.g. on an additive or multiplicative scale depending on the model being fit) of relationship or association between predictor and outcome.</p>
<p>Therefore, interpreting the spatially varying coefficients from a geographically weighted regression could be seen to be similar as interpreting the heterogeneous correlation evidenced by a statistical interaction in a non-spatial model: it describes <em>where</em> and <em>to what degree</em> the association between exposure and outcome differs or varies. If the statistical interaction were in fact identifying a causal process, it would be a form of <em>spatial effect measure modification</em>, or identification of how something about <em>location</em> modifies the relationship between exposure and outcome.</p>
</div>
<div id="distinguishing-variation-in-prevalence-from-variation-in-correlation" class="section level3" number="11.2.4">
<h3><span class="header-section-number">11.2.4</span> Distinguishing variation in <strong>prevalence</strong> from variation in <strong>correlation</strong></h3>
<p>One final conceptual challenge in interpreting spatially varying coefficients (and for interpreting statistical interactions in general) is to be clear about the role of spatially varying covariate <em>prevalence</em> as compared to the role of spatially varying <em>correlation</em> of covariate with outcome.</p>
<p>The GWR describes geographic regions where the magnitude of association between predictor/covariate and outcome is larger or smaller. However, that should not be confused with the overall prevalence of the predictor in those areas. For example, examine the maps below illustrating the <em>prevalence</em> of smoking and poor physical health in Atlanta census tracts (top two panels) as compared to the <em>strength of association</em> between each covariate and prevalence of poor mental health (bottom two panels).</p>
<div class="figure"><span id="fig:unnamed-chunk-286"></span>
<img src="images/gwr-prevalence.png" alt="GWR: Prevalence vs. Correlation"  />
<p class="caption">
FIGURE 11.1: GWR: Prevalence vs. Correlation
</p>
</div>
<p>The interpretation of regression coefficients is "<em>the change in <span class="math inline">\(Y\)</span> for each one-unit change in <span class="math inline">\(X\)</span></em>’. Therefore, what we see is that the prevalence of poor mental health increases more for every 1-unit increase in smoking prevalence in the southern part of the map as compared with the northern. On the other hand the prevalence of poor mental health increases more for every 1-unit increase in prevalence of poor physical health in census tracts in the northern part of the map.</p>
<p>However, when combined with the prevalence information, we can see that meaning of ‘<em>one-unit change</em>’ should be in the context of the variation in the covariates themselves. While the magnitude of association between poor physical health and poor mental health appears strongest in the north, those census tracts actually have quite low prevalence of poor physical health.</p>
<p>The point of this illustration is to consider whether your interest is in relative variation in magnitude of association, or the population impact which itself is related to baseline prevalence. Either could be relevant, but considering both prevalence and correlation/association provides more context.</p>
</div>
</div>
<div id="estimating-geogrpahically-weighted-regression-models" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Estimating geogrpahically weighted regression models</h2>
<div id="packages-and-data" class="section level3" number="11.3.1">
<h3><span class="header-section-number">11.3.1</span> Packages and Data</h3>
<p>There are at least four packages that provide functions for geographically weighted regression: <code>McSpatial</code>, <code>gwrr</code>, <code>spgwr</code>, and <code>GWModel</code>. We will be using the latter package, <code>GWModel</code> as it has much of the functionality of others, with additional diagnostic and model form capabilities.</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="spatial-regression-ii.html#cb291-1"></a><span class="kw">library</span>(GWmodel)   <span class="co"># For geographically-weighted statistics</span></span>
<span id="cb291-2"><a href="spatial-regression-ii.html#cb291-2"></a><span class="kw">library</span>(sf)        <span class="co"># For managing spatial data class sf</span></span>
<span id="cb291-3"><a href="spatial-regression-ii.html#cb291-3"></a><span class="kw">library</span>(sp)        <span class="co"># For managing spatial data class sp</span></span>
<span id="cb291-4"><a href="spatial-regression-ii.html#cb291-4"></a><span class="kw">library</span>(tmap)      <span class="co"># For mapping results</span></span>
<span id="cb291-5"><a href="spatial-regression-ii.html#cb291-5"></a><span class="kw">library</span>(dplyr)     <span class="co"># For data workflow</span></span>
<span id="cb291-6"><a href="spatial-regression-ii.html#cb291-6"></a><span class="kw">library</span>(raster)    <span class="co"># For converting spatial grid to raster in final section</span></span></code></pre></div>
<p>This example will use a dataset previously introduced in Lab. The <em>500-Cities Project</em> is part of a Robert Wood Johnson and CDC effort to increase availability of small-area health data. More information is available at the link below. Briefly, the project uses data from each state’s Behavioral Risk Factor Surveillance System (BRFSS) survey to estimate small area (census tract) prevalence of 24 BRFSS indicators. The estimation process employed by CDC to create the dataset uses restricted-access geocodes, as well as some model-interpolation assumptions.</p>
<p>The data are only available for select locations, and in the Atlanta area the census tracts available are in the cities of: Atlanta, Johns Creek, Sandy Springs, and Roswell. In addition to the BRFSS data, I have included exposure measures from other public-use data sets as indicated in the Data Dictionary below.</p>
<p>These data are at the geographic level of <em>census tracts</em> (although 500-cities actually estimates down to the census block group). The values for each measure (e.g. poor mental health, smoking, etc) are tract-specific <strong>prevalence</strong>. In other words these are purely <em>ecologic</em> data, and thus all regression below is <em>ecologic analysis</em>. While this has been true for most exercises this semester, it is particularly important to keep this fact in mind as we begin conducting multivariable regression.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="spatial-regression-ii.html#cb292-1"></a>atl &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&#39;BRFSS_Atl.gpkg&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb292-2"><a href="spatial-regression-ii.html#cb292-2"></a><span class="st">  </span><span class="kw">na.omit</span>() <span class="co"># na.omit() drops 2 tracts with missing variables</span></span></code></pre></div>
<div id="brfss-data" class="section level4" number="11.3.1.1">
<h4><span class="header-section-number">11.3.1.1</span> Data Dictionary</h4>
<table>
<colgroup>
<col width="20%" />
<col width="32%" />
<col width="47%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>FIPS</code></td>
<td>Census tract ID</td>
<td></td>
</tr>
<tr class="even">
<td><code>PopulationCount</code></td>
<td>Count of tract pop</td>
<td>500-cities, BRFSS</td>
</tr>
<tr class="odd">
<td><code>INSURANCE</code></td>
<td>Prevalence uninsured (18+)</td>
<td>500-cities, BRFSS</td>
</tr>
<tr class="even">
<td><code>SMOKING</code></td>
<td>Prevalence current smoking (18+)</td>
<td>500-cities, BRFSS</td>
</tr>
<tr class="odd">
<td><code>MENTALHLTH</code></td>
<td>Prevalence poor mental health &gt; 14 days (18+)m</td>
<td>500-cities, BRFSS</td>
</tr>
<tr class="even">
<td><code>MentalHlthCOUNT</code></td>
<td>(Estimated) count of poor mental health &gt;14 days</td>
<td>Calculated from 500-cities, BRFSS</td>
</tr>
<tr class="odd">
<td><code>PHYSHLTH</code></td>
<td>Prevalence poor physical health &gt; 14 days (18+)</td>
<td>500-cities, BRFSS</td>
</tr>
<tr class="even">
<td><code>ParkProximity_std</code></td>
<td>Distance to nearest park (z-score)</td>
<td>Opportunity Index</td>
</tr>
<tr class="odd">
<td><code>Vacancy_std</code></td>
<td>Prevalence vacant housing (z-score)</td>
<td>Opportunity Index</td>
</tr>
<tr class="even">
<td><code>HealthAccess_std</code></td>
<td># Health facilities within 2-miles (z-score)</td>
<td>Opportunity Index</td>
</tr>
<tr class="odd">
<td><code>Foreclosure_std</code></td>
<td>Prevalence foreclosure, 2010 (z-score)</td>
<td>Opportunity Index</td>
</tr>
<tr class="even">
<td><code>Poverty_std</code></td>
<td>Poverty rate (z-score)</td>
<td>Opportunity Index</td>
</tr>
<tr class="odd">
<td><code>PovertyRate</code></td>
<td>Poverty rate (%)</td>
<td>USDA Food Access Research Atlas</td>
</tr>
<tr class="even">
<td><code>MedianFamilyIncome</code></td>
<td>Median Income in tract ($)</td>
<td>USDA Food Access Research Atlas</td>
</tr>
<tr class="odd">
<td><code>PctSeniors</code></td>
<td>Ratio of seniors (65+) to total population (%)</td>
<td>USDA Food Access Research Atlas</td>
</tr>
<tr class="even">
<td><code>InstabilityStress</code></td>
<td>Summed z-score from Foreclosure &amp; Vacancy</td>
<td>Derived from Opportunity Index</td>
</tr>
<tr class="odd">
<td><code>geometry</code></td>
<td>Census tract polygon geom</td>
<td>US Census bureau</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="preparing-for-using-gwmodel" class="section level3" number="11.3.2">
<h3><span class="header-section-number">11.3.2</span> Preparing for using <code>GWModel</code></h3>

<div class="rmdnote">
Please note that you have already been introduced to the <code>GWModel</code> package through the use of <a href="disease-mapping-iii.html#gwss">geographically weighted summary statistics</a> in Disease Mapping 3. You might revisit that section (and the Part B lab from Disease Mapping 3), for a review of using kernel density weighting to produce locally smoothed <em>mean intensity</em> and <em>correlation</em> statistics.
</div>
<p>The <code>GWModel</code> package has not been updated to accommodate <code>sf</code> class spatial data in R yet. For that reason, it is necessary for us to convert the <code>sf</code> data to the <code>sp</code> class. Furthermore, the way the kernel density estimator evaluates which regions <em>are</em> versus <em>are not</em> in the ‘<em>local</em>’ region is by using a matrix of the distances between the centroid of every pair of census tracts (e.g. this is simply a different way of defining neighbors than what we used from the <code>spdep</code> package).</p>
<p>While each function in <code>GWModel</code> can calculate this distance matrix <em>on the fly</em>, because it will be needed so many times, it can be computationally efficient to calculate this <em>distance matrix</em> only once, and then simply provide the matrix to each function that needs it. Note that <code>GWModel</code> uses the distance matrix as an alternative to the spatial neighbor objects defined by the package <code>spdep</code>.</p>
<p>This code creates a <code>sp</code> object, then a large matrix that is <span class="math inline">\(185 X 185\)</span>, with each cell representing the Euclidean distance between pairs of tract centroids.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="spatial-regression-ii.html#cb293-1"></a><span class="co"># Create a copy of data in the &#39;sp&#39; format for use in some functions</span></span>
<span id="cb293-2"><a href="spatial-regression-ii.html#cb293-2"></a>atl.sp &lt;-<span class="st"> </span>atl <span class="op">%&gt;%</span></span>
<span id="cb293-3"><a href="spatial-regression-ii.html#cb293-3"></a><span class="st">  </span><span class="kw">as</span>(<span class="st">&#39;Spatial&#39;</span>)</span>
<span id="cb293-4"><a href="spatial-regression-ii.html#cb293-4"></a></span>
<span id="cb293-5"><a href="spatial-regression-ii.html#cb293-5"></a><span class="co"># Create distance matrix from centroids</span></span>
<span id="cb293-6"><a href="spatial-regression-ii.html#cb293-6"></a>atl.DM &lt;-<span class="st"> </span><span class="kw">gw.dist</span>(<span class="dt">dp.locat =</span> <span class="kw">coordinates</span>(atl.sp))</span></code></pre></div>

<div class="rmdnote">
By default, the distance is calculated between every pair of observations. In the default case a kernel density function is centered over <em>every single observation</em>. However, if you were analyzing a much larger dataset (e.g. thousands of points), this would be computationally inefficient and if points were close together might not add much new information. It is therefore possible to pre-define locations at which the kernel function will be centered to adequately cover the region in a more efficient manner. These points are often defined along a grid (e.g. every 1000 meters, for example), and define a subset of locations at which to fit the kernel. There is an illustration of this approach in the final section of this tutorial, and please note that this adaptation would be useful in many settings. However, for the immediate purposes we will accept the default behavior.
</div>
</div>
<div id="defining-local-optimizing-kernel-bandwidths" class="section level3" number="11.3.3">
<h3><span class="header-section-number">11.3.3</span> Defining local: optimizing kernel bandwidths</h3>
<p>Remember how we considered alternative definitions of <em>local</em> using kernel density estimates by changing the bandwidth of the kernel function? Recall the bandwidth is the radius of the search window, and the kernel is typically a bell-shaped curve (e.g. Gaussian or bi-square or similar). The <code>GWModel</code> package has many functions for using cross-validation (or AIC) to find an optimal (defined as best fitting) bandwidth for a given dataset. Unfortunately the <em>best fit</em> completely depends on the statistic being estimated. For that reason we may need to find a different bandwidth for each statistical test.</p>
<p>Just as with previous applications of kernel density functions, we can choose from a <em>fixed</em> or an <em>adaptive</em> bandwidth. <em>Fixed bandwidth</em> refers to a single kernel density radius to use in all parts of the study region. In contrast, <em>adaptive bandwidth</em> is a strategy to allow the radius to be adjusted to maintain a consistent amount of information, irrespective of changes in the population or area. In the case of <code>GWModel</code>, fixed bandwidths are defined in terms of the linear units of the map (e.g. meters in this case). In contrast adaptive bandwidths are defined by the number of units; therefore the kernel grows or shrinks in order to maintain a constant number of units ‘<em>under</em>’ the kernel function.</p>
<p>In <a href="disease-mapping-iii.html#gwss">Disease Mapping 3</a>, we used the function <code>bw.gwss.average()</code> to find an optimal bandwidth that was specific to calculation of geographically weighted summary statistics. However, the optimal bandwidth can be different for each statistic of interest, and therefore the procedure for finding an optima for <em>geographically weighted regression</em> is different.</p>
<p>The function <code>bw.gwr()</code> uses cross-validation to find optimum bandwidth for a geographically weighted <em>regression</em> rather than <em>summary statistics</em>.</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="spatial-regression-ii.html#cb294-1"></a>h.fixed &lt;-<span class="st"> </span><span class="kw">bw.gwr</span>(MENTALHLTH <span class="op">~</span><span class="st"> </span>SMOKING <span class="op">+</span><span class="st"> </span>PHYSHLTH, </span>
<span id="cb294-2"><a href="spatial-regression-ii.html#cb294-2"></a>             <span class="dt">data =</span> atl.sp, </span>
<span id="cb294-3"><a href="spatial-regression-ii.html#cb294-3"></a>             <span class="dt">dMat =</span> atl.DM)</span>
<span id="cb294-4"><a href="spatial-regression-ii.html#cb294-4"></a></span>
<span id="cb294-5"><a href="spatial-regression-ii.html#cb294-5"></a>h.adapt &lt;-<span class="st"> </span><span class="kw">bw.gwr</span>(MENTALHLTH <span class="op">~</span><span class="st"> </span>SMOKING <span class="op">+</span><span class="st"> </span>PHYSHLTH, </span>
<span id="cb294-6"><a href="spatial-regression-ii.html#cb294-6"></a>             <span class="dt">data =</span> atl.sp, </span>
<span id="cb294-7"><a href="spatial-regression-ii.html#cb294-7"></a>             <span class="dt">adaptive =</span> T,</span>
<span id="cb294-8"><a href="spatial-regression-ii.html#cb294-8"></a>             <span class="dt">dMat =</span> atl.DM)</span></code></pre></div>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="spatial-regression-ii.html#cb295-1"></a>h.fixed</span></code></pre></div>
<pre><code>## [1] 12082.4</code></pre>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="spatial-regression-ii.html#cb297-1"></a>h.adapt</span></code></pre></div>
<pre><code>## [1] 59</code></pre>
<p>The optimal bandwidth <em>for this specific regression model</em> is either a fixed radius of 1.2082396^{4} meters, or else an adaptive bandwidth that always maintains 59 census tracts within the local region, regardless of their relative size (e.g. this is akin to k-nearest neighbors).</p>
</div>
<div id="geographically-weighted-regression" class="section level3" number="11.3.4">
<h3><span class="header-section-number">11.3.4</span> Geographically weighted regression</h3>
<p><code>GWModel</code> offers a wide range of modeling tools including geographically weighted linear regression, Poisson regression, binomial regression, and even local fitting options including adjustment for local heteroscedasticity, and local ridge regression which is robust to collinearity.</p>
<p>Because our outcome, <code>MENTALHLTH</code> is continuous and relatively normally distributed, basic linear geographically weighted regression will work.</p>
<p>The fitting of <em>basic</em> (meaning linear) GWR models is via the function <code>gwr.basic()</code>. Just as there are many functions in <code>GWModel</code> that begin with <code>bw.x</code> for estimating bandwidths, there are many functions that begins with <code>gwr.x</code> for fitting a variety of models. Look at the help documentation.</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="spatial-regression-ii.html#cb299-1"></a>m &lt;-<span class="st"> </span><span class="kw">gwr.basic</span>(MENTALHLTH <span class="op">~</span><span class="st"> </span>SMOKING <span class="op">+</span><span class="st"> </span>PHYSHLTH, </span>
<span id="cb299-2"><a href="spatial-regression-ii.html#cb299-2"></a>             <span class="dt">data =</span> atl.sp, </span>
<span id="cb299-3"><a href="spatial-regression-ii.html#cb299-3"></a>             <span class="dt">bw =</span> h.adapt,</span>
<span id="cb299-4"><a href="spatial-regression-ii.html#cb299-4"></a>             <span class="dt">adaptive =</span> T,</span>
<span id="cb299-5"><a href="spatial-regression-ii.html#cb299-5"></a>             <span class="dt">dMat =</span> atl.DM)</span></code></pre></div>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="spatial-regression-ii.html#cb300-1"></a><span class="kw">print</span>(m)</span></code></pre></div>
<pre><code>##    ***********************************************************************
##    *                       Package   GWmodel                             *
##    ***********************************************************************
##    Program starts at: 2020-10-24 11:14:44 
##    Call:
##    gwr.basic(formula = MENTALHLTH ~ SMOKING + PHYSHLTH, data = atl.sp, 
##     bw = h.adapt, adaptive = T, dMat = atl.DM)
## 
##    Dependent (y) variable:  MENTALHLTH
##    Independent variables:  SMOKING PHYSHLTH
##    Number of data points: 185
##    ***********************************************************************
##    *                    Results of Global Regression                     *
##    ***********************************************************************
## 
##    Call:
##     lm(formula = formula, data = data)
## 
##    Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4988 -0.9689 -0.1638  0.6708  5.7530 
## 
##    Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
##    (Intercept)  3.13908    0.28497  11.015  &lt; 2e-16 ***
##    SMOKING      0.16286    0.02830   5.754 3.64e-08 ***
##    PHYSHLTH     0.50325    0.04137  12.166  &lt; 2e-16 ***
## 
##    ---Significance stars
##    Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 
##    Residual standard error: 1.451 on 182 degrees of freedom
##    Multiple R-squared: 0.8523
##    Adjusted R-squared: 0.8507 
##    F-statistic: 525.1 on 2 and 182 DF,  p-value: &lt; 2.2e-16 
##    ***Extra Diagnostic information
##    Residual sum of squares: 383.1576
##    Sigma(hat): 1.446982
##    AIC:  667.704
##    AICc:  667.9262
##    ***********************************************************************
##    *          Results of Geographically Weighted Regression              *
##    ***********************************************************************
## 
##    *********************Model calibration information*********************
##    Kernel function: bisquare 
##    Adaptive bandwidth: 59 (number of nearest neighbours)
##    Regression points: the same locations as observations are used.
##    Distance metric: A distance matrix is specified for this model calibration.
## 
##    ****************Summary of GWR coefficient estimates:******************
##                    Min.    1st Qu.     Median    3rd Qu.   Max.
##    Intercept -1.4633747 -0.0771617  3.0706879  3.9759400 8.0903
##    SMOKING   -0.0074907  0.0599293  0.1369631  0.3200178 0.6134
##    PHYSHLTH  -0.1574946  0.1773786  0.5613934  0.9628009 1.1627
##    ************************Diagnostic information*************************
##    Number of data points: 185 
##    Effective number of parameters (2trace(S) - trace(S&#39;S)): 27.10305 
##    Effective degrees of freedom (n-2trace(S) + trace(S&#39;S)): 157.8969 
##    AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 568.6092 
##    AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 540.1906 
##    Residual sum of squares: 179.7807 
##    R-square value:  0.9307003 
##    Adjusted R-square value:  0.9187292 
## 
##    ***********************************************************************
##    Program stops at: 2020-10-24 11:14:44</code></pre>
<p>This procedure produces a lot of output! Examine the output above, and review some of the key points of interest:</p>
<ol style="list-style-type: decimal">
<li>Check whether the <em>local</em> (GWR) model fits better than the <em>global</em> (aspatial) model by comparing the AICc from the global model at the top of the output to the AICc from the GWR at the bottom. The AICc is a fit statistics that penalizes for additional parameters, including the many parameters being estimated by repeating the model many times. Therefore we only find evidence of non-stationarity when the AICc for the GWR is <strong>smaller than</strong> then AICc for the global model (typically a difference in AICc of 3 or greater is sufficient to say the local model fits better). In this case the GWR fits much better than the global, suggesting significant non-stationarity in the relationships in this model.</li>
<li>Next compare the magnitude of the regression coefficients in the global fit (top) to the <em>range of coefficients</em> in the GWR (lower portion of output). Which variables appear to <em>vary</em> the most? Using the interquartile comparison (e.g. comparing Q1 to Q3 of the range of coefficients), the absolute difference is greatest for <code>PHYSHLTH</code>, although <code>SMOKING</code> also has substantial variation.</li>
<li>Look at the variance explained as summarized by the adjusted <span class="math inline">\(R^2\)</span> value. Both the global and the GWR models explain a great deal of variance, but the GWR has a higher <span class="math inline">\(R^2\)</span> of 0.93.</li>
</ol>
</div>
<div id="checking-local-multi-collinearity" class="section level3" number="11.3.5">
<h3><span class="header-section-number">11.3.5</span> Checking local multi-collinearity</h3>
<p>While collinearity is a possible concern in any regression model, its importance in GWR is heightened by the fact that the model is re-fit in geographic subsets of the data where variables would be anticipated to have higher correlation than in the study region at large (e.g. like things tends to be near like things). Multicollinearity does not bias results, but because of variance inflation can produce statistically unreliable (imprecise) estimates.</p>
<p>We can first carry out collinearity diagnostics on the model results, and then if we find evidence for concerning multicollinearity we could either alter the model (remove culprit covariates) or consider fitting model forms robust to collinearity including <em>local ridge regression</em> available via the function <code>gwr.lcr()</code>.</p>
<p>For now we will begin with diagnostics. The function <code>gwr.collin.diagno()</code> returns the Condition Number and Variance Inflation Factor (VIF) from the model fit above.</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="spatial-regression-ii.html#cb302-1"></a>collin &lt;-<span class="st"> </span><span class="kw">gwr.collin.diagno</span>(MENTALHLTH <span class="op">~</span><span class="st"> </span>SMOKING <span class="op">+</span><span class="st"> </span>PHYSHLTH,</span>
<span id="cb302-2"><a href="spatial-regression-ii.html#cb302-2"></a>                            <span class="dt">data =</span> atl.sp,</span>
<span id="cb302-3"><a href="spatial-regression-ii.html#cb302-3"></a>                            <span class="dt">adaptive =</span> T,</span>
<span id="cb302-4"><a href="spatial-regression-ii.html#cb302-4"></a>                            <span class="dt">dMat =</span> atl.DM,</span>
<span id="cb302-5"><a href="spatial-regression-ii.html#cb302-5"></a>                            <span class="dt">bw =</span> h.adapt)</span></code></pre></div>
<p>There is neither a <code>print()</code> nor a <code>summary()</code> function for the output of this function. However to see the output summarized as a spatial object we can look at the names of <code>collin$SDF</code>:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="spatial-regression-ii.html#cb303-1"></a><span class="kw">names</span>(collin<span class="op">$</span>SDF)</span></code></pre></div>
<pre><code>## [1] &quot;SMOKING_VIF&quot;             &quot;PHYSHLTH_VIF&quot;           
## [3] &quot;local_CN&quot;                &quot;Intercept_VDP&quot;          
## [5] &quot;SMOKING_VDP&quot;             &quot;PHYSHLTH_VDP&quot;           
## [7] &quot;Corr_Intercept.SMOKING&quot;  &quot;Corr_Intercept.PHYSHLTH&quot;
## [9] &quot;Corr_SMOKING.PHYSHLTH&quot;</code></pre>
<p>You will see that there is an overall Condition Number, as well as Variance Inflation Factors (VIF) and Variance Decomposition Proportions (VDP) for each variable. In evaluating for concerning collinearity, we can map these values to understand whether (and if so, <em>where</em>) there is evidence of collinearity.</p>
<p>For instance we might start looking at the local Condition Number; a rule of thumb suggests that a value over 30 is evidence of important multicollinearity.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="spatial-regression-ii.html#cb305-1"></a><span class="kw">tm_shape</span>(collin<span class="op">$</span>SDF) <span class="op">+</span></span>
<span id="cb305-2"><a href="spatial-regression-ii.html#cb305-2"></a><span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&#39;local_CN&#39;</span>,</span>
<span id="cb305-3"><a href="spatial-regression-ii.html#cb305-3"></a>          <span class="dt">style =</span> <span class="st">&#39;fixed&#39;</span>,</span>
<span id="cb305-4"><a href="spatial-regression-ii.html#cb305-4"></a>          <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="dv">25</span>,<span class="dv">30</span>,<span class="dv">35</span>),</span>
<span id="cb305-5"><a href="spatial-regression-ii.html#cb305-5"></a>          <span class="dt">palette =</span> <span class="st">&#39;-PRGn&#39;</span>)<span class="op">+</span></span>
<span id="cb305-6"><a href="spatial-regression-ii.html#cb305-6"></a><span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) </span></code></pre></div>
<p><img src="EPI563-SpatialEPI_files/figure-html/unnamed-chunk-299-1.png" width="672" /></p>
<p>It looks like only a portion of southwest Atlanta have concerning CN’s. Now we can look at the VIF for variables to see which are culprits (and where).</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="spatial-regression-ii.html#cb306-1"></a><span class="kw">tm_shape</span>(collin<span class="op">$</span>SDF) <span class="op">+</span></span>
<span id="cb306-2"><a href="spatial-regression-ii.html#cb306-2"></a><span class="st">  </span><span class="kw">tm_fill</span>(<span class="kw">c</span>(<span class="st">&#39;SMOKING_VIF&#39;</span>, <span class="st">&#39;PHYSHLTH_VIF&#39;</span>),</span>
<span id="cb306-3"><a href="spatial-regression-ii.html#cb306-3"></a>          <span class="dt">style =</span> <span class="st">&#39;fixed&#39;</span>,</span>
<span id="cb306-4"><a href="spatial-regression-ii.html#cb306-4"></a>          <span class="dt">breaks =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb306-5"><a href="spatial-regression-ii.html#cb306-5"></a>          <span class="dt">palette =</span> <span class="st">&#39;-PRGn&#39;</span>) <span class="op">+</span></span>
<span id="cb306-6"><a href="spatial-regression-ii.html#cb306-6"></a><span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) </span></code></pre></div>
<p><img src="EPI563-SpatialEPI_files/figure-html/unnamed-chunk-300-1.png" width="672" /></p>
<p>From this we can see that no places have VIF for any variable above 4; this suggests that there is no meaningful local variance inflation from this model. We could continue to explore diagnostics, but for now this is satisfactory finding.</p>
</div>
<div id="adjusting-for-multiple-comparisons" class="section level3" number="11.3.6">
<h3><span class="header-section-number">11.3.6</span> Adjusting for multiple comparisons</h3>
<p>First, let’s look more closely at the output of our call to <code>gwr.basic()</code> above. Specifically, let’s look at the names of the <code>m$SDF</code> portion of the output.</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="spatial-regression-ii.html#cb307-1"></a><span class="kw">names</span>(m<span class="op">$</span>SDF)</span></code></pre></div>
<pre><code>##  [1] &quot;Intercept&quot;     &quot;SMOKING&quot;       &quot;PHYSHLTH&quot;      &quot;y&quot;            
##  [5] &quot;yhat&quot;          &quot;residual&quot;      &quot;CV_Score&quot;      &quot;Stud_residual&quot;
##  [9] &quot;Intercept_SE&quot;  &quot;SMOKING_SE&quot;    &quot;PHYSHLTH_SE&quot;   &quot;Intercept_TV&quot; 
## [13] &quot;SMOKING_TV&quot;    &quot;PHYSHLTH_TV&quot;   &quot;Local_R2&quot;</code></pre>
<p>Not surprisingly, we see there are values for the estimate of the local intercept, and the regression coefficients for each predictor. But in addition there is a standard error for each coefficient, as well as a t-value test statistic which relates to its significance. This is simply the local version of all the information from the global regression output above, but it provides the information necessary to determine whether each covariate is <em>statistically significantly</em> associated with the outcome, should that be of interest.</p>
<p>However, the presence of these local test statistics of significance highlight another critique of GWR, which is the repetition of tests across the study region. While repeating tests centered on each county in turn do not reflect fully independent tests (there is a lot of the same information in each new <em>window</em> of the kernel), there is clearly some concern about making inference (for example via tests of statistical significance) when multiple testing has occurred.</p>
<p>However we can adjust the test statistic to account for multiple comparison using the function <code>gwr.t.adjust()</code>. This function takes a <code>gwrm.Obj</code> object which is the output of the <code>gwr.basic()</code> function as its input, and returns a set of p-values adjusted for multiple comparisons in different ways.</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="spatial-regression-ii.html#cb309-1"></a>t.adj &lt;-<span class="st"> </span><span class="kw">gwr.t.adjust</span>(m)</span></code></pre></div>
<p>The function calculates adjusted p-values under four alternative schemes. One is the familiar <em>Bonferroni</em> adjustment, which is almost surely too conservative, because it assumes that every test location was a completely independent sample (which by definition of GWR is false). The other approaches are various versions of False Discovery Rate algorithms which try to assess the degree of <em>dependence</em> between tests to determine how the <em>effective number</em> of tests conducted (e.g. the equivalent of the number of unique, independent tests after accounting for overlapping information). Any could work, but at least one review suggest the <em>Benjamini-Yekutieli</em> method is a good middle ground.</p>
<p>If you look at the results returned by the function above you will see that adjusted p-values are provided for each method with the <em>Benjamini-Yekutieli</em> indicated by the *_by* suffix.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="spatial-regression-ii.html#cb310-1"></a><span class="kw">names</span>(t.adj<span class="op">$</span>SDF)</span></code></pre></div>
<pre><code>##  [1] &quot;Intercept_t&quot;    &quot;SMOKING_t&quot;      &quot;PHYSHLTH_t&quot;     &quot;Intercept_p&quot;   
##  [5] &quot;SMOKING_p&quot;      &quot;PHYSHLTH_p&quot;     &quot;Intercept_p_by&quot; &quot;SMOKING_p_by&quot;  
##  [9] &quot;PHYSHLTH_p_by&quot;  &quot;Intercept_p_fb&quot; &quot;SMOKING_p_fb&quot;   &quot;PHYSHLTH_p_fb&quot; 
## [13] &quot;Intercept_p_bo&quot; &quot;SMOKING_p_bo&quot;   &quot;PHYSHLTH_p_bo&quot;  &quot;Intercept_p_bh&quot;
## [17] &quot;SMOKING_p_bh&quot;   &quot;PHYSHLTH_p_bh&quot;</code></pre>
</div>
<div id="visualizing-model-inference" class="section level3" number="11.3.7">
<h3><span class="header-section-number">11.3.7</span> Visualizing model inference</h3>
<p>Finally, we are ready to visualize the results of our GWR model. There are many ways to visualize the significance of each parameter. Here is one approach. In the code chunk below I do the following things:</p>
<ol style="list-style-type: decimal">
<li>Convert from <code>sp</code> to <code>sf</code> so that I can take advantage of the data manipulation for <code>sf</code> objects using <code>dplyr()</code>.</li>
<li>Recode the adjusted p-value for each coefficient (e.g. <code>Intercept</code>, <code>SMOKING</code>, and <code>PHYSHLTH</code>) to indicate counties where the respective coefficient p-value is &lt;0.05, naming the resulting variable <code>pval</code></li>
<li>Group counties by whether their covariate coefficient <em>is</em> or <em>is not</em> statistically significant by grouping on variable <code>pval</code></li>
<li>Use the <code>summarise()</code> function to aggregate the 185 census tracts into either significant or not.</li>
<li>Finally, use <code>filter()</code> to exclude the non-significant regions. Note we are not removing the actual coefficients used for the choropleth map! Instead we are just selecting for the outlines of census tracts that are <em>statistically significant</em> adjusting for multiple comparisons.</li>
</ol>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="spatial-regression-ii.html#cb312-1"></a><span class="co"># Create a spatial object delineating statistically significant INTERCEPT coefficients</span></span>
<span id="cb312-2"><a href="spatial-regression-ii.html#cb312-2"></a>intercept.p &lt;-<span class="st"> </span>t.adj<span class="op">$</span>SDF <span class="op">%&gt;%</span></span>
<span id="cb312-3"><a href="spatial-regression-ii.html#cb312-3"></a><span class="st">  </span><span class="kw">st_as_sf</span>() <span class="op">%&gt;%</span></span>
<span id="cb312-4"><a href="spatial-regression-ii.html#cb312-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pval =</span> <span class="kw">ifelse</span>(SMOKING_p_by <span class="op">&lt;</span><span class="fl">0.05</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb312-5"><a href="spatial-regression-ii.html#cb312-5"></a><span class="st">  </span><span class="kw">group_by</span>(pval) <span class="op">%&gt;%</span></span>
<span id="cb312-6"><a href="spatial-regression-ii.html#cb312-6"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb312-7"><a href="spatial-regression-ii.html#cb312-7"></a><span class="st">  </span><span class="kw">filter</span>(pval <span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb312-8"><a href="spatial-regression-ii.html#cb312-8"></a></span>
<span id="cb312-9"><a href="spatial-regression-ii.html#cb312-9"></a></span>
<span id="cb312-10"><a href="spatial-regression-ii.html#cb312-10"></a></span>
<span id="cb312-11"><a href="spatial-regression-ii.html#cb312-11"></a><span class="co"># Create a spatial object delineating statistically significant SMOKING coefficients</span></span>
<span id="cb312-12"><a href="spatial-regression-ii.html#cb312-12"></a>smoke.p &lt;-<span class="st"> </span>t.adj<span class="op">$</span>SDF <span class="op">%&gt;%</span></span>
<span id="cb312-13"><a href="spatial-regression-ii.html#cb312-13"></a><span class="st">  </span><span class="kw">st_as_sf</span>() <span class="op">%&gt;%</span></span>
<span id="cb312-14"><a href="spatial-regression-ii.html#cb312-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pval =</span> <span class="kw">ifelse</span>(Intercept_p_by <span class="op">&lt;</span><span class="fl">0.05</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb312-15"><a href="spatial-regression-ii.html#cb312-15"></a><span class="st">  </span><span class="kw">group_by</span>(pval) <span class="op">%&gt;%</span></span>
<span id="cb312-16"><a href="spatial-regression-ii.html#cb312-16"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb312-17"><a href="spatial-regression-ii.html#cb312-17"></a><span class="st">  </span><span class="kw">filter</span>(pval <span class="op">==</span><span class="dv">1</span>)</span>
<span id="cb312-18"><a href="spatial-regression-ii.html#cb312-18"></a></span>
<span id="cb312-19"><a href="spatial-regression-ii.html#cb312-19"></a></span>
<span id="cb312-20"><a href="spatial-regression-ii.html#cb312-20"></a><span class="co"># Create a spatial object delineating statistically significant PHYHLTH coefficients</span></span>
<span id="cb312-21"><a href="spatial-regression-ii.html#cb312-21"></a>physhlth.p &lt;-<span class="st"> </span>t.adj<span class="op">$</span>SDF <span class="op">%&gt;%</span></span>
<span id="cb312-22"><a href="spatial-regression-ii.html#cb312-22"></a><span class="st">  </span><span class="kw">st_as_sf</span>() <span class="op">%&gt;%</span></span>
<span id="cb312-23"><a href="spatial-regression-ii.html#cb312-23"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pval =</span> <span class="kw">ifelse</span>(PHYSHLTH_p_by <span class="op">&lt;</span><span class="fl">0.05</span>, <span class="dv">1</span>, <span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb312-24"><a href="spatial-regression-ii.html#cb312-24"></a><span class="st">  </span><span class="kw">group_by</span>(pval) <span class="op">%&gt;%</span></span>
<span id="cb312-25"><a href="spatial-regression-ii.html#cb312-25"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">count =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span></span>
<span id="cb312-26"><a href="spatial-regression-ii.html#cb312-26"></a><span class="st">  </span><span class="kw">filter</span>(pval <span class="op">==</span><span class="dv">1</span>)</span></code></pre></div>
<p>With this complete, we can now map the geographically weighted regression coefficient (along with adjusted test of significance) for the association of <code>SMOKING</code>, conditional on other variables, with <code>MENTALHLTH</code>. The <code>tmap</code> code below should be relatively familiar at this point, with the exception of a couple additions:</p>
<ul>
<li>I use the function <code>tm_add_legend()</code> to manually specify that I want the legend to include red lines labeled as ‘p-value &lt; 0.05’.</li>
<li>In <code>R</code> there are different ways to get Greek letters and other symbols in plots. In <code>tmap</code> the only one I have found to work is the use of <em>Unicode</em> values. These are unique codes for every possible symbol. If you Google ‘unicode Greek letters’ you will find lists. In the <code>smoke.coefficients</code> map below I specify the title of the legend to be <code>\u03B2</code> which is the value specific to a Greek <span class="math inline">\(\beta\)</span>.</li>
</ul>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="spatial-regression-ii.html#cb313-1"></a><span class="co"># Map of observed prevalence of smoking</span></span>
<span id="cb313-2"><a href="spatial-regression-ii.html#cb313-2"></a>smoke.prev &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(atl) <span class="op">+</span></span>
<span id="cb313-3"><a href="spatial-regression-ii.html#cb313-3"></a><span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&#39;SMOKING&#39;</span>,</span>
<span id="cb313-4"><a href="spatial-regression-ii.html#cb313-4"></a>          <span class="dt">style =</span> <span class="st">&#39;quantile&#39;</span>,</span>
<span id="cb313-5"><a href="spatial-regression-ii.html#cb313-5"></a>          <span class="dt">palette =</span> <span class="st">&#39;BuPu&#39;</span>,</span>
<span id="cb313-6"><a href="spatial-regression-ii.html#cb313-6"></a>          <span class="dt">title =</span> <span class="st">&#39;%&#39;</span>) <span class="op">+</span></span>
<span id="cb313-7"><a href="spatial-regression-ii.html#cb313-7"></a><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span></span>
<span id="cb313-8"><a href="spatial-regression-ii.html#cb313-8"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">title =</span> <span class="st">&#39;Prevalence of smoking&#39;</span>,</span>
<span id="cb313-9"><a href="spatial-regression-ii.html#cb313-9"></a>          <span class="dt">legend.format =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="dv">1</span>))</span>
<span id="cb313-10"><a href="spatial-regression-ii.html#cb313-10"></a></span>
<span id="cb313-11"><a href="spatial-regression-ii.html#cb313-11"></a><span class="co"># Map for spatially varying SMOKING coefficients</span></span>
<span id="cb313-12"><a href="spatial-regression-ii.html#cb313-12"></a>smoke.coefficients &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(m<span class="op">$</span>SDF) <span class="op">+</span></span>
<span id="cb313-13"><a href="spatial-regression-ii.html#cb313-13"></a><span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&#39;SMOKING&#39;</span>,</span>
<span id="cb313-14"><a href="spatial-regression-ii.html#cb313-14"></a>          <span class="dt">style =</span> <span class="st">&#39;quantile&#39;</span>,</span>
<span id="cb313-15"><a href="spatial-regression-ii.html#cb313-15"></a>          <span class="dt">title =</span> <span class="st">&#39;\u03B2&#39;</span>) <span class="op">+</span></span>
<span id="cb313-16"><a href="spatial-regression-ii.html#cb313-16"></a><span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb313-17"><a href="spatial-regression-ii.html#cb313-17"></a><span class="kw">tm_shape</span>(smoke.p) <span class="op">+</span></span>
<span id="cb313-18"><a href="spatial-regression-ii.html#cb313-18"></a><span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, </span>
<span id="cb313-19"><a href="spatial-regression-ii.html#cb313-19"></a>             <span class="dt">lwd =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb313-20"><a href="spatial-regression-ii.html#cb313-20"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">title =</span> <span class="st">&#39;Coefficients for SMOKING&#39;</span>,</span>
<span id="cb313-21"><a href="spatial-regression-ii.html#cb313-21"></a>          <span class="dt">legend.format =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb313-22"><a href="spatial-regression-ii.html#cb313-22"></a><span class="kw">tm_add_legend</span>(<span class="dt">type =</span> <span class="st">&#39;line&#39;</span>,</span>
<span id="cb313-23"><a href="spatial-regression-ii.html#cb313-23"></a>              <span class="dt">labels =</span> <span class="st">&#39;p-value &lt; 0.05&#39;</span>,</span>
<span id="cb313-24"><a href="spatial-regression-ii.html#cb313-24"></a>              <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb313-25"><a href="spatial-regression-ii.html#cb313-25"></a></span>
<span id="cb313-26"><a href="spatial-regression-ii.html#cb313-26"></a><span class="kw">tmap_arrange</span>(smoke.prev, smoke.coefficients)</span></code></pre></div>
<p><img src="EPI563-SpatialEPI_files/figure-html/unnamed-chunk-305-1.png" width="672" /></p>
<p>This map demonstrates several things about the relationship between local prevalence of smoking and prevalence of poor mental health (the outcome) at the census tract level.</p>
<ol style="list-style-type: decimal">
<li>First, as a reminder, we have the map of the observed prevalence (a predictor of poor mental health) in the left hand map. Smoking prevalence is higher in South Atlanta.</li>
<li>It is evident that the relationship between smoking and poor mental health is not stationary, but instead quite non-stationary or location-dependent. We see this evidenced by the fact that the coefficient ranges in the right-hand panel from essentially zero (e.g. in the north) to 0.6 in the southwest.</li>
<li>Finally, while the global model suggested smoking was a statistically significant predictor of poor mental health, it appears from the right-hand map that this is only true in <em>part of the study area</em>. In other words, smoking <em>is not significantly</em> associated with poor mental health in regions outside of the zone delineated by the red line.</li>
</ol>
<p>We can examine all three coefficients together like this:</p>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="spatial-regression-ii.html#cb314-1"></a><span class="co"># Map for spatially varying intercepts</span></span>
<span id="cb314-2"><a href="spatial-regression-ii.html#cb314-2"></a>int.coefficients &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(m<span class="op">$</span>SDF) <span class="op">+</span></span>
<span id="cb314-3"><a href="spatial-regression-ii.html#cb314-3"></a><span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&#39;Intercept&#39;</span>,</span>
<span id="cb314-4"><a href="spatial-regression-ii.html#cb314-4"></a>          <span class="dt">style =</span> <span class="st">&#39;quantile&#39;</span>,</span>
<span id="cb314-5"><a href="spatial-regression-ii.html#cb314-5"></a>          <span class="dt">title =</span> <span class="st">&#39;\u03B2&#39;</span>,</span>
<span id="cb314-6"><a href="spatial-regression-ii.html#cb314-6"></a>          <span class="dt">palette =</span> <span class="st">&#39;OrRd&#39;</span>) <span class="op">+</span></span>
<span id="cb314-7"><a href="spatial-regression-ii.html#cb314-7"></a><span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb314-8"><a href="spatial-regression-ii.html#cb314-8"></a><span class="kw">tm_shape</span>(intercept.p) <span class="op">+</span></span>
<span id="cb314-9"><a href="spatial-regression-ii.html#cb314-9"></a><span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, </span>
<span id="cb314-10"><a href="spatial-regression-ii.html#cb314-10"></a>             <span class="dt">lwd =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb314-11"><a href="spatial-regression-ii.html#cb314-11"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">title =</span> <span class="st">&#39;Intercepts&#39;</span>,</span>
<span id="cb314-12"><a href="spatial-regression-ii.html#cb314-12"></a>          <span class="dt">legend.format =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb314-13"><a href="spatial-regression-ii.html#cb314-13"></a><span class="kw">tm_add_legend</span>(<span class="dt">type =</span> <span class="st">&#39;line&#39;</span>,</span>
<span id="cb314-14"><a href="spatial-regression-ii.html#cb314-14"></a>              <span class="dt">labels =</span> <span class="st">&#39;p-value &lt; 0.05&#39;</span>,</span>
<span id="cb314-15"><a href="spatial-regression-ii.html#cb314-15"></a>              <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb314-16"><a href="spatial-regression-ii.html#cb314-16"></a></span>
<span id="cb314-17"><a href="spatial-regression-ii.html#cb314-17"></a><span class="co"># Map for spatially varying PHYSHLTH coefficients</span></span>
<span id="cb314-18"><a href="spatial-regression-ii.html#cb314-18"></a>physhlth.coefficients &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(m<span class="op">$</span>SDF) <span class="op">+</span></span>
<span id="cb314-19"><a href="spatial-regression-ii.html#cb314-19"></a><span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&#39;PHYSHLTH&#39;</span>,</span>
<span id="cb314-20"><a href="spatial-regression-ii.html#cb314-20"></a>          <span class="dt">style =</span> <span class="st">&#39;quantile&#39;</span>,</span>
<span id="cb314-21"><a href="spatial-regression-ii.html#cb314-21"></a>          <span class="dt">title =</span> <span class="st">&#39;\u03B2&#39;</span>,</span>
<span id="cb314-22"><a href="spatial-regression-ii.html#cb314-22"></a>          <span class="dt">palette =</span> <span class="st">&#39;YlGnBu&#39;</span>) <span class="op">+</span></span>
<span id="cb314-23"><a href="spatial-regression-ii.html#cb314-23"></a><span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">alpha =</span> <span class="fl">0.2</span>) <span class="op">+</span></span>
<span id="cb314-24"><a href="spatial-regression-ii.html#cb314-24"></a><span class="kw">tm_shape</span>(physhlth.p) <span class="op">+</span></span>
<span id="cb314-25"><a href="spatial-regression-ii.html#cb314-25"></a><span class="st">  </span><span class="kw">tm_borders</span>(<span class="dt">col =</span> <span class="st">&#39;red&#39;</span>, </span>
<span id="cb314-26"><a href="spatial-regression-ii.html#cb314-26"></a>             <span class="dt">lwd =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb314-27"><a href="spatial-regression-ii.html#cb314-27"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">title =</span> <span class="st">&#39;Coefficients for PHYSHLTH&#39;</span>,</span>
<span id="cb314-28"><a href="spatial-regression-ii.html#cb314-28"></a>          <span class="dt">legend.format =</span> <span class="kw">list</span>(<span class="dt">digits =</span> <span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb314-29"><a href="spatial-regression-ii.html#cb314-29"></a><span class="kw">tm_add_legend</span>(<span class="dt">type =</span> <span class="st">&#39;line&#39;</span>,</span>
<span id="cb314-30"><a href="spatial-regression-ii.html#cb314-30"></a>              <span class="dt">labels =</span> <span class="st">&#39;p-value &lt; 0.05&#39;</span>,</span>
<span id="cb314-31"><a href="spatial-regression-ii.html#cb314-31"></a>              <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb314-32"><a href="spatial-regression-ii.html#cb314-32"></a></span>
<span id="cb314-33"><a href="spatial-regression-ii.html#cb314-33"></a><span class="kw">tmap_arrange</span>(int.coefficients, smoke.coefficients, physhlth.coefficients)</span></code></pre></div>
<p><img src="EPI563-SpatialEPI_files/figure-html/unnamed-chunk-306-1.png" width="672" /></p>
</div>
<div id="extensions" class="section level3" number="11.3.8">
<h3><span class="header-section-number">11.3.8</span> Extensions</h3>
<p>Unlike some other tools we’ve learned in this class, GWR is quite widely adaptable to a variety of situations. For example it is possible to conduct GWR analysis on <em>points</em> or <em>polygons</em>, and while we demonstrated linear regression, we could also use <em>Poisson</em> or <em>Binomial</em> regression.</p>
<p>As an example, if you had individual level outcome data and associated exposures (individual or contextual) linked to street-level geocodes (e.g. points) you could carry out spatial logistic regression, estimating the spatially-varying association between predictors and outcome.</p>
<p>Alternatively if you had aggregated count data as might be common with the surveillance-type data we relied on in Disease Mapping, you could use Poisson to estimate rates rather than rely on linear regression.</p>
</div>
<div id="data-models" class="section level3" number="11.3.9">
<h3><span class="header-section-number">11.3.9</span> Data models</h3>
<p>One final option that could be useful is using gridded points to pre-specify the evaluation location for each kernel density estimation. Recall that by default, all of the preceding procedures place the kernel estimator over every single feature (each census tract polygon centroid in our case). However it could be more efficient to describe a regular grid of points that covers the whole region, and possibly provide more efficiency, if for example the number of grid points was smaller than the number of features. Note that the pre-specified evaluation points don’t change the data; instead they change <strong>where</strong> the kernel window is centered for estimation.</p>

<div class="rmdnote">
This strategy described below could be generalized to any time you wanted to return a <em>raster surface</em> from kernel density smoothing (e.g. using <code>gwss()</code> or <code>gwr.xx()</code> models) of points or polygons. In otherwords using gridded evaluation points converts the answer from polygon/point to raster surface.
</div>
<p>Here is an approach that follows these steps:</p>
<ol style="list-style-type: decimal">
<li>Extract the <em>bounding box</em> or <em>spatial extent</em> of the original data. This is the min and max <span class="math inline">\(x,y\)</span> coordinate locations of the <code>obesity</code> spatial object.</li>
<li>Define a spatial resolution of the grid points. Below I have specified <span class="math inline">\(1000\)</span> meters or 1 km.</li>
<li>Define the dimensions of the grid that would cover the spatial extent of the data using the specified resolution.</li>
<li>Finally, create a <code>SpatialGrid</code> object in <code>sp</code> with the target dimensions.</li>
</ol>
<div class="sourceCode" id="cb315"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb315-1"><a href="spatial-regression-ii.html#cb315-1"></a>bb &lt;-<span class="st"> </span><span class="kw">bbox</span>(atl.sp)</span>
<span id="cb315-2"><a href="spatial-regression-ii.html#cb315-2"></a>res &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb315-3"><a href="spatial-regression-ii.html#cb315-3"></a>c.dim &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">ceiling</span>((bb[<span class="dv">1</span>,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>bb[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="op">/</span><span class="st"> </span>res),</span>
<span id="cb315-4"><a href="spatial-regression-ii.html#cb315-4"></a>           <span class="kw">ceiling</span>((bb[<span class="dv">2</span>,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>bb[<span class="dv">2</span>,<span class="dv">1</span>]) <span class="op">/</span><span class="st"> </span>res))</span>
<span id="cb315-5"><a href="spatial-regression-ii.html#cb315-5"></a></span>
<span id="cb315-6"><a href="spatial-regression-ii.html#cb315-6"></a>grd &lt;-<span class="st"> </span><span class="kw">SpatialGrid</span>(<span class="kw">GridTopology</span>(<span class="dt">cellcentre.offset =</span> bb[,<span class="dv">1</span>], </span>
<span id="cb315-7"><a href="spatial-regression-ii.html#cb315-7"></a>                                <span class="dt">cellsize =</span> <span class="kw">c</span>(res,res), </span>
<span id="cb315-8"><a href="spatial-regression-ii.html#cb315-8"></a>                                <span class="dt">cells.dim =</span> c.dim))</span></code></pre></div>
<p>When we plot the grid over the original data you can visualize how the evaluation points (the grid points) represent the region. Each grid is a single location where the GWR model will be centered. In this case we clearly have more evaluation points than the number of census tracts. In that way this strategy <em>is not actually</em> saving computational time, but instead is simply a step towards producing a raster surface of GWR results.</p>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="spatial-regression-ii.html#cb316-1"></a><span class="kw">plot</span>(grd, <span class="dt">col =</span> <span class="st">&#39;red&#39;</span>)</span>
<span id="cb316-2"><a href="spatial-regression-ii.html#cb316-2"></a><span class="kw">plot</span>(atl.sp, <span class="dt">add =</span> T, <span class="dt">col =</span> <span class="kw">adjustcolor</span>(<span class="st">&#39;navyblue&#39;</span>,<span class="dt">alpha.f=</span><span class="fl">0.3</span>))</span></code></pre></div>
<p><img src="EPI563-SpatialEPI_files/figure-html/unnamed-chunk-309-1.png" width="672" /></p>
<p>Next, we recalculate the distance matrix. Recall that originally it was describing the distance between each pair of county centroids (to inform the weights derived from kernel density functions). Now, we combine information about <em>where each census tract is</em> (for weighting, described as <em>data</em> point, or <code>dp.locat</code>), with <em>where each evaluation point is</em> (for locating the kernel itself, described as <em>regression</em> points, or <code>rp.locat</code>).</p>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="spatial-regression-ii.html#cb317-1"></a>atl.DM2 &lt;-<span class="st"> </span><span class="kw">gw.dist</span>(<span class="dt">dp.locat=</span><span class="kw">coordinates</span>(atl.sp),</span>
<span id="cb317-2"><a href="spatial-regression-ii.html#cb317-2"></a>              <span class="dt">rp.locat=</span><span class="kw">coordinates</span>(grd))</span></code></pre></div>
<p>Finally, we can refit the original model, now using the <code>SpatialGrid</code> as a definition of the model calibration points, rather than assuming the default which is that each region in the <code>SpatialPolygons</code> represents a calibration or model-fitting location.</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="spatial-regression-ii.html#cb318-1"></a><span class="co"># Refit model at specified gridded points</span></span>
<span id="cb318-2"><a href="spatial-regression-ii.html#cb318-2"></a>m2 &lt;-<span class="st"> </span><span class="kw">gwr.basic</span>(MENTALHLTH <span class="op">~</span><span class="st"> </span>SMOKING <span class="op">+</span><span class="st"> </span>PHYSHLTH, </span>
<span id="cb318-3"><a href="spatial-regression-ii.html#cb318-3"></a>                <span class="dt">data =</span> atl.sp,</span>
<span id="cb318-4"><a href="spatial-regression-ii.html#cb318-4"></a>                <span class="dt">dMat =</span> atl.DM2, </span>
<span id="cb318-5"><a href="spatial-regression-ii.html#cb318-5"></a>                <span class="dt">regression.points =</span> grd,</span>
<span id="cb318-6"><a href="spatial-regression-ii.html#cb318-6"></a>                <span class="dt">bw =</span> h.adapt,</span>
<span id="cb318-7"><a href="spatial-regression-ii.html#cb318-7"></a>                <span class="dt">adaptive =</span> T)</span></code></pre></div>
<p>To make visualizing easier we can convert the output of this model (which is a <code>SpatialPixelDataFrame</code>) to a raster object. Typically a <code>raster</code> object in <code>R</code> only has a single attribute (e.g. one statistic or variable with pixel values representing the local value of that statistic). However, in this case we want to convert the pixel values for both of the coefficients plus the intercept. To do that we create what is called a <em>raster brick</em>, which is just a stack of rasters. Because the grid has coverage well outside the bounds of the study region, we can also <em>mask</em> (e.g. trim or crop) the raster to only show results for areas we have data.</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="spatial-regression-ii.html#cb319-1"></a><span class="co"># Create brick and crop it to the county data</span></span>
<span id="cb319-2"><a href="spatial-regression-ii.html#cb319-2"></a>m2.raster &lt;-<span class="st"> </span><span class="kw">brick</span>(m2<span class="op">$</span>SDF) <span class="op">%&gt;%</span></span>
<span id="cb319-3"><a href="spatial-regression-ii.html#cb319-3"></a><span class="st">  </span><span class="kw">mask</span>(atl)</span></code></pre></div>
<p>To visualize the results:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="spatial-regression-ii.html#cb320-1"></a>raster.int &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(m2.raster<span class="op">$</span>Intercept) <span class="op">+</span></span>
<span id="cb320-2"><a href="spatial-regression-ii.html#cb320-2"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="st">&#39;Intercept&#39;</span>,</span>
<span id="cb320-3"><a href="spatial-regression-ii.html#cb320-3"></a>            <span class="dt">style =</span> <span class="st">&#39;cont&#39;</span>,</span>
<span id="cb320-4"><a href="spatial-regression-ii.html#cb320-4"></a>            <span class="dt">palette =</span> <span class="st">&#39;OrRd&#39;</span>)</span>
<span id="cb320-5"><a href="spatial-regression-ii.html#cb320-5"></a></span>
<span id="cb320-6"><a href="spatial-regression-ii.html#cb320-6"></a>raster.smoke &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(m2.raster<span class="op">$</span>SMOKING) <span class="op">+</span></span>
<span id="cb320-7"><a href="spatial-regression-ii.html#cb320-7"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="st">&#39;SMOKING&#39;</span>,</span>
<span id="cb320-8"><a href="spatial-regression-ii.html#cb320-8"></a>            <span class="dt">style =</span> <span class="st">&#39;cont&#39;</span>,</span>
<span id="cb320-9"><a href="spatial-regression-ii.html#cb320-9"></a>            <span class="dt">palette =</span> <span class="st">&#39;BuPu&#39;</span>)</span>
<span id="cb320-10"><a href="spatial-regression-ii.html#cb320-10"></a></span>
<span id="cb320-11"><a href="spatial-regression-ii.html#cb320-11"></a>raster.phyhlth &lt;-<span class="st"> </span><span class="kw">tm_shape</span>(m2.raster<span class="op">$</span>PHYSHLTH) <span class="op">+</span></span>
<span id="cb320-12"><a href="spatial-regression-ii.html#cb320-12"></a><span class="st">  </span><span class="kw">tm_raster</span>(<span class="st">&#39;PHYSHLTH&#39;</span>,</span>
<span id="cb320-13"><a href="spatial-regression-ii.html#cb320-13"></a>            <span class="dt">style =</span> <span class="st">&#39;cont&#39;</span>,</span>
<span id="cb320-14"><a href="spatial-regression-ii.html#cb320-14"></a>            <span class="dt">palette =</span> <span class="st">&#39;YlGnBu&#39;</span>)</span>
<span id="cb320-15"><a href="spatial-regression-ii.html#cb320-15"></a></span>
<span id="cb320-16"><a href="spatial-regression-ii.html#cb320-16"></a><span class="kw">tmap_arrange</span>(raster.int, raster.smoke, raster.phyhlth)</span></code></pre></div>
<p><img src="EPI563-SpatialEPI_files/figure-html/unnamed-chunk-313-1.png" width="672" /></p>
<p>What this demonstrates is that a pre-defined spatial grid can recover the same patterns, and in instances where the number of observations is extremely large, the spatial grid could be a more efficient approach. Unfortunately (for reasons I do not understand), standard errors and t-values do not seem to be returned for this spatial grid, so significance testing is not available (as far as I can tell at the time of this writing).</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatreg1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-regression-iii.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mkram01/EPI563-SpatialEPI/edit/master/11-spatial-regression-2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EPI563-SpatialEPI.pdf"],
"toc": {
"collapse": "section",
"toc_depth": 2,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>

<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 8 Spatial Structure and Clustering I | EPI 563: Spatial Epidemiology, Fall 2020</title>
  <meta name="description" content="Week 8 Spatial Structure and Clustering I | EPI 563: Spatial Epidemiology, Fall 2020" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 8 Spatial Structure and Clustering I | EPI 563: Spatial Epidemiology, Fall 2020" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="mkram01/EPI563-SpatialEPI" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 8 Spatial Structure and Clustering I | EPI 563: Spatial Epidemiology, Fall 2020" />
  
  
  

<meta name="author" content="Michael Kramer" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="disease-mapping-iv.html"/>
<link rel="next" href="spatial-structure-and-clustering-ii.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">EPI 563: Spatial Epidemiology, Fall 2020</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>How to use this eBook</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#strategy-for-using-this-ebook"><i class="fa fa-check"></i>Strategy for using this eBook</a></li>
</ul></li>
<li class="part"><span><b>I Getting ready…</b></span></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html"><i class="fa fa-check"></i>Software installation</a>
<ul>
<li><a href="software-installation.html#installing-r-on-your-computer">Installing <code>R</code> on your computer</a></li>
<li class="chapter" data-level="" data-path="software-installation.html"><a href="software-installation.html#installing-rstudio-on-your-computer"><i class="fa fa-check"></i>Installing RStudio on your computer</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html"><i class="fa fa-check"></i>Installing packages for this course</a>
<ul>
<li><a href="installing-packages-for-this-course.html#installing-rtools40">Installing <code>Rtools40</code></a></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html#installing-packages-used-for-general-data-science"><i class="fa fa-check"></i>Installing packages used for general data science</a></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html#installing-packages-use-for-geographic-data"><i class="fa fa-check"></i>Installing packages use for geographic data</a></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html#installing-packages-used-for-spatial-data-manipulation-visualization"><i class="fa fa-check"></i>Installing packages used for spatial data manipulation &amp; visualization</a></li>
<li class="chapter" data-level="" data-path="installing-packages-for-this-course.html"><a href="installing-packages-for-this-course.html#installing-packages-used-for-spatial-analysis"><i class="fa fa-check"></i>Installing packages used for spatial analysis</a></li>
</ul></li>
<li class="part"><span><b>II Weekly Modules</b></span></li>
<li class="chapter" data-level="1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html"><i class="fa fa-check"></i><b>1</b> Locating Spatial Epidemiology</a>
<ul>
<li class="chapter" data-level="1.1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#getting-ready"><i class="fa fa-check"></i><b>1.1</b> Getting Ready</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#learning-objectives"><i class="fa fa-check"></i><b>1.1.1</b> Learning objectives</a></li>
<li class="chapter" data-level="1.1.2" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#additional-resources"><i class="fa fa-check"></i><b>1.1.2</b> Additional Resources</a></li>
<li class="chapter" data-level="1.1.3" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#important-vocabulary"><i class="fa fa-check"></i><b>1.1.3</b> Important Vocabulary</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#spatial-thinking-in-epidemiology"><i class="fa fa-check"></i><b>1.2</b> Spatial Thinking in Epidemiology</a></li>
<li class="chapter" data-level="1.3" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#spatial-analysis-in-epidemiology"><i class="fa fa-check"></i><b>1.3</b> Spatial Analysis in Epidemiology</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#spatial-data-storage-foramts"><i class="fa fa-check"></i><b>1.3.1</b> Spatial data storage foramts</a></li>
<li class="chapter" data-level="1.3.2" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#representing-spatial-data-in-r"><i class="fa fa-check"></i><b>1.3.2</b> Representing spatial data in <code>R</code></a></li>
<li class="chapter" data-level="1.3.3" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#benefits-of-sf-data-classes"><i class="fa fa-check"></i><b>1.3.3</b> Benefits of <code>sf</code> data classes</a></li>
<li class="chapter" data-level="1.3.4" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#working-with-spatial-data-in-r"><i class="fa fa-check"></i><b>1.3.4</b> Working with spatial data in <code>R</code></a></li>
<li class="chapter" data-level="1.3.5" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#basic-visual-inspectionplots"><i class="fa fa-check"></i><b>1.3.5</b> Basic visual inspection/plots</a></li>
<li class="chapter" data-level="1.3.6" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#working-with-crs-and-projection"><i class="fa fa-check"></i><b>1.3.6</b> Working with CRS and projection</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html"><i class="fa fa-check"></i><b>2</b> Cartography for Epidemiology I</a>
<ul>
<li class="chapter" data-level="2.1" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#getting-ready"><i class="fa fa-check"></i><b>2.1</b> Getting Ready</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#learning-objectives-w2"><i class="fa fa-check"></i><b>2.1.1</b> Learning objectives, w2</a></li>
<li class="chapter" data-level="2.1.2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#additional-resources-w2"><i class="fa fa-check"></i><b>2.1.2</b> Additional Resources, w2</a></li>
<li class="chapter" data-level="2.1.3" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#important-vocabulary-w2"><i class="fa fa-check"></i><b>2.1.3</b> Important Vocabulary, w2</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#spatial-thinking-in-epidemiology-w2"><i class="fa fa-check"></i><b>2.2</b> Spatial Thinking in Epidemiology, w2</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#color-choices"><i class="fa fa-check"></i><b>2.2.1</b> Color choices</a></li>
<li class="chapter" data-level="2.2.2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#choropleth-binning-styles"><i class="fa fa-check"></i><b>2.2.2</b> Choropleth binning styles</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#spatial-analysis-in-epidemiology-w2"><i class="fa fa-check"></i><b>2.3</b> Spatial Analysis in Epidemiology, w2</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#obtaining-and-preparing-numerator-data"><i class="fa fa-check"></i><b>2.3.1</b> Obtaining and preparing numerator data</a></li>
<li class="chapter" data-level="2.3.2" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#obtaining-and-preparing-denominator-or-contextual-data"><i class="fa fa-check"></i><b>2.3.2</b> Obtaining and preparing denominator or contextual data</a></li>
<li class="chapter" data-level="2.3.3" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#obtaining-and-preparing-geographic-data"><i class="fa fa-check"></i><b>2.3.3</b> Obtaining and preparing geographic data</a></li>
<li class="chapter" data-level="2.3.4" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#merging-attributes-and-geography"><i class="fa fa-check"></i><b>2.3.4</b> Merging Attributes and Geography</a></li>
<li class="chapter" data-level="2.3.5" data-path="cartography-for-epidemiology-i.html"><a href="cartography-for-epidemiology-i.html#mapping-mortality-uninsured"><i class="fa fa-check"></i><b>2.3.5</b> Mapping Mortality &amp; Uninsured</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html"><i class="fa fa-check"></i><b>3</b> Cartography for Epidemiology II</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#learning-objectives-w3"><i class="fa fa-check"></i><b>3.1</b> Learning objectives, w3</a></li>
<li class="chapter" data-level="3.2" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#additional-resources-w3"><i class="fa fa-check"></i><b>3.2</b> Additional resources, w3</a></li>
<li class="chapter" data-level="3.3" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#important-vocabulary-w3"><i class="fa fa-check"></i><b>3.3</b> Important Vocabulary, w3</a></li>
<li class="chapter" data-level="3.4" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#spatial-thinking-in-epidemiology-w3"><i class="fa fa-check"></i><b>3.4</b> Spatial Thinking in Epidemiology, w3</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#risks-of-privacy-breaches-in-collection-of-geospatial-information"><i class="fa fa-check"></i><b>3.4.1</b> Risks of privacy breaches in collection of geospatial information</a></li>
<li class="chapter" data-level="3.4.2" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#risk-of-confidentiality-breaches-through-unintentional-de-identification"><i class="fa fa-check"></i><b>3.4.2</b> Risk of confidentiality breaches through unintentional de-identification</a></li>
<li class="chapter" data-level="3.4.3" data-path="cartography-for-epidemiology-ii.html"><a href="cartography-for-epidemiology-ii.html#risk-of-stigmatization-of-place"><i class="fa fa-check"></i><b>3.4.3</b> Risk of stigmatization of place</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html"><i class="fa fa-check"></i><b>4</b> Disease Mapping I</a>
<ul>
<li class="chapter" data-level="4.1" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#getting-ready-w4"><i class="fa fa-check"></i><b>4.1</b> Getting ready, w4</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#learning-objectives-w4"><i class="fa fa-check"></i><b>4.1.1</b> Learning objectives, w4</a></li>
<li class="chapter" data-level="4.1.2" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#additional-resources-w4"><i class="fa fa-check"></i><b>4.1.2</b> Additional Resources, w4</a></li>
<li class="chapter" data-level="4.1.3" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#important-vocabulary-w4"><i class="fa fa-check"></i><b>4.1.3</b> Important Vocabulary, w4</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#spatial-thinking-in-epidemiology-w4"><i class="fa fa-check"></i><b>4.2</b> Spatial Thinking in Epidemiology, w4</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#why-do-we-need-disease-mapping"><i class="fa fa-check"></i><b>4.2.1</b> Why do we need disease mapping?</a></li>
<li class="chapter" data-level="4.2.2" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#using-statistics-and-probability-models-to-improve-disease-mapping"><i class="fa fa-check"></i><b>4.2.2</b> Using statistics and probability models to improve disease mapping</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#spatial-analysis-in-epidemiology-w4"><i class="fa fa-check"></i><b>4.3</b> Spatial Analysis in Epidemiology, w4</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#disease-mapping-is-there-spatial-heterogeneity"><i class="fa fa-check"></i><b>4.3.1</b> Disease mapping: Is there spatial heterogeneity?</a></li>
<li class="chapter" data-level="4.3.2" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#disease-mapping-how-precise-are-county-estimates"><i class="fa fa-check"></i><b>4.3.2</b> Disease mapping: How precise are county estimates?</a></li>
<li class="chapter" data-level="4.3.3" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#disease-mapping-adjusting-for-covariates"><i class="fa fa-check"></i><b>4.3.3</b> Disease mapping: Adjusting for covariates</a></li>
<li class="chapter" data-level="4.3.4" data-path="disease-mapping-i.html"><a href="disease-mapping-i.html#disease-mapping-rate-stabilization-with-global-empirical-bayes"><i class="fa fa-check"></i><b>4.3.4</b> Disease mapping: Rate stabilization with global Empirical Bayes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html"><i class="fa fa-check"></i><b>5</b> Disease Mapping II</a>
<ul>
<li class="chapter" data-level="5.1" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#getting-ready-w5"><i class="fa fa-check"></i><b>5.1</b> Getting Ready, w5</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#w5-learning-objectives"><i class="fa fa-check"></i><b>5.1.1</b> w5 Learning objectives</a></li>
<li class="chapter" data-level="5.1.2" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#additional-resources-w5"><i class="fa fa-check"></i><b>5.1.2</b> Additional Resources, w5</a></li>
<li class="chapter" data-level="5.1.3" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#important-vocabulary-w5"><i class="fa fa-check"></i><b>5.1.3</b> Important Vocabulary, w5</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#spatial-thinking-in-epidemiology-w5"><i class="fa fa-check"></i><b>5.2</b> Spatial Thinking in Epidemiology, w5</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#an-argument-for-the-relevance-of-space"><i class="fa fa-check"></i><b>5.2.1</b> An argument for the relevance of space</a></li>
<li class="chapter" data-level="5.2.2" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#on-making-meaning-from-neighbors"><i class="fa fa-check"></i><b>5.2.2</b> On making meaning from neighbors</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#spatial-analysis-in-epidemiology-w5"><i class="fa fa-check"></i><b>5.3</b> Spatial Analysis in Epidemiology, w5</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#creating-contiguity-neighbor-objects"><i class="fa fa-check"></i><b>5.3.1</b> Creating contiguity neighbor objects</a></li>
<li class="chapter" data-level="5.3.2" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#creating-k-nearest-neighbors"><i class="fa fa-check"></i><b>5.3.2</b> Creating k-nearest neighbors</a></li>
<li class="chapter" data-level="5.3.3" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#creating-graph-based-triangle-neighbor-objects"><i class="fa fa-check"></i><b>5.3.3</b> Creating Graph-based triangle neighbor objects</a></li>
<li class="chapter" data-level="5.3.4" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#creating-fixed-distance-neighbors"><i class="fa fa-check"></i><b>5.3.4</b> Creating fixed-distance neighbors</a></li>
<li class="chapter" data-level="5.3.5" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#from-spatial-neighbors-to-spatial-disease-mapping"><i class="fa fa-check"></i><b>5.3.5</b> From spatial neighbors to spatial Disease Mapping</a></li>
<li class="chapter" data-level="5.3.6" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#spatial-empirical-bayes"><i class="fa fa-check"></i><b>5.3.6</b> Spatial Empirical Bayes</a></li>
<li class="chapter" data-level="5.3.7" data-path="disease-mapping-ii.html"><a href="disease-mapping-ii.html#final-thoughts-making-choices"><i class="fa fa-check"></i><b>5.3.7</b> Final thoughts: Making choices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html"><i class="fa fa-check"></i><b>6</b> Disease Mapping III</a>
<ul>
<li class="chapter" data-level="6.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#getting-ready-w6"><i class="fa fa-check"></i><b>6.1</b> Getting Ready, w6</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#learning-objectives-w6"><i class="fa fa-check"></i><b>6.1.1</b> Learning objectives, w6</a></li>
<li class="chapter" data-level="6.1.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#additional-resources-w6"><i class="fa fa-check"></i><b>6.1.2</b> Additional Resources, w6</a></li>
<li class="chapter" data-level="6.1.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#important-vocabulary-w6"><i class="fa fa-check"></i><b>6.1.3</b> Important Vocabulary, w6</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#spatial-thinking-in-epidemiology-w6"><i class="fa fa-check"></i><b>6.2</b> Spatial Thinking in Epidemiology, w6</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#revisiting-spatial-point-processes"><i class="fa fa-check"></i><b>6.2.1</b> Revisiting spatial point processes</a></li>
<li class="chapter" data-level="6.2.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#what-is-a-kernel-density-estimator"><i class="fa fa-check"></i><b>6.2.2</b> What is a kernel density estimator?</a></li>
<li class="chapter" data-level="6.2.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#limitations-in-kernel-density-estimation"><i class="fa fa-check"></i><b>6.2.3</b> Limitations in kernel density estimation</a></li>
<li class="chapter" data-level="6.2.4" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#uses-for-kernel-density-estimation-kde-in-spatial-epidemiology"><i class="fa fa-check"></i><b>6.2.4</b> Uses for kernel density estimation (KDE) in spatial epidemiology</a></li>
<li class="chapter" data-level="6.2.5" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#guide-to-the-rest-of-this-section"><i class="fa fa-check"></i><b>6.2.5</b> Guide to the rest of this section…</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#spatial-analysis-in-epidemiology-kernel-estimation-of-point-processes"><i class="fa fa-check"></i><b>6.3</b> Spatial Analysis in Epidemiology: Kernel estimation of point processes</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#preparing-packages-and-data"><i class="fa fa-check"></i><b>6.3.1</b> Preparing packages and data</a></li>
<li class="chapter" data-level="6.3.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#introducing-a-new-spatial-data-class-ppp"><i class="fa fa-check"></i><b>6.3.2</b> Introducing a new spatial data class: <code>ppp</code></a></li>
<li class="chapter" data-level="6.3.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#creating-the-ppp-objects"><i class="fa fa-check"></i><b>6.3.3</b> Creating the <code>ppp</code> objects</a></li>
<li class="chapter" data-level="6.3.4" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#bandwidth-selection"><i class="fa fa-check"></i><b>6.3.4</b> Bandwidth selection</a></li>
<li class="chapter" data-level="6.3.5" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#estimating-kernel-density-surfaces"><i class="fa fa-check"></i><b>6.3.5</b> Estimating Kernel Density surfaces</a></li>
<li class="chapter" data-level="6.3.6" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#creating-relative-risk-surface-manually"><i class="fa fa-check"></i><b>6.3.6</b> Creating relative risk surface manually</a></li>
<li class="chapter" data-level="6.3.7" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#creating-relative-risk-surface-with-risk-function"><i class="fa fa-check"></i><b>6.3.7</b> Creating relative risk surface with <code>risk()</code> function</a></li>
<li class="chapter" data-level="6.3.8" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#using-functions-to-map-rr-with-tmap"><i class="fa fa-check"></i><b>6.3.8</b> Using functions to map RR with <code>tmap</code></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#gwss"><i class="fa fa-check"></i><b>6.4</b> Spatial Analysis in Epidemiology: Kernel estimation of areal data</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#packages-and-data"><i class="fa fa-check"></i><b>6.4.1</b> Packages and data</a></li>
<li class="chapter" data-level="6.4.2" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#what-bandwidth-for-kernel-density-estimates"><i class="fa fa-check"></i><b>6.4.2</b> What bandwidth for kernel density estimates?</a></li>
<li class="chapter" data-level="6.4.3" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#geographically-weighted-summary-statistics-gwss"><i class="fa fa-check"></i><b>6.4.3</b> Geographically weighted summary statistics: <code>gwss()</code></a></li>
<li class="chapter" data-level="6.4.4" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#calculating-pseudo-p-values-for-smoothed-estimates"><i class="fa fa-check"></i><b>6.4.4</b> Calculating pseudo p-values for smoothed estimates</a></li>
<li class="chapter" data-level="6.4.5" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#estimating-geographically-weighted-bivariate-statistics"><i class="fa fa-check"></i><b>6.4.5</b> Estimating geographically-weighted bivariate statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html"><i class="fa fa-check"></i><b>7</b> Disease Mapping IV</a>
<ul>
<li class="chapter" data-level="7.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#getting-ready-w7"><i class="fa fa-check"></i><b>7.1</b> Getting Ready, w7</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#learning-objectives-w7"><i class="fa fa-check"></i><b>7.1.1</b> Learning objectives, w7</a></li>
<li class="chapter" data-level="7.1.2" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#additional-resources-w7"><i class="fa fa-check"></i><b>7.1.2</b> Additional Resources, w7</a></li>
<li class="chapter" data-level="7.1.3" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#important-vocabulary-w7"><i class="fa fa-check"></i><b>7.1.3</b> Important Vocabulary, w7</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#spatial-thinking-in-epidemiology-w7"><i class="fa fa-check"></i><b>7.2</b> Spatial Thinking in Epidemiology, w7</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#what-is-bayesian-inference"><i class="fa fa-check"></i><b>7.2.1</b> What is <em>Bayesian Inference</em>?</a></li>
<li class="chapter" data-level="7.2.2" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#bayesian-inference-in-spatial-epidemiology"><i class="fa fa-check"></i><b>7.2.2</b> Bayesian inference in spatial epidemiology</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#spatial-analysis-in-epidemiology-w7"><i class="fa fa-check"></i><b>7.3</b> Spatial Analysis in Epidemiology, w7</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#packages-data"><i class="fa fa-check"></i><b>7.3.1</b> Packages &amp; Data</a></li>
<li class="chapter" data-level="7.3.2" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#preparing-for-carbayes"><i class="fa fa-check"></i><b>7.3.2</b> Preparing for <code>CARBayes()</code></a></li>
<li class="chapter" data-level="7.3.3" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#fitting-a-besag-york-mollie-bym-bayesian-model"><i class="fa fa-check"></i><b>7.3.3</b> Fitting a <em>Besag-York-Mollie (BYM)</em> Bayesian model</a></li>
<li class="chapter" data-level="7.3.4" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#summarizing-carbayes-model-output"><i class="fa fa-check"></i><b>7.3.4</b> Summarizing <code>CARBayes</code> model output</a></li>
<li class="chapter" data-level="7.3.5" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#making-inference-from-bayesian-posteriors"><i class="fa fa-check"></i><b>7.3.5</b> Making inference from Bayesian posteriors</a></li>
<li class="chapter" data-level="7.3.6" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#extracting-summaries-for-mapping-or-analysis"><i class="fa fa-check"></i><b>7.3.6</b> Extracting summaries for mapping or analysis</a></li>
<li class="chapter" data-level="7.3.7" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#plot-raw-versus-smoothed"><i class="fa fa-check"></i><b>7.3.7</b> Plot raw versus smoothed</a></li>
<li class="chapter" data-level="7.3.8" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#mapping-rates"><i class="fa fa-check"></i><b>7.3.8</b> Mapping rates</a></li>
<li class="chapter" data-level="7.3.9" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#mapping-exceedance-probability"><i class="fa fa-check"></i><b>7.3.9</b> Mapping exceedance probability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html"><i class="fa fa-check"></i><b>8</b> Spatial Structure and Clustering I</a>
<ul>
<li class="chapter" data-level="8.1" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#getting-ready-w8"><i class="fa fa-check"></i><b>8.1</b> Getting Ready, w8</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#learning-objectives-w8"><i class="fa fa-check"></i><b>8.1.1</b> Learning objectives, w8</a></li>
<li class="chapter" data-level="8.1.2" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#additional-resources-w8"><i class="fa fa-check"></i><b>8.1.2</b> Additional Resources, w8</a></li>
<li class="chapter" data-level="8.1.3" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#important-vocabulary-w8"><i class="fa fa-check"></i><b>8.1.3</b> Important Vocabulary, w8</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#spatial-thinking-in-epidemiology-w8"><i class="fa fa-check"></i><b>8.2</b> Spatial Thinking in Epidemiology, w8</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#two-big-questions"><i class="fa fa-check"></i><b>8.2.1</b> Two big questions…</a></li>
<li class="chapter" data-level="8.2.2" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#why-does-structure-or-clustering-matter"><i class="fa fa-check"></i><b>8.2.2</b> Why does structure or clustering matter?</a></li>
<li class="chapter" data-level="8.2.3" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#making-meaning-of-hypotheses-in-spatial-structure-testing"><i class="fa fa-check"></i><b>8.2.3</b> Making meaning of hypotheses in spatial structure testing</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#spatial-analysis-in-epidemiology-w8"><i class="fa fa-check"></i><b>8.3</b> Spatial Analysis in Epidemiology, w8</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#packages-data"><i class="fa fa-check"></i><b>8.3.1</b> Packages &amp; Data</a></li>
<li class="chapter" data-level="8.3.2" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#global-morans-i"><i class="fa fa-check"></i><b>8.3.2</b> Global Moran’s I</a></li>
<li class="chapter" data-level="8.3.3" data-path="spatial-structure-and-clustering-i.html"><a href="spatial-structure-and-clustering-i.html#local-morans-i"><i class="fa fa-check"></i><b>8.3.3</b> Local Moran’s I</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html"><i class="fa fa-check"></i><b>9</b> Spatial Structure and Clustering II</a>
<ul>
<li class="chapter" data-level="9.1" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#getting-ready-w9"><i class="fa fa-check"></i><b>9.1</b> Getting Ready, w9</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#learning-objectives-w9"><i class="fa fa-check"></i><b>9.1.1</b> Learning objectives, w9</a></li>
<li class="chapter" data-level="9.1.2" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#additional-resources-w9"><i class="fa fa-check"></i><b>9.1.2</b> Additional Resources, w9</a></li>
<li class="chapter" data-level="9.1.3" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#important-vocabulary-w9"><i class="fa fa-check"></i><b>9.1.3</b> Important Vocabulary, w9</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#spatial-thinking-in-epidemiology-conceptual-tools-for-thinking-about-clusters"><i class="fa fa-check"></i><b>9.2</b> Spatial Thinking in Epidemiology: Conceptual tools for thinking about ‘clusters’</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#the-clustering-conundrum"><i class="fa fa-check"></i><b>9.2.1</b> The clustering conundrum</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#spatial-scan-statistics"><i class="fa fa-check"></i><b>9.3</b> Spatial Scan Statistics</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="disease-mapping-iv.html"><a href="disease-mapping-iv.html#packages-data"><i class="fa fa-check"></i><b>9.3.1</b> Packages &amp; Data</a></li>
<li class="chapter" data-level="9.3.2" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#overview-of-kulldorff-nagarwalla-scan-statistic"><i class="fa fa-check"></i><b>9.3.2</b> Overview of <em>Kulldorff &amp; Nagarwalla</em> scan statistic</a></li>
<li class="chapter" data-level="9.3.3" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#spatio-temporal-scan-statistics"><i class="fa fa-check"></i><b>9.3.3</b> Spatio-temporal scan statistics</a></li>
<li class="chapter" data-level="9.3.4" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#estimating-spatial-only-kulldorff-scan-statistics"><i class="fa fa-check"></i><b>9.3.4</b> Estimating <em>spatial-only</em> Kulldorff scan statistics</a></li>
<li class="chapter" data-level="9.3.5" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#estimating-spatio-temporal-kuldorff-scan-statistic"><i class="fa fa-check"></i><b>9.3.5</b> Estimating <em>spatio-temporal</em> Kuldorff scan statistic</a></li>
<li class="chapter" data-level="9.3.6" data-path="spatial-structure-and-clustering-ii.html"><a href="spatial-structure-and-clustering-ii.html#concluding-thoughts"><i class="fa fa-check"></i><b>9.3.6</b> Concluding thoughts</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="spatreg1.html"><a href="spatreg1.html"><i class="fa fa-check"></i><b>10</b> Spatial Regression I</a>
<ul>
<li class="chapter" data-level="10.1" data-path="spatreg1.html"><a href="spatreg1.html#getting-ready-w10"><i class="fa fa-check"></i><b>10.1</b> Getting Ready, w10</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="spatreg1.html"><a href="spatreg1.html#learning-objectives-w10"><i class="fa fa-check"></i><b>10.1.1</b> Learning objectives, w10</a></li>
<li class="chapter" data-level="10.1.2" data-path="spatreg1.html"><a href="spatreg1.html#important-vocabulary-w10"><i class="fa fa-check"></i><b>10.1.2</b> Important Vocabulary, w10</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="spatreg1.html"><a href="spatreg1.html#multivariable-regression-for-exploring-spatial-data"><i class="fa fa-check"></i><b>10.2</b> Multivariable regression for exploring spatial data</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="spatreg1.html"><a href="spatreg1.html#data-generating-process"><i class="fa fa-check"></i><b>10.2.1</b> Data Generating Process</a></li>
<li class="chapter" data-level="10.2.2" data-path="spatreg1.html"><a href="spatreg1.html#model-residuals-are-not-just-mistakes"><i class="fa fa-check"></i><b>10.2.2</b> Model residuals are not just mistakes</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="spatreg1.html"><a href="spatreg1.html#spatializing-aspatial-regression"><i class="fa fa-check"></i><b>10.3</b> Spatializing aspatial regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="spatreg1.html"><a href="spatreg1.html#data-packages"><i class="fa fa-check"></i><b>10.3.1</b> Data &amp; Packages</a></li>
<li class="chapter" data-level="10.3.2" data-path="spatreg1.html"><a href="spatreg1.html#fitting-unconditional-empty-model"><i class="fa fa-check"></i><b>10.3.2</b> Fitting unconditional (empty) model</a></li>
<li class="chapter" data-level="10.3.3" data-path="spatreg1.html"><a href="spatreg1.html#fitting-conditional-model"><i class="fa fa-check"></i><b>10.3.3</b> Fitting conditional model</a></li>
<li class="chapter" data-level="10.3.4" data-path="spatreg1.html"><a href="spatreg1.html#mapping-residuals"><i class="fa fa-check"></i><b>10.3.4</b> Mapping residuals</a></li>
<li class="chapter" data-level="10.3.5" data-path="spatreg1.html"><a href="spatreg1.html#morans-i-tests-on-lm-models"><i class="fa fa-check"></i><b>10.3.5</b> Moran’s I tests on <code>lm</code> models</a></li>
<li class="chapter" data-level="10.3.6" data-path="spatreg1.html"><a href="spatreg1.html#morans-i-tests-on-glm-models"><i class="fa fa-check"></i><b>10.3.6</b> Moran’s I tests on <code>glm</code> models</a></li>
<li class="chapter" data-level="10.3.7" data-path="spatreg1.html"><a href="spatreg1.html#mapping-glm-residuals"><i class="fa fa-check"></i><b>10.3.7</b> Mapping <code>glm</code> residuals</a></li>
<li class="chapter" data-level="10.3.8" data-path="spatreg1.html"><a href="spatreg1.html#morans-i-for-glm"><i class="fa fa-check"></i><b>10.3.8</b> Moran’s I for <code>glm</code></a></li>
<li class="chapter" data-level="10.3.9" data-path="spatreg1.html"><a href="spatreg1.html#final-words"><i class="fa fa-check"></i><b>10.3.9</b> Final words</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html"><i class="fa fa-check"></i><b>11</b> Spatial Regression II</a>
<ul>
<li class="chapter" data-level="11.1" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#getting-ready-w11"><i class="fa fa-check"></i><b>11.1</b> Getting Ready, w11</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#learning-objectives-w11"><i class="fa fa-check"></i><b>11.1.1</b> Learning objectives, w11</a></li>
<li class="chapter" data-level="11.1.2" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#important-vocabulary-w11"><i class="fa fa-check"></i><b>11.1.2</b> Important Vocabulary, w11</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#spatially-varying-relationships"><i class="fa fa-check"></i><b>11.2</b> Spatially varying relationships</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#non-stationarity-in-context-of-spatial-epidemiology"><i class="fa fa-check"></i><b>11.2.1</b> Non-stationarity in context of spatial epidemiology</a></li>
<li class="chapter" data-level="11.2.2" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#introducing-geographically-weighted-regression"><i class="fa fa-check"></i><b>11.2.2</b> Introducing geographically weighted regression</a></li>
<li class="chapter" data-level="11.2.3" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#making-epidemiologic-meaning-of-spatially-varying-coefficients"><i class="fa fa-check"></i><b>11.2.3</b> Making epidemiologic meaning of spatially varying coefficients</a></li>
<li class="chapter" data-level="11.2.4" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#distinguishing-variation-in-prevalence-from-variation-in-correlation"><i class="fa fa-check"></i><b>11.2.4</b> Distinguishing variation in <strong>prevalence</strong> from variation in <strong>correlation</strong></a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#estimating-geogrpahically-weighted-regression-models"><i class="fa fa-check"></i><b>11.3</b> Estimating geogrpahically weighted regression models</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="disease-mapping-iii.html"><a href="disease-mapping-iii.html#packages-and-data"><i class="fa fa-check"></i><b>11.3.1</b> Packages and Data</a></li>
<li class="chapter" data-level="11.3.2" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#preparing-for-using-gwmodel"><i class="fa fa-check"></i><b>11.3.2</b> Preparing for using <code>GWModel</code></a></li>
<li class="chapter" data-level="11.3.3" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#defining-local-optimizing-kernel-bandwidths"><i class="fa fa-check"></i><b>11.3.3</b> Defining local: optimizing kernel bandwidths</a></li>
<li class="chapter" data-level="11.3.4" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#geographically-weighted-regression"><i class="fa fa-check"></i><b>11.3.4</b> Geographically weighted regression</a></li>
<li class="chapter" data-level="11.3.5" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#checking-local-multi-collinearity"><i class="fa fa-check"></i><b>11.3.5</b> Checking local multi-collinearity</a></li>
<li class="chapter" data-level="11.3.6" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#adjusting-for-multiple-comparisons"><i class="fa fa-check"></i><b>11.3.6</b> Adjusting for multiple comparisons</a></li>
<li class="chapter" data-level="11.3.7" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#visualizing-model-inference"><i class="fa fa-check"></i><b>11.3.7</b> Visualizing model inference</a></li>
<li class="chapter" data-level="11.3.8" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#extensions"><i class="fa fa-check"></i><b>11.3.8</b> Extensions</a></li>
<li class="chapter" data-level="11.3.9" data-path="spatial-regression-ii.html"><a href="spatial-regression-ii.html#data-models"><i class="fa fa-check"></i><b>11.3.9</b> Data models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html"><i class="fa fa-check"></i><b>12</b> Spatial Regression III</a>
<ul>
<li class="chapter" data-level="12.1" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#getting-ready-w12"><i class="fa fa-check"></i><b>12.1</b> Getting Ready, w12</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#learning-objectives-w12"><i class="fa fa-check"></i><b>12.1.1</b> Learning objectives, w12</a></li>
<li class="chapter" data-level="12.1.2" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#additional-resources-w12"><i class="fa fa-check"></i><b>12.1.2</b> Additional Resources, w12</a></li>
<li class="chapter" data-level="12.1.3" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#important-vocabulary-w12"><i class="fa fa-check"></i><b>12.1.3</b> Important Vocabulary, w12</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#spatial-econometric-models-putting-dependence-right-in-the-model"><i class="fa fa-check"></i><b>12.2</b> Spatial econometric models: Putting dependence right in the model</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#comparing-spatial-econometric-models"><i class="fa fa-check"></i><b>12.2.1</b> Comparing spatial econometric models</a></li>
<li class="chapter" data-level="12.2.2" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#comparing-and-selecting-spatial-econometric-models"><i class="fa fa-check"></i><b>12.2.2</b> Comparing and selecting spatial econometric models</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#estimating-spatial-econometrics-models"><i class="fa fa-check"></i><b>12.3</b> Estimating spatial econometrics models</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#package-data"><i class="fa fa-check"></i><b>12.3.1</b> Package &amp; Data</a></li>
<li class="chapter" data-level="12.3.2" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#defining-the-study-question"><i class="fa fa-check"></i><b>12.3.2</b> Defining the study question</a></li>
<li class="chapter" data-level="12.3.3" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#defining-competing-definitions-of-local"><i class="fa fa-check"></i><b>12.3.3</b> Defining competing definitions of <em>local</em></a></li>
<li class="chapter" data-level="12.3.4" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#two-extremes"><i class="fa fa-check"></i><b>12.3.4</b> Two extremes</a></li>
<li class="chapter" data-level="12.3.5" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#fitting-multivariable-regression-models"><i class="fa fa-check"></i><b>12.3.5</b> Fitting multivariable regression models</a></li>
<li class="chapter" data-level="12.3.6" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#spatial-error-model-1"><i class="fa fa-check"></i><b>12.3.6</b> Spatial Error Model</a></li>
<li class="chapter" data-level="12.3.7" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#hausman-test-of-coefficients"><i class="fa fa-check"></i><b>12.3.7</b> Hausman test of coefficients</a></li>
<li class="chapter" data-level="12.3.8" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#spatial-lag-model"><i class="fa fa-check"></i><b>12.3.8</b> Spatial Lag Model</a></li>
<li class="chapter" data-level="12.3.9" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#spatial-durbin-model-1"><i class="fa fa-check"></i><b>12.3.9</b> Spatial Durbin Model</a></li>
<li class="chapter" data-level="12.3.10" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#comparing-models"><i class="fa fa-check"></i><b>12.3.10</b> Comparing Models</a></li>
<li class="chapter" data-level="12.3.11" data-path="spatial-regression-iii.html"><a href="spatial-regression-iii.html#impact-assessments"><i class="fa fa-check"></i><b>12.3.11</b> Impact Assessments</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="wrap-up-project.html"><a href="wrap-up-project.html"><i class="fa fa-check"></i><b>13</b> Wrap-up &amp; Project</a>
<ul>
<li class="chapter" data-level="13.1" data-path="wrap-up-project.html"><a href="wrap-up-project.html#w13-learning-objectives"><i class="fa fa-check"></i><b>13.1</b> w13 Learning objectives</a></li>
<li class="chapter" data-level="13.2" data-path="wrap-up-project.html"><a href="wrap-up-project.html#w13-additional-resources"><i class="fa fa-check"></i><b>13.2</b> w13 Additional Resources</a></li>
<li class="chapter" data-level="13.3" data-path="wrap-up-project.html"><a href="wrap-up-project.html#w13-spatial-thinking-in-epidemiology"><i class="fa fa-check"></i><b>13.3</b> w13 Spatial Thinking in Epidemiology</a></li>
<li class="chapter" data-level="13.4" data-path="wrap-up-project.html"><a href="wrap-up-project.html#w13-spatial-analysis-in-epidemiology"><i class="fa fa-check"></i><b>13.4</b> w13 Spatial Analysis in Epidemiology</a></li>
</ul></li>
<li class="part"><span><b>III Appendices</b></span></li>
<li class="chapter" data-level="14" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html"><i class="fa fa-check"></i><b>14</b> Tips for reproducibility in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="locating-spatial-epidemiology.html"><a href="locating-spatial-epidemiology.html#additional-resources"><i class="fa fa-check"></i>Additional Resources</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#workflows-to-enhance-reproducibility"><i class="fa fa-check"></i>Workflows to enhance reproducibility</a>
<ul>
<li><a href="tips-for-reproducibility-in-r.html#using-projects-in-r">Using Projects in <code>R</code></a></li>
</ul></li>
<li><a href="tips-for-reproducibility-in-r.html#understanding-directory-and-file-path-names-in-r">Understanding directory and file path names in <code>R</code></a>
<ul>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#specify-a-location-within-the-working-directory"><i class="fa fa-check"></i>Specify a location within the working directory</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#specify-a-relative-location-outside-the-working-directory"><i class="fa fa-check"></i>Specify a relative location outside the working directory</a></li>
</ul></li>
<li><a href="tips-for-reproducibility-in-r.html#why-r-notebooks">Why <code>R Notebooks</code>?</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#what-you-need-to-know"><i class="fa fa-check"></i>What you need to know</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#important-r-notebook-functions"><i class="fa fa-check"></i>Important R Notebook functions</a>
<ul>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#the-yaml"><i class="fa fa-check"></i>The YAML</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#typing-text"><i class="fa fa-check"></i>Typing text</a></li>
<li><a href="tips-for-reproducibility-in-r.html#adding-r-code">Adding <code>R</code> Code</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#making-tables"><i class="fa fa-check"></i>Making tables</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#workflow"><i class="fa fa-check"></i>Workflow</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#optional-functions"><i class="fa fa-check"></i>Optional functions</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#customizing-your-yaml"><i class="fa fa-check"></i>Customizing your YAML</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#simple-formatting-of-your-notebook"><i class="fa fa-check"></i>Simple formatting of your Notebook</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#text-formatting"><i class="fa fa-check"></i>Text formatting</a></li>
<li class="chapter" data-level="" data-path="tips-for-reproducibility-in-r.html"><a href="tips-for-reproducibility-in-r.html#final-note"><i class="fa fa-check"></i>Final Note</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="sf-overview.html"><a href="sf-overview.html"><i class="fa fa-check"></i><b>15</b> Tips for working with <code>sf</code> data class</a>
<ul>
<li class="chapter" data-level="15.1" data-path="sf-overview.html"><a href="sf-overview.html#st_set_geom"><i class="fa fa-check"></i><b>15.1</b> <code>st_set_geom()</code></a></li>
<li class="chapter" data-level="15.2" data-path="sf-overview.html"><a href="sf-overview.html#st-as-sf"><i class="fa fa-check"></i><b>15.2</b> <code>st_as_sf()</code></a></li>
<li class="chapter" data-level="15.3" data-path="sf-overview.html"><a href="sf-overview.html#st_crs"><i class="fa fa-check"></i><b>15.3</b> <code>st_crs()</code></a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>16</b> Tips for using <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="16.1" data-path="dplyr.html"><a href="dplyr.html#select"><i class="fa fa-check"></i><b>16.1</b> <code>select()</code></a></li>
<li class="chapter" data-level="16.2" data-path="dplyr.html"><a href="dplyr.html#mutate"><i class="fa fa-check"></i><b>16.2</b> <code>mutate()</code></a></li>
<li class="chapter" data-level="16.3" data-path="dplyr.html"><a href="dplyr.html#filter"><i class="fa fa-check"></i><b>16.3</b> <code>filter()</code></a></li>
<li class="chapter" data-level="16.4" data-path="dplyr.html"><a href="dplyr.html#arrange"><i class="fa fa-check"></i><b>16.4</b> <code>arrange()</code></a></li>
<li class="chapter" data-level="16.5" data-path="dplyr.html"><a href="dplyr.html#pipe-operator"><i class="fa fa-check"></i><b>16.5</b> <code>%&gt;%</code> Pipe operator</a></li>
<li class="chapter" data-level="16.6" data-path="dplyr.html"><a href="dplyr.html#group_by-and-summarise"><i class="fa fa-check"></i><b>16.6</b> <code>group_by()</code> and <code>summarise()</code></a></li>
<li class="chapter" data-level="16.7" data-path="dplyr.html"><a href="dplyr.html#join"><i class="fa fa-check"></i><b>16.7</b> <code>join()</code></a></li>
<li class="chapter" data-level="16.8" data-path="dplyr.html"><a href="dplyr.html#pivot_"><i class="fa fa-check"></i><b>16.8</b> Reshaping (transposing) data</a>
<ul>
<li class="chapter" data-level="16.8.1" data-path="dplyr.html"><a href="dplyr.html#pivot_longer-for-going-from-wide-to-long"><i class="fa fa-check"></i><b>16.8.1</b> <code>pivot_longer()</code> for going from wide to long</a></li>
<li class="chapter" data-level="16.8.2" data-path="dplyr.html"><a href="dplyr.html#pivot_wider"><i class="fa fa-check"></i><b>16.8.2</b> <code>pivot_wider()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="intro-tmap.html"><a href="intro-tmap.html"><i class="fa fa-check"></i><b>17</b> Tips for using <code>tmap</code></a>
<ul>
<li class="chapter" data-level="17.1" data-path="intro-tmap.html"><a href="intro-tmap.html#tmap-mode"><i class="fa fa-check"></i><b>17.1</b> <code>tmap</code> mode</a></li>
<li class="chapter" data-level="17.2" data-path="intro-tmap.html"><a href="intro-tmap.html#qtm"><i class="fa fa-check"></i><b>17.2</b> Quick maps: <code>qtm()</code></a>
<ul>
<li class="chapter" data-level="17.2.1" data-path="intro-tmap.html"><a href="intro-tmap.html#customizing-qtm-for-polygons"><i class="fa fa-check"></i><b>17.2.1</b> Customizing <code>qtm()</code> for polygons</a></li>
<li class="chapter" data-level="17.2.2" data-path="intro-tmap.html"><a href="intro-tmap.html#customizing-qtm-for-lines"><i class="fa fa-check"></i><b>17.2.2</b> Customizing <code>qtm()</code> for lines</a></li>
<li class="chapter" data-level="17.2.3" data-path="intro-tmap.html"><a href="intro-tmap.html#customizing-qtm-for-points"><i class="fa fa-check"></i><b>17.2.3</b> Customizing <code>qtm()</code> for points</a></li>
<li class="chapter" data-level="17.2.4" data-path="intro-tmap.html"><a href="intro-tmap.html#finding-valid-color-options"><i class="fa fa-check"></i><b>17.2.4</b> Finding valid color options</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="intro-tmap.html"><a href="intro-tmap.html#building-maps-with-tmap"><i class="fa fa-check"></i><b>17.3</b> Building maps with <code>tmap</code></a>
<ul>
<li class="chapter" data-level="17.3.1" data-path="intro-tmap.html"><a href="intro-tmap.html#building-blocks-in-tmap"><i class="fa fa-check"></i><b>17.3.1</b> Building blocks in <code>tmap</code></a></li>
<li class="chapter" data-level="17.3.2" data-path="intro-tmap.html"><a href="intro-tmap.html#customizing-text-on-maps"><i class="fa fa-check"></i><b>17.3.2</b> Customizing text on maps</a></li>
<li class="chapter" data-level="17.3.3" data-path="intro-tmap.html"><a href="intro-tmap.html#adding-two-or-more-spatial-objects-in-one-map"><i class="fa fa-check"></i><b>17.3.3</b> Adding two or more spatial objects in one map</a></li>
</ul></li>
<li class="chapter" data-level="17.4" data-path="intro-tmap.html"><a href="intro-tmap.html#controlling-layout-and-map-elements"><i class="fa fa-check"></i><b>17.4</b> Controlling layout and map elements</a>
<ul>
<li class="chapter" data-level="17.4.1" data-path="intro-tmap.html"><a href="intro-tmap.html#understanding-the-graphic-space-in-tmap"><i class="fa fa-check"></i><b>17.4.1</b> Understanding the graphic space in <code>tmap</code></a></li>
<li class="chapter" data-level="17.4.2" data-path="intro-tmap.html"><a href="intro-tmap.html#controlling-map-layout"><i class="fa fa-check"></i><b>17.4.2</b> Controlling map layout</a></li>
<li class="chapter" data-level="17.4.3" data-path="intro-tmap.html"><a href="intro-tmap.html#adding-map-elements"><i class="fa fa-check"></i><b>17.4.3</b> Adding map elements</a></li>
<li class="chapter" data-level="17.4.4" data-path="intro-tmap.html"><a href="intro-tmap.html#change-the-global-style-of-a-map"><i class="fa fa-check"></i><b>17.4.4</b> Change the global style of a map</a></li>
</ul></li>
<li class="chapter" data-level="17.5" data-path="intro-tmap.html"><a href="intro-tmap.html#making-small-multiple-maps"><i class="fa fa-check"></i><b>17.5</b> Making small-multiple maps</a>
<ul>
<li class="chapter" data-level="17.5.1" data-path="intro-tmap.html"><a href="intro-tmap.html#small-multiples-as-a-vector-of-variables"><i class="fa fa-check"></i><b>17.5.1</b> Small multiples as a vector of variables</a></li>
<li class="chapter" data-level="17.5.2" data-path="intro-tmap.html"><a href="intro-tmap.html#tmap-facet"><i class="fa fa-check"></i><b>17.5.2</b> Small multiples with facets</a></li>
<li class="chapter" data-level="17.5.3" data-path="intro-tmap.html"><a href="intro-tmap.html#facets-for-time-series"><i class="fa fa-check"></i><b>17.5.3</b> Facets for time-series</a></li>
</ul></li>
<li class="chapter" data-level="17.6" data-path="intro-tmap.html"><a href="intro-tmap.html#small-multiples-with-tmap_arrange"><i class="fa fa-check"></i><b>17.6</b> Small multiples with <code>tmap_arrange()</code></a></li>
<li class="chapter" data-level="17.7" data-path="intro-tmap.html"><a href="intro-tmap.html#summarizing-small-multiples"><i class="fa fa-check"></i><b>17.7</b> Summarizing small multiples</a></li>
<li class="chapter" data-level="17.8" data-path="intro-tmap.html"><a href="intro-tmap.html#saving-maps"><i class="fa fa-check"></i><b>17.8</b> Saving maps</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">EPI 563: Spatial Epidemiology, Fall 2020</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-structure-and-clustering-i" class="section level1" number="8">
<h1><span class="header-section-number">Week 8</span> Spatial Structure and Clustering I</h1>
<div id="getting-ready-w8" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Getting Ready, w8</h2>
<div id="learning-objectives-w8" class="section level3" number="8.1.1">
<h3><span class="header-section-number">8.1.1</span> Learning objectives, w8</h3>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 100%; margin-left: auto; margin-right: auto;  " id="learning-ob">
<caption style="caption-side: top; text-align: center;"><span id="tab:learning-ob">TABLE 1.1: </span> Learning objectives by weekly module</caption><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 6pt; background-color: rgb(208, 211, 212); font-weight: bold;">After this module you should be able to…</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 6pt; background-color: rgb(250, 229, 211); font-weight: normal;">Compare and contrast the statistical, epidemiologic, and policy meaning of geospatial 'clustering' of disease</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 6pt; background-color: rgb(245, 203, 167); font-weight: normal;">Calculate and visually summarize global and local tests for spatial clustering</td></tr>
</table>

</div>
<div id="additional-resources-w8" class="section level3" number="8.1.2">
<h3><span class="header-section-number">8.1.2</span> Additional Resources, w8</h3>
<ul>
<li>Waller L, Gotway C. Applied Spatial Statistics for Public Health Data. Hoboken, NJ: John Wiley &amp; Sons, Inc; 2004. (<em>Available electronically via library</em>)</li>
</ul>
</div>
<div id="important-vocabulary-w8" class="section level3" number="8.1.3">
<h3><span class="header-section-number">8.1.3</span> Important Vocabulary, w8</h3>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 90%; margin-left: auto; margin-right: auto;  " id="tab:unnamed-chunk-206">
<caption style="caption-side: top; text-align: center;"><span id="tab:unnamed-chunk-206">TABLE 8.1: </span> Vocabulary for Week 8</caption><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(84, 153, 199); font-weight: bold;"><span style="color: rgb(255, 255, 255);">Term</span></th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(84, 153, 199); font-weight: bold;"><span style="color: rgb(255, 255, 255);">Definition</span></th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(212, 230, 241); font-weight: bold;">1st order process</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(212, 230, 241); font-weight: normal;">Statistical measures where units taken one at a time. Spatial heterogeneity is about how the mean intensity varies for each unit, and is therefore primarily about first order process</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(169, 204, 227); font-weight: bold;">2nd order process</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(169, 204, 227); font-weight: normal;">Statistical measures where units considered at least two at a time. Spatial dependence is about correlation or relatedness between units and is therefore about 2nd order processes</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(212, 230, 241); font-weight: bold;">Spatial dependence</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(212, 230, 241); font-weight: normal;">When attribute values or statistical parameters are, on avreage, more similar for nearby places than they are for distant places. Spatial dependence is evaluated by looking at pairs or sets of places.</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(169, 204, 227); font-weight: bold;">Spatial dependence: Focal</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(169, 204, 227); font-weight: normal;">Evaluation of clustering or dependence of events or values in a specific focal area, typically defined in relation to a putative hazard</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(212, 230, 241); font-weight: bold;">Spatial dependence: Global</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(212, 230, 241); font-weight: normal;">Evaluation of whether, on average, there is spatial independence (null) or spatial dependence (alternative) in a dataset. A global test returns a single test statistic for the entire dataset</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(169, 204, 227); font-weight: bold;">Spatial dependence: Local</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(169, 204, 227); font-weight: normal;">Evaluation of place-specific dependence by comparing, for each region, the correlation between the index value and the value of the neighbors. Local tests result in a stest statistic for each and every region</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 2pt 2pt 6pt; background-color: rgb(212, 230, 241); font-weight: bold;">Spatial heterogeneity</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 1pt 1pt 1pt 1pt; border-top-color: rgb(255, 255, 255);  border-right-color: rgb(255, 255, 255);  border-bottom-color: rgb(255, 255, 255);  border-left-color: rgb(255, 255, 255); padding: 2pt 6pt 2pt 2pt; background-color: rgb(212, 230, 241); font-weight: normal;">Attributes or statistical parameters are varied (e.g. not homogenous) across sub-areas in a broader region. In Disease mapping we typically are evaluating whether (and how much) disease intensity (risk, rate, prevalence) varies across places.</td></tr>
</table>

</div>
</div>
<div id="spatial-thinking-in-epidemiology-w8" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Spatial Thinking in Epidemiology, w8</h2>
<p>The notion of <em>clusters</em> of disease as a fundamental clue for epidemiologists harkens back to John Snow’s Cholera map, where the appearance of <em>excess cases</em> near the Broad Street pump pointed to an effective intervention, even in the absence of etiologic knowledge about causation. In other words, the appeal of cluster analysis is that we can identify patterns that inform action.</p>
<p>Of course ‘<em>clustering</em>’ or grouping of health status in one group compared to another is the basis for all associational or etiologic epidemiology. We are interested in whether disease occurs more or less often in one group versus another (e.g. <em>exposed</em> versus <em>unexposed</em>). We could say that lung cancer <em>clusters</em> among smokers, especially as compared to non-smokers.</p>
<p>So it is natural to extend this idea to an explicitly spatial frame, since we often find populations in geographically-referenced groups share or spread exposures and resources that affect the health of those populations.</p>
<div id="two-big-questions" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Two big questions…</h3>
<p>In spatial epidemiology most questions boil down to two fundamental questions and their related broad hypotheses:</p>
<ol style="list-style-type: decimal">
<li>Is the health of population (measured as risk, rate, prevalence, etc) <em>spatially homogenous</em> or constant (<span class="math inline">\(H_o\)</span> hypothesis), or is health <em>spatially heterogeneous</em> or variable (<span class="math inline">\(H_a\)</span> hypothesis)?</li>
<li>Are the occurrences of health events, or the value of health parameters <em>spatially independent</em> (<span class="math inline">\(H_o\)</span> hypothesis) or are the events or values <em>spatially dependent</em> or clustered in space, given variation in the population at risk (<span class="math inline">\(H_a\)</span> hypothesis)?</li>
</ol>
<p><strong>The first question</strong> has been the driving question for disease mapping, and in fact if there were complete <em>disease homogeneity</em> or <em>constant risk</em>, spatial epidemiology would not be a fruitful endeavor. But as we saw over the past several weeks, the question of homogeneity versus heterogeneity is not so simple. For instance we had several concerns which drove many of the statistical methods learned to date:</p>
<ul>
<li>True heterogeneity versus spurious heterogeneity arising from statistical imprecision and instability due to small numbers (e.g. either very rare outcomes producing small numerators, or small populations producing small denominators).
<ul>
<li>Statistical disease mapping strategies including Empirical Bayes, Full Bayes modeling, and kernel density estimation</li>
</ul></li>
<li>Meaningful heterogeneity versus heterogeneity driven by spurious or nuisance factors including confounding by other factors
<ul>
<li>Standardizing expected counts or rates to the distribution of a covariate (e.g. age) is one strategy for addressing this spurious patterning</li>
</ul></li>
<li>Biased estimates of spatial risk patterns derived from the spatial scale (e.g. size of aggregating units) and spatial zoning (e.g. particular arbitrary boundaries used), as described in the modifiable areal unit problem (MAUP).
<ul>
<li>The best strategy to avoid MAUP related bias is to rely on meaningful units of analysis. In the absence of clearly meaningful aggregation approaches, comparing sensitivity of results to alternate scale or zoning is useful</li>
</ul></li>
</ul>
<p><strong>The second question</strong> is seemingly similarly straightforward, but upon further investigation shares as many or more caveats and concerns as seen above. On the surface there are numerous statistical tests designed to detect clusters of events, or the presence of spatial autocorrelation of continuous value. However reliable and valid detection of epidemiologically meaningful spatial clusters is threatened by all of the above concerns (e.g. instability due to sparse data; spurious patterns due to nuisance factors), as well as several specific to spatial dependence testing including:</p>
<ul>
<li>Defining a meaningful alternative hypothesis, including the specification of spatial weights or neighbors appropriate to the process at hand</li>
<li>Multiple comparisons implicit in any local test of dependence or autocorrelation</li>
<li>Conceptualizing the underlying process as a function of the spatial scale (e.g. is a ‘<em>cluster</em>’ due to diffusion or spread from one region to another, or is it because all the measured regions share the same exposure?)</li>
</ul>
</div>
<div id="why-does-structure-or-clustering-matter" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Why does structure or clustering matter?</h3>
<p>The spectrum of epidemiologic investigation spans from purely descriptive activities on one end to purely etiologic and causal on the other. In the middle is a great deal of room for hypothesis generating, predictive analyses, and applied cluster analysis as part of disease response. Disease mapping can serve both descriptive and hypothesis generating purposes. Formal spatial cluster analysis is employed for the following reasons:</p>
<ul>
<li><strong>Exploratory cluster detection</strong> and descriptive analysis of disease risk/rate variation when this has not already been established. This can be a crude tool for generating hypotheses about risk factors for health.</li>
<li><strong>Public health response</strong> to outbreak or cluster concern raised from citizen complaints, or surveillance. This includes efforts to definitively identify clusters of disease such as cancer, birth defects, or geographically-limited infectious disease outbreaks.<br />
</li>
<li><strong>Advancing etiologic and population health knowledge</strong> by testing for excess geographic variation above and beyond that explained by known risk factors. This can suggest novel spatially-patterned risk factors, unmeasured confounding, spatial selection processes, or complex spatially-referenced interactions.</li>
</ul>
<p>For health outcomes that vary over time and space, it is possible that there is clustering of health events in space, during specific time periods, and possibly in both dimensions simultaneously.</p>
<p>Therefore, spatial cluster analysis is but <em>one tool</em> in the broader epidemiologic process of understanding the biological, behavioral, and social production of population health, and by extension of acting to promote health and prevent disease. The bottom line from an epidemiologic (or population health) perspective, is that the wide variety of sophisticated statistical tools can, when appropriately used, advance our insight and knowledge but do not on their own substitute for the critical thinking and triangulation necessary for robust and impactful epidemiologic understanding.</p>
</div>
<div id="making-meaning-of-hypotheses-in-spatial-structure-testing" class="section level3" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Making meaning of hypotheses in spatial structure testing</h3>
<p>To make meaningful inference about <em>spatial structure</em> and the presence, absence, location, and magnitude of <em>spatial clusters</em> in health parameters, it is critical to have clarity about the question being asked, and the implied <em>null</em> and <em>alternative</em> hypotheses.</p>
<p>As a starting point, there are three broad categories for testing for the presence of spatial clustering or dependence:</p>
<ol style="list-style-type: decimal">
<li><strong>Global dependence</strong> refers to a single test statistic summarizing a pattern evident across the entire dataset. Below, the global Moran’s I statistic is one example of such an approach. Such tests are especially useful when comparing ‘models’ that aim to explain spatial patterns; changes in the strength of global autocorrelation across competing approaches suggests can provide clues about the drivers or generators of dependence in the data</li>
<li><strong>Local dependence</strong> is a search for the existence of sub-regions in the study area that define are more clustered or autocorrelated than expected by chance alone. While a global test returns only a single value of a test statistic, local tests of clustering return a separate test statistic for each unit of analysis. This strategy can be useful to identify unusual patterns where high or low rates group together; by extension searches for local dependence generate hypotheses about explanations for disease variation in populations</li>
<li><strong>Focal clustering</strong> is a targeted search for excess risk of disease in a pre-defined region. Typically a focal test is defined in relation to a putative hazard, such as a toxic emitter.</li>
</ol>
<p>To effectively conduct a meaningful cluster analysis, Waller &amp; Jacquez ()</p>
<p><em>Statistically</em> we can define null hypotheses which describe expectations of spatial patterns of points or aggregated risks/rates assuming either <em>spatially constant risk</em> (spatial homogeneity in intensity) or <em>spatial independence</em> (spatially random distribution of values across units). We then test our data for evidence that departs from the expectations under the null.</p>
<p><em>Epidemiologically</em>, the questions best-suited for spatial cluster analysis concern the <em>presence of</em>, and ultimately the <em>reasons for</em>, epidemiologically unusual spatial patterns of disease occurrence. So, what makes a pattern <em>epidemiologically unusual</em> or <em>interesting</em>? In other words when might a statistical test be <em>significant</em> but not <em>helpful</em>, at least from the point of view epidemiologic investigation?</p>
<p><a href="https://journals.lww.com/epidem/Abstract/1995/11000/Disease_Models_Implicit_in_Statistical_Tests_of.4.aspx">Waller &amp; Jacquez (1995)</a> suggest a framework for thinking about components of statistical testing for clustering in spatial epidemiology.</p>
<table>
<colgroup>
<col width="25%" />
<col width="74%" />
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Null hypothesis</strong></td>
<td>A statement about what disease pattern is expected in the absence of clustering. A <em>constant risk</em> hypothesis from disease mapping is one example, but spatial independence is another.</td>
</tr>
<tr class="even">
<td><strong>Null spatial model</strong></td>
<td>This can be theoretical or computational. Theoretical models include assumptions about parametric probability distributions for how data are generated under the null. For example asymptotic Gaussian or Poisson independent distributions. However, because large samples are rare and real world data may not follow parametric forms, computational strategies for describing the null can be used. These include the permutation testing we’ve seen in previous weeks.</td>
</tr>
<tr class="odd">
<td><strong>Alternative hypothesis</strong></td>
<td>While our alternative to the <em>constant risk</em> hypothesis was simply that risk was heterogeneous (an omnibus rejection of the null), for spatial dependence the alternative is shaped by the choice of spatial neighbors or spatial weights. Each neighbor specification represents a slightly different alternative hypothesis.</td>
</tr>
<tr class="even">
<td><strong>Cluster statistic</strong></td>
<td>There are numerous cluster statistics including the Moran’s I statistic and the Local Moran’s LISA statistic; we will discuss two this week and a couple next week, but many more exist.</td>
</tr>
</tbody>
</table>
<p><strong>Distribution of the cluster statistic under the null spatial model</strong> Just as we needed a null spatial model that was theoretical or computational, we also need to characterize the distribution of the cluster statistic under the null in order to compare with the observed data</p>
<p>One challenge is that cluster testing strategies tend to be calibrated to identify a particular cluster morphology, but clusters can occur in variety of shapes, sizes, or intensities. For example some detect boundaries (e.g. zones of rapid change; or boundary overlap between exposure and outcome), other detect outliers, and some use neighbors, circles or ellipses to define the index sub-regions for evaluation. The two cluster statistics we will introduce this week rely on a ‘template’ of clustering defined by the choice of the unit of analysis (e.g. the specific scale or zoning at which data are aggregated) and the definition of the neighbors.</p>
</div>
</div>
<div id="spatial-analysis-in-epidemiology-w8" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Spatial Analysis in Epidemiology, w8</h2>
<p>The choice of cluster statistic depends greatly on the nature of the spatial data and parameters of interest. For example different strategies would be used if data were point referenced versus aggregated into areal units, and differences if the parameter or statistic of interest is naturally a continuous value which might be conceived of as normally distributed versus a numerator and denominator pairing representing a Poisson rate.</p>
<p>In this section we will introduce the Global and Local Moran’s I statistics for clustering of very low birthweight in Georgia counties. Moran’s I typically makes sense with areal data. While originally developed for normally distributed data, extensions to Poisson distributed data are available.</p>
<div id="packages-data" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Packages &amp; Data</h3>
<p>In addition to the familiar packages, we will use packages with specific cluster statistics including <code>DCluster</code> and <code>spdep</code> have functions relevant for spatial cluster analysis.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="spatial-structure-and-clustering-i.html#cb199-1"></a><span class="kw">library</span>(sf)       <span class="co"># Read/write spatial data</span></span>
<span id="cb199-2"><a href="spatial-structure-and-clustering-i.html#cb199-2"></a><span class="kw">library</span>(dplyr)    <span class="co"># Provides data pipeline functionality</span></span>
<span id="cb199-3"><a href="spatial-structure-and-clustering-i.html#cb199-3"></a><span class="kw">library</span>(spdep)    <span class="co"># Functions for creating spatial weight, spatial analysis</span></span>
<span id="cb199-4"><a href="spatial-structure-and-clustering-i.html#cb199-4"></a><span class="kw">library</span>(DCluster) <span class="co"># Package with functions for spatial cluster analysis</span></span>
<span id="cb199-5"><a href="spatial-structure-and-clustering-i.html#cb199-5"></a><span class="kw">library</span>(tmap)     <span class="co"># Mapping functionality</span></span></code></pre></div>
<p>In terms of data, we will continue to use the Georgia <em>very low birth weight (VLBW)</em> data, with counts aggregated to the scale of county.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="spatial-structure-and-clustering-i.html#cb200-1"></a>vlbw &lt;-<span class="st"> </span><span class="kw">st_read</span>(<span class="st">&#39;ga-vlbw.gpkg&#39;</span>) <span class="op">%&gt;%</span></span>
<span id="cb200-2"><a href="spatial-structure-and-clustering-i.html#cb200-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">rate =</span> VLBW <span class="op">/</span><span class="st"> </span>TOT )</span>
<span id="cb200-3"><a href="spatial-structure-and-clustering-i.html#cb200-3"></a></span>
<span id="cb200-4"><a href="spatial-structure-and-clustering-i.html#cb200-4"></a>r &lt;-<span class="st"> </span><span class="kw">sum</span>(vlbw<span class="op">$</span>VLBW) <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(vlbw<span class="op">$</span>TOT)</span>
<span id="cb200-5"><a href="spatial-structure-and-clustering-i.html#cb200-5"></a>vlbw<span class="op">$</span>expected &lt;-<span class="st"> </span>r<span class="op">*</span>vlbw<span class="op">$</span>TOT</span></code></pre></div>
</div>
<div id="global-morans-i" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Global Moran’s I</h3>
<p>There are numerous tests of global spatial auto-correlation including Geary’s <span class="math inline">\(C\)</span> test, the Getis-Ord <span class="math inline">\(G^*\)</span> statistic and others. We will focus on the most commonly used, the Moran’s I statistic. As discussed in the lectures, the Moran’s I statistic is similar to a Pearson’s correlation coefficient, in that it takes the product of differences of two measures from their respective mean to quantify dependence or similarity. In the case of Pearson’s correlation coefficient, the two measures (e.g. <span class="math inline">\(x,y\)</span>) are of two constructs. However in the case of Moran’s I, the two measures of of the <em>index</em> county, as compared to the average value of that county’s <em>neighbors</em>. The spatial weights matrix <span class="math inline">\(w_{ij}\)</span> encodes the spatial relationships between places.</p>
<p>This is the Moran’s I statistic:</p>
<p><span class="math display">\[I=\frac{\sum\limits_{i=1}^{n} \sum\limits_{j=1}^{n} w_{ij} (Y_i-\bar Y)(Y_j-\bar Y)}{ \sum\limits_{i=1}^{n} \sum\limits_{j=1}^{n} w_{ij}} \left( \frac{1}{\frac{1}{n} \sum\limits_{i=1}^{n} (Y_i-\bar Y)^2} \right)\]</span></p>
<p>In the formula <span class="math inline">\(i\)</span> references the count of regions from <span class="math inline">\(1:n\)</span>, the weights matrix, <span class="math inline">\(w_{ij}\)</span> represents the relatedness for pairs of regions. For example, if regions are neighbors, the weight is <span class="math inline">\(1\)</span>, if not the weight is <span class="math inline">\(0\)</span>. <span class="math inline">\(\bar Y\)</span> is the mean value of the parameter.</p>
<p>Global Moran’s I considers values observed in pairs. If adjacent pairs are simultaneously above (or simultaneously below) average, it contributes to <em>positive value of test statistic</em>. If one region is above average and the other is below, that contributes to a <em>negative value</em> (e.g. opposites).</p>
<p>The null hypothesis of the Moran’s I is that measures are <em>spatially independent</em>, and in this setting the test statistic would be zero. Remember that <em>spatial independence</em> means the value of the parameter (very low birthweight rate in this case) in a given county is completely independent of the value in neighboring counties. However if there is <em>positive spatial autocorrelation</em>, the test statistic will be positive (but generally not greater than 1), and suggestive that neighboring counties are more similar than distant counties. In unusual circumstances, the Moran’s I test statistic can be negative (e.g. when index county is opposite all of its neighbors).</p>
<p>First we will set up a spatial weights matrix to represent spatial relationships. Only a Queen contiguity relationship is specified here, although other definitions would represent additional <em>alternative hypotheses</em> as to the assumption of spatial independence. Notice that for this function, we need the neighbor object (of class <code>nb</code>) to be converted to another format called a <em>neighborhood list with spatial weights</em>.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="spatial-structure-and-clustering-i.html#cb201-1"></a>qnb &lt;-<span class="st"> </span><span class="kw">poly2nb</span>(vlbw)</span>
<span id="cb201-2"><a href="spatial-structure-and-clustering-i.html#cb201-2"></a>q_listw &lt;-<span class="st"> </span><span class="kw">nb2listw</span>(qnb, <span class="dt">style =</span> <span class="st">&#39;W&#39;</span>) <span class="co"># row-standardized weights</span></span></code></pre></div>
<div id="global-morans-i-for-normally-distributed-variable" class="section level4" number="8.3.2.1">
<h4><span class="header-section-number">8.3.2.1</span> Global Moran’s I for normally distributed variable</h4>
<p>There are many kinds of measures of variables on which you might choose to carry out spatial auto-correlation analysis. For example, measures of epidemiologic exposures (access to care, environmental toxicants, built environment) might be represented as continuous, normally distributed values. In the spatial regression module we will discuss the assessment of spatial autocorrelation in multivariable regression model <em>residuals</em> as another use (e.g. to diagnose residual spatially-structured errors); these would also be expected to be normally distributed.</p>
<p>The following function <code>moran.test()</code> is from the package <code>spdep</code>, and takes a single continuous value. In our case where the parameter of interest is a <em>risk</em>, this first version of the Moran’s I statistic treats each observed risk value as equal, without considering the differences in sample size among counties.</p>
<p>The function allows consideration of either a theoretical null spatial model (e.g. assumes the variance of <span class="math inline">\(I\)</span> statistic is consistent with an asymptotic <em>normal distribution</em> specified by the options <code>randomization = FALSE</code>), or for the null spatial model to be computational (e.g. assume variance of the <span class="math inline">\(I\)</span> statistic is not normal, and will be empirically approximated through random permutations). Below we specify the computational null by indicating <code>randomisation = TRUE</code>. You can read more about the arguments and information returned by this function by looking at the document help.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="spatial-structure-and-clustering-i.html#cb202-1"></a><span class="kw">moran.test</span>(vlbw<span class="op">$</span>rate, </span>
<span id="cb202-2"><a href="spatial-structure-and-clustering-i.html#cb202-2"></a>                 <span class="dt">listw =</span> q_listw, </span>
<span id="cb202-3"><a href="spatial-structure-and-clustering-i.html#cb202-3"></a>                 <span class="dt">randomisation =</span> T)</span></code></pre></div>
<pre><code>## 
## 	Moran I test under randomisation
## 
## data:  vlbw$rate  
## weights: q_listw    
## 
## Moran I statistic standard deviate = 4.5281, p-value = 2.975e-06
## alternative hypothesis: greater
## sample estimates:
## Moran I statistic       Expectation          Variance 
##       0.214197175      -0.006329114       0.002371817</code></pre>
<p>The Moran’s I statistic of 0.21, with a very small p-value suggests that there is evidence of <em>moderate spatial autocorrelation</em>, and that this result is highly statistically significant.</p>
<p>To visualize how the mortality rate for each county compares to each county’s neighbors we can use <code>moran.plot()</code>.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="spatial-structure-and-clustering-i.html#cb204-1"></a><span class="kw">moran.plot</span>(<span class="dt">x =</span> vlbw<span class="op">$</span>rate, </span>
<span id="cb204-2"><a href="spatial-structure-and-clustering-i.html#cb204-2"></a>           <span class="dt">listw =</span> q_listw, </span>
<span id="cb204-3"><a href="spatial-structure-and-clustering-i.html#cb204-3"></a>           <span class="dt">labels =</span> vlbw<span class="op">$</span>NAME, </span>
<span id="cb204-4"><a href="spatial-structure-and-clustering-i.html#cb204-4"></a>           <span class="dt">xlab =</span> <span class="st">&#39;VLBW Risk&#39;</span>, </span>
<span id="cb204-5"><a href="spatial-structure-and-clustering-i.html#cb204-5"></a>           <span class="dt">ylab =</span> <span class="st">&#39;Spatially-lagged mean risk&#39;</span>)</span></code></pre></div>
<p><img src="EPI563-SpatialEPI_files/figure-html/unnamed-chunk-212-1.png" width="672" /></p>
<p>This plot demonstrates the correlation or relationship between each counties VLBW risk (x-axis) against the average of the risk for that county’s spatial neighbors (y-axis; assuming Queen contiguity). The dotted lines divide the plot into quadrants representing above and below the mean value of both the rate, and the spatially-lagged rates of neighbors. The solid line is the slope of correlation (it corresponds to the 0.21).</p>
<p>Thinking about each quadrant in turn can help make sense of this plot, and of the interpretation of the spatial autocorrelation statistic. For example, look at Randolph county (labeled in the upper-right quadrant). This county is characterized by having higher than average VLBW risk than the state (e.g. it is to the right side of average on the <em>x-axis</em>), and also the average VLBW risk among Randolph county’s Queen contiguity neighbors is higher than average (e.g. it is above the average on the <em>y-axis</em>). While none are labeled, there are also counties in the <em>left lower</em> quadrant. These points represent individual counties with <em>lower than average</em> risk of VLBW, surrounded by neighboring counties that also have lower (on average) risk.</p>
<p>Finally there are some points in the ‘<em>off-diagonal</em>’ quadrants: in the upper-left are counties where their own risk is lower than average (e.g. small values on the <em>x-axis</em>), but they are surrounded by counties that have (on average) higher than average risk (e.g. large values on the <em>y-axis</em>).</p>
<p>While these are clues about <em>where</em> clustering occurs, remember that the global Moran’s I provides us with only <strong>one statistical test value</strong> for the entire state of Georgia. So the question being asked is: “<em>Is there spatial autocorrelation in VLBW risk in Georgia</em>” and the answer to the question is “<em>Most likely, yes</em>”. However this test did not explicitly quantify the likelihood of any specific location where those clusters might be.</p>
</div>
<div id="global-morans-i-for-poisson-distributed-rate-data" class="section level4" number="8.3.2.2">
<h4><span class="header-section-number">8.3.2.2</span> Global Moran’s I for Poisson-distributed rate data</h4>
<p>While many measures may be appropriately assessed under the normality assumptions of the previous Global Moran’s I, in general disease rates are <strong>not</strong> best assessed this way. This is because the rates themselves may not be normally distributed, but also because the variance of each rate likely differs because of different size population at risk. For example the previous test assumed that we had the same level of certainty about the rate in each county, when in fact some counties have very sparse data (with high variance) and others have adequate data (with relatively lower variance).</p>
<p>In short, that is one reason we do not use Gaussian assumptions in analyzing health data, instead using binomial, Poisson, and other distributions to model disease occurrence. Luckily, there are extensions of the global Moran’s I that treat our measures as Poisson (or negative binomial) rather than normal.</p>
<p>The package <code>DCluster</code> has several wrapper functions which work with the <code>moran.test()</code> function in <code>spdep</code> but accommodate these alterations. As usual, it would be wise to use <code>?moranI.test()</code> to look at the help documentation for further detail.</p>
<p>Note, the addition of arguments <code>n=159</code> and <code>S0 = Szero(q_listw)</code> are now required for this function. The <code>n=</code> argument specifies the number of regions, whereas the <code>S0 =</code> argument calculates the global sum of weights. More specifically the helper function <code>Szero()</code> calculates several constants that are needed by various autocorrelation statistics calculations.</p>
<p>Also note that instead of using the calculated <em>rate</em>, we specify the county of the outcome and the <code>log(expected)</code> as an offset. We can also specify the number of random simulations of the <em>null hypothesis</em> to run in order to calculate the empiricaly p-value.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="spatial-structure-and-clustering-i.html#cb205-1"></a><span class="kw">moranI.test</span>(VLBW <span class="op">~</span><span class="st"> </span><span class="kw">offset</span>(<span class="kw">log</span>(expected)), </span>
<span id="cb205-2"><a href="spatial-structure-and-clustering-i.html#cb205-2"></a>                  <span class="dt">data =</span> vlbw,</span>
<span id="cb205-3"><a href="spatial-structure-and-clustering-i.html#cb205-3"></a>                  <span class="dt">model =</span> <span class="st">&#39;poisson&#39;</span>,</span>
<span id="cb205-4"><a href="spatial-structure-and-clustering-i.html#cb205-4"></a>                  <span class="dt">R =</span> <span class="dv">499</span>,</span>
<span id="cb205-5"><a href="spatial-structure-and-clustering-i.html#cb205-5"></a>                  <span class="dt">listw =</span> q_listw,</span>
<span id="cb205-6"><a href="spatial-structure-and-clustering-i.html#cb205-6"></a>                  <span class="dt">n =</span> <span class="dv">159</span>,</span>
<span id="cb205-7"><a href="spatial-structure-and-clustering-i.html#cb205-7"></a>                  <span class="dt">S0 =</span> <span class="kw">Szero</span>(q_listw))</span></code></pre></div>
<pre><code>## Moran&#39;s I test of spatial autocorrelation 
## 
## 	Type of boots.: parametric 
## 	Model used when sampling: Poisson 
## 	Number of simulations: 499 
## 	Statistic:  0.2141972 
## 	p-value :  0.002</code></pre>
<p>Not surprisingly, the Moran’s I statistic itself is virtually identical to what we got in the previous example (<span class="math inline">\(I=0.21\)</span>). While the empirical p-value of <span class="math inline">\(p=0.002\)</span> is still significant at <span class="math inline">\(\alpha = 0.05\)</span>, it is substantially larger than the p-value calculated by the Moran’s I test run under the assumption of normality. This reflects the variation in precision among counties, that is now at least partially being accounted for.</p>
</div>
<div id="global-morans-i-after-empirical-bayes-smoothing" class="section level4" number="8.3.2.3">
<h4><span class="header-section-number">8.3.2.3</span> Global Moran’s I after Empirical Bayes smoothing</h4>
<p>Given the concern for a relatively rare outcome, and few births in some counties, we might also be concerned about whether the rates are being well-estimated. While the <code>moranI.test()</code> function above helped address the unequal variance of sparse as compared with populous counties, it did not directly address the <em>reliability</em> of the estimate. However it is possible to combine the disease mapping tool <em>Empirical Bayes smoothing</em> with the Moran’s I statistic to get a more reliable estimate of global spatial auto-correlation. The <code>EBImoran.mc()</code> function from the <code>spdep</code> package does this for us.</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="spatial-structure-and-clustering-i.html#cb207-1"></a>ebm &lt;-<span class="st"> </span><span class="kw">EBImoran.mc</span>(<span class="dt">n =</span> vlbw<span class="op">$</span>VLBW,</span>
<span id="cb207-2"><a href="spatial-structure-and-clustering-i.html#cb207-2"></a>                   <span class="dt">x =</span> vlbw<span class="op">$</span>TOT,</span>
<span id="cb207-3"><a href="spatial-structure-and-clustering-i.html#cb207-3"></a>                   <span class="dt">listw =</span> q_listw,</span>
<span id="cb207-4"><a href="spatial-structure-and-clustering-i.html#cb207-4"></a>                   <span class="dt">nsim =</span> <span class="dv">499</span>)</span>
<span id="cb207-5"><a href="spatial-structure-and-clustering-i.html#cb207-5"></a><span class="kw">print</span>(ebm)</span></code></pre></div>
<pre><code>## 
## 	Monte-Carlo simulation of Empirical Bayes Index (mean subtracted)
## 
## data:  cases: vlbw$VLBW, risk population: vlbw$TOT
## weights: q_listw
## number of simulations + 1: 500
## 
## statistic = 0.20882, observed rank = 500, p-value = 0.002
## alternative hypothesis: greater</code></pre>
<p>In this case, the Moran’s I statistic remains similar, again adding confidence to our belief that this test value is not simply a function of extreme outliers due to sparse data. As mentioned above, the relatively larger p-value could derive from the (more appropriate) use of Poisson rather than Gaussian distribution, but also from the limits of precision from the permutation empirical p-values as compared with asymptotic p-values.</p>
</div>
</div>
<div id="local-morans-i" class="section level3" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Local Moran’s I</h3>
<p>Once again, the interest and importance of <em>global</em> tests of spatial autocorrelation are in describing the <em>overall structure</em> of a spatial dataset, or in diagnosing or confirming underlying assumptions. However the identification (and mapping) of specific local <em>clusters of regions</em> that represent <em>hot spots</em> (grouped-areas of high risk) or <em>cold spots</em> (grouped-areas of low risk) is often a motivation for spatial cluster analysis; this is the purview of <em>local</em> tests of spatial auto-correlation.</p>
<p>The Local Moran’s I is simply a decomposition of the global test into the individual values that are part of the summation. Unfortunately, there are many more caveats when it comes to using these <em>Local Indicators of Spatial Association</em> (LISA) statistics.</p>
<p><span class="math display">\[I_i = \frac{(Y_i-\bar Y)}{\sum\limits_{j=1}^{n}(Y_j-\bar Y)^2 / (n-1)} \sum\limits_{j=1}^{n}w_{ij}(Y_j-\bar Y)\]</span></p>
<p>This formula is simply the specification of an <span class="math inline">\(I\)</span> statistic for each sub-region in the study area. Together, all of the <span class="math inline">\(I_i\)</span> sum to <span class="math inline">\(I\)</span>. However, there are a few additional wrinkles when we break the overall <span class="math inline">\(I\)</span> statistic into sub-parts.</p>
<ul>
<li>First, in the global tests, our parametric assumptions for the variance are plausible, assuming we have a reasonably large number of regions (e.g. we have n=159). However for local test, we want to make inference separately about each region (county), and in that case we are trying to test whether 1 county is correlated with its handful of neighbors. In other words, the N is quite small for each test, making asymptotic (e.g. ‘large-number’) tests invalid.</li>
<li>In addition, we are testing each county in turn, raising concerns for multiple comparisons and corresponding Type I error (e.g. whether we have <em>false positives</em> in terms of statistical significance).</li>
</ul>
<p>One thing to keep in mind is that LISA statistics are often selected to identify <em>where</em> disease clusters. The p-value is a null-hypothesis statistical test of <em>whether</em> the clustering is sufficiently unusual to be called significant. The most efficient way to test for <em>whether</em> there is clustering is with global tests; the use of local tests should therefore be seen in the light of <em>descriptive and exploratory</em>, although as we shall see, there are adjustments for multiple comparisons to reduce concern for Type I error.</p>
<div id="local-morans-i---localmoran" class="section level4" number="8.3.3.1">
<h4><span class="header-section-number">8.3.3.1</span> Local Moran’s I - <code>localmoran()</code></h4>
<p>The first approach is to use the basic <code>localmoran()</code> function in <code>spdep</code>. This method treats the variable of interest as if it were a normally distributed continuous variable; that would be reasonable for some exposure or covariate measures, and in some cases could be reasonable for disease <em>rates</em> if the values have relatively similar levels of variance (e.g. all regions have similar population sizes). This function does permit adjustment of p-values for multiple comparisons; I use the <em>false discovery rate</em> option, <code>fdr</code>, below although other options exist (e.g. see help, <code>?p.adjustSP</code>, for list of options).</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="spatial-structure-and-clustering-i.html#cb209-1"></a>lm1 &lt;-<span class="st"> </span><span class="kw">localmoran</span>(<span class="dt">x =</span> vlbw<span class="op">$</span>rate,</span>
<span id="cb209-2"><a href="spatial-structure-and-clustering-i.html#cb209-2"></a>                  <span class="dt">listw =</span> q_listw,</span>
<span id="cb209-3"><a href="spatial-structure-and-clustering-i.html#cb209-3"></a>                  <span class="dt">p.adjust.method =</span> <span class="st">&#39;fdr&#39;</span> )</span>
<span id="cb209-4"><a href="spatial-structure-and-clustering-i.html#cb209-4"></a></span>
<span id="cb209-5"><a href="spatial-structure-and-clustering-i.html#cb209-5"></a><span class="kw">dim</span>(lm1)      <span class="co"># dimensions of object returned</span></span></code></pre></div>
<pre><code>## [1] 159   5</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="spatial-structure-and-clustering-i.html#cb211-1"></a><span class="kw">summary</span>(lm1)  <span class="co"># summary of object returned</span></span></code></pre></div>
<pre><code>##        Ii                E.Ii               Var.Ii             Z.Ii         
##  Min.   :-1.55827   Min.   :-0.006329   Min.   :0.09207   Min.   :-4.23774  
##  1st Qu.:-0.03078   1st Qu.:-0.006329   1st Qu.:0.14580   1st Qu.:-0.05377  
##  Median : 0.06534   Median :-0.006329   Median :0.19018   Median : 0.15924  
##  Mean   : 0.21420   Mean   :-0.006329   Mean   :0.19792   Mean   : 0.51316  
##  3rd Qu.: 0.34255   3rd Qu.:-0.006329   3rd Qu.:0.23924   3rd Qu.: 0.78333  
##  Max.   : 2.69958   Max.   :-0.006329   Max.   :0.97514   Max.   : 6.81871  
##    Pr(z &gt; 0)     
##  Min.   :0.0000  
##  1st Qu.:1.0000  
##  Median :1.0000  
##  Mean   :0.8371  
##  3rd Qu.:1.0000  
##  Max.   :1.0000</code></pre>
<p>The contents returned by the <code>localmoran()</code> function is a <code>matrix</code> with five columns with separate values for each of <span class="math inline">\(n=159\)</span> rows (representing counties in our data).</p>
<ul>
<li><strong><code>Ii</code></strong> is the local Moran’s I test statistic.<br />
</li>
<li><strong><code>E.Ii</code></strong> is the <em>expected</em> value of the Moran’s I statistic under the null. Note all values are the same.</li>
<li><strong><code>Var.Ii</code></strong> is the variance of the local Moran’s I statistic.</li>
<li><strong><code>Z.Ii</code></strong> is the standardized deviation (e.g. ‘<em>z-score</em>’) of the local Moran’s I statistic</li>
<li><strong><code>Pr(Z&gt;0)</code></strong> is the p-value (in this case adjusted for multiple comparison using the false discovery rate method).</li>
</ul>
</div>
<div id="plotting-a-cluster-map" class="section level4" number="8.3.3.2">
<h4><span class="header-section-number">8.3.3.2</span> Plotting a Cluster Map</h4>
<p>There are many options for visualizing the results including plotting the Local Moran’s I statistic value <span class="math inline">\(I_i\)</span> for each county, mapping the p-value, or a combination. However a common approach implemented in the free <em>GeoDa</em> software, and adopted in the ESRI <em>ArcGIS</em> software is to produce a map representing each county with respect to the four quadrants of Moran’s plot.</p>
<div class="figure"><span id="fig:unnamed-chunk-216"></span>
<img src="images/lisa-typology.jpg" alt="LISA scatterplot typology"  />
<p class="caption">
FIGURE 8.1: LISA scatterplot typology
</p>
</div>
<ol style="list-style-type: decimal">
<li><em>High-High</em> are regions with statistically significant <strong>positive</strong> values for the local <span class="math inline">\(I_i\)</span> statistic, and <em>higher-than-average</em> rates in both <em>index regions</em> and their <em>neighbors</em></li>
<li><em>Low-Low</em> are regions with statistically significant <strong>positive</strong> values for the local <span class="math inline">\(I_i\)</span> statistic (because positive values of <span class="math inline">\(I_i\)</span> represent <em>similar</em> values, whether similarly high or similarly low), and <em>lower-than-average</em> rates in both index regions and their neighbors</li>
<li><em>High-Low</em> are regions with statistically significant <strong>negative</strong> values for the local <span class="math inline">\(I_i\)</span> statistic (because <span class="math inline">\(I_i\)</span> is negative when the index and neighbors are inversely related), with the index region having <em>higher-than-average</em> rates, and the neighbors having <em>lower-than-average</em> rates</li>
<li><em>Low-High</em> are counties with statistically significant <strong>negative</strong> values for the local <span class="math inline">\(I_i\)</span> statistic, with the index county having <em>lower-than-average</em> rates, and the neighbors having <em>higher-than-average</em> rates</li>
<li><em>Non-significant</em> all regions with non-significant values for the <span class="math inline">\(I_i\)</span> statistic are symbolized in a neutral color.</li>
</ol>
<p>In practice, we can simply use the p-value from the <code>localmoran()</code> test to identify specific regions that are statistically significantly different from expectations under the null. Then among these ‘<em>significant</em>’ regions we can assign them to a quadrant based on two aspects of the risk or rate:</p>
<ul>
<li>The standardized (e.g. z-score value) of the VLBW <code>rate</code> in each county</li>
<li>The weighed average of the standardized <code>rate</code> for each county’s neighbors, where the weights are a function of neighbor definition. The function <code>lag.listw()</code> does the computation for us; it accepts a vector of measures plus a <code>listw</code> class description of the neighbors. It returns a vector of the ‘<em>spatially lagged</em>’ or averaged values of the variable of interest.</li>
</ul>

<div class="rmdnote">
In the code below I use a <code>dplyr</code> function called <code>case_when()</code>. This function is an efficient way to do the work that would typically be contained in a long chain of <code>ifelse()</code> statements. The syntax is a test on the left-hand-side, a tilde (<code>~</code>) connecting, and the new assigned variable if the test is <code>TRUE</code> on the right-hand-side.
</div>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="spatial-structure-and-clustering-i.html#cb213-1"></a><span class="co"># For convenience, give an easier name to the 5th column, representing p-value</span></span>
<span id="cb213-2"><a href="spatial-structure-and-clustering-i.html#cb213-2"></a><span class="kw">names</span>(lm1)[<span class="dv">5</span>] &lt;-<span class="st"> &#39;pvalue&#39;</span></span>
<span id="cb213-3"><a href="spatial-structure-and-clustering-i.html#cb213-3"></a></span>
<span id="cb213-4"><a href="spatial-structure-and-clustering-i.html#cb213-4"></a><span class="co"># create lagged local raw_rate - in other words the average of the queen neighbors value</span></span>
<span id="cb213-5"><a href="spatial-structure-and-clustering-i.html#cb213-5"></a>vlbw<span class="op">$</span>lag &lt;-<span class="st"> </span><span class="kw">lag.listw</span>(q_listw, <span class="dt">var =</span> vlbw<span class="op">$</span>rate)</span>
<span id="cb213-6"><a href="spatial-structure-and-clustering-i.html#cb213-6"></a>vlbw<span class="op">$</span>lm_pv &lt;-<span class="st"> </span>lm1[,<span class="dv">5</span>]</span>
<span id="cb213-7"><a href="spatial-structure-and-clustering-i.html#cb213-7"></a></span>
<span id="cb213-8"><a href="spatial-structure-and-clustering-i.html#cb213-8"></a><span class="co"># Create a new dataset that includes standardized values, and then creates a new variable</span></span>
<span id="cb213-9"><a href="spatial-structure-and-clustering-i.html#cb213-9"></a><span class="co"># &#39;lm_quad&#39; which takes on the above categorical values.</span></span>
<span id="cb213-10"><a href="spatial-structure-and-clustering-i.html#cb213-10"></a>vlbw_lm &lt;-<span class="st"> </span>vlbw <span class="op">%&gt;%</span></span>
<span id="cb213-11"><a href="spatial-structure-and-clustering-i.html#cb213-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">raw_std =</span> <span class="kw">as.numeric</span>(<span class="kw">scale</span>(rate)), <span class="co"># scale means standardize to mean 0, 1 SD</span></span>
<span id="cb213-12"><a href="spatial-structure-and-clustering-i.html#cb213-12"></a>         <span class="dt">lag_std =</span> <span class="kw">as.numeric</span>(<span class="kw">scale</span>(lag)),</span>
<span id="cb213-13"><a href="spatial-structure-and-clustering-i.html#cb213-13"></a>         <span class="dt">lm_quad =</span> <span class="kw">factor</span>(<span class="kw">case_when</span>(  <span class="co"># All of this is assigning labels based on values</span></span>
<span id="cb213-14"><a href="spatial-structure-and-clustering-i.html#cb213-14"></a>           raw_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lm_pv <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;High-High&#39;</span>,</span>
<span id="cb213-15"><a href="spatial-structure-and-clustering-i.html#cb213-15"></a>            raw_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lm_pv <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;Low-Low&#39;</span>,</span>
<span id="cb213-16"><a href="spatial-structure-and-clustering-i.html#cb213-16"></a>            raw_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lm_pv <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;Low-High&#39;</span>,</span>
<span id="cb213-17"><a href="spatial-structure-and-clustering-i.html#cb213-17"></a>            raw_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lm_pv <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;High-Low&#39;</span>,</span>
<span id="cb213-18"><a href="spatial-structure-and-clustering-i.html#cb213-18"></a>            lm_pv <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;Non-significant&#39;</span>),</span>
<span id="cb213-19"><a href="spatial-structure-and-clustering-i.html#cb213-19"></a>           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&#39;High-High&#39;</span>,<span class="st">&#39;Low-Low&#39;</span>,<span class="st">&#39;Low-High&#39;</span>,<span class="st">&#39;High-Low&#39;</span>,<span class="st">&#39;Non-significant&#39;</span>)))</span></code></pre></div>
<p>To summarize, the code above accomplished the following steps:</p>
<ul>
<li>Assign a new column to our <code>vlbw</code> dataset named <code>lag</code>. This variable (produced with <code>lag.listw()</code> function) is the average VLBW prevalence in the neighbors (defined by Queen contiguity in this case) of each county</li>
<li>Assign a new column to our <code>vlbw</code> datasets named <code>lm_pv</code> (for <em>local moran’s p-value</em>). This is done so all the needed information is one object, the <code>vlbw</code> data set.</li>
<li>Within the chained series of <code>dplyr</code> steps that produce our new data object, <code>vlbw_lm</code>, the following steps occur:
<ul>
<li>Standardize the raw rate so that zero is the <em>mean value</em> and each unit represents one standard deviation</li>
<li>Standardize the spatially lagged rate</li>
<li>Recode every county according to three factors: <strong>i)</strong> is the VLBW risk in the county larger or smaller than average (e.g. higher or lower than zero)?; <strong>ii)</strong> is the VLBW risk among the spatial neighbors of the county larger or smaller than average?; and <strong>iii)</strong> is the local Moran’s I test statistic significant at <span class="math inline">\(\alpha = 0.05\)</span> after adjusting for multiple comparisons with the false discovery rate method?</li>
<li>Note that in the recode, each line is a <code>TRUE/FALSE</code> statement. If the answer was <code>FALSE</code> to each option then the final option is for the county to be assigned the value <code>'Non-significant'</code>.</li>
</ul></li>
</ul>
<p>Having created this re-coded variable, we can now plot the results. The palette used below is a custom specification of colors, with each color represented by its HEX value (an alphanumerical system for cataloging the color spectrum). These colors are roughly what is produced in <em>GeoDa</em> and <em>ArcGIS</em>, but any colors suitable for categorical data (as compared to sequential data) would be appropriate.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="spatial-structure-and-clustering-i.html#cb214-1"></a><span class="kw">tm_shape</span>(vlbw_lm) <span class="op">+</span></span>
<span id="cb214-2"><a href="spatial-structure-and-clustering-i.html#cb214-2"></a><span class="st">  </span><span class="kw">tm_fill</span>(<span class="st">&#39;lm_quad&#39;</span>,</span>
<span id="cb214-3"><a href="spatial-structure-and-clustering-i.html#cb214-3"></a>          <span class="dt">style =</span> <span class="st">&#39;cat&#39;</span>,</span>
<span id="cb214-4"><a href="spatial-structure-and-clustering-i.html#cb214-4"></a>          <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#377EB8&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>, <span class="st">&quot;#984EA3&quot;</span>, <span class="st">&quot;#ffffb3&quot;</span>),</span>
<span id="cb214-5"><a href="spatial-structure-and-clustering-i.html#cb214-5"></a>          <span class="dt">title =</span> <span class="st">&#39;Cluster category&#39;</span>) <span class="op">+</span></span>
<span id="cb214-6"><a href="spatial-structure-and-clustering-i.html#cb214-6"></a><span class="st">  </span><span class="kw">tm_borders</span>()</span></code></pre></div>
<p><img src="EPI563-SpatialEPI_files/figure-html/unnamed-chunk-219-1.png" width="672" />
There are apparent ‘<em>High-High</em>’ clusters, a single county that is ‘<em>Low-Low</em>’, and no counties categorized as spatial outliers (e.g. ‘<em>High-Low</em>’ or ‘<em>Low-High</em>’).</p>

<div class="rmdnote">
How can there be a ‘<em>cluster</em>’ of only 1 county as is seen for both a <em>High-High</em> and a <em>Low-Low</em> designation? Remember a cluster is defined by the intersection of whether the region itself is unusual <strong>and</strong> whether the neighbors are unusual. But because this process is carried out separately for each county, it is quite plausible that a single region is situted among other similarly risk regions and is categorized as a local cluster, but it’s neigbors may not have sufficient evidence to say that their neighbors are also similarly extreme.
</div>
</div>
<div id="local-morans-i---localmoran.exact" class="section level4" number="8.3.3.3">
<h4><span class="header-section-number">8.3.3.3</span> Local Moran’s I - <code>localmoran.exact()</code></h4>
<p>Another approach to the local spatial auto-correlation question, is to use exact tests to account for the small-n problem of each test. For this approach, you must supply a <em>regression model object</em> because the test is done on the fitted values. The help documentation specifies this must be an <code>lm()</code> object (e.g. linear model), and that no offsets are allowed. One way to get the linear regression to account for the difference in population-at-risk is to weight each observation (e.g. each region) such that their weight is the proportion of the total state population of births at risk. Also note, that <code>localmoran.exact()</code> uses the <em>spatial neighbors</em> objects, <code>qnb</code>, rather than the previously used <em>spatial neighbors weights list</em>, <code>q_listw</code>.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="spatial-structure-and-clustering-i.html#cb215-1"></a><span class="co"># Create a vector of weights that reflect the relative population (births) size in each county</span></span>
<span id="cb215-2"><a href="spatial-structure-and-clustering-i.html#cb215-2"></a>wts &lt;-<span class="st"> </span>vlbw<span class="op">$</span>TOT <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(vlbw<span class="op">$</span>TOT) <span class="op">*</span><span class="st"> </span><span class="dv">159</span></span>
<span id="cb215-3"><a href="spatial-structure-and-clustering-i.html#cb215-3"></a></span>
<span id="cb215-4"><a href="spatial-structure-and-clustering-i.html#cb215-4"></a><span class="co"># Fit a weighted linear regression model of the raw (observed) rates</span></span>
<span id="cb215-5"><a href="spatial-structure-and-clustering-i.html#cb215-5"></a>reg1 &lt;-<span class="st"> </span><span class="kw">lm</span>(rate <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, </span>
<span id="cb215-6"><a href="spatial-structure-and-clustering-i.html#cb215-6"></a>           <span class="dt">data =</span> vlbw,</span>
<span id="cb215-7"><a href="spatial-structure-and-clustering-i.html#cb215-7"></a>           <span class="dt">weights =</span> wts)</span>
<span id="cb215-8"><a href="spatial-structure-and-clustering-i.html#cb215-8"></a></span>
<span id="cb215-9"><a href="spatial-structure-and-clustering-i.html#cb215-9"></a><span class="co"># Carry out the Exact Moran&#39;s I test on the model object</span></span>
<span id="cb215-10"><a href="spatial-structure-and-clustering-i.html#cb215-10"></a>lm2 &lt;-<span class="st"> </span><span class="kw">localmoran.exact</span>(reg1, <span class="dt">nb =</span> qnb)</span></code></pre></div>
<p>The <code>localmoran.exact()</code> function returns a more complex object than the <code>localmoran()</code>, as you’ll see if you use <code>summary()</code>. The <code>print()</code> function extracts the useful information for plotting:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="spatial-structure-and-clustering-i.html#cb216-1"></a><span class="co"># This just converts the output to a more useful &#39;matrix&#39; format</span></span>
<span id="cb216-2"><a href="spatial-structure-and-clustering-i.html#cb216-2"></a>lm2 &lt;-<span class="st"> </span><span class="kw">print</span>(lm2)</span>
<span id="cb216-3"><a href="spatial-structure-and-clustering-i.html#cb216-3"></a></span>
<span id="cb216-4"><a href="spatial-structure-and-clustering-i.html#cb216-4"></a><span class="co"># Assign the exact p-value to the vlbw data object</span></span>
<span id="cb216-5"><a href="spatial-structure-and-clustering-i.html#cb216-5"></a>vlbw_lm<span class="op">$</span>pvalExact &lt;-<span class="st"> </span>lm2[,<span class="dv">3</span>]</span></code></pre></div>
<p>Now the object is ready for plotting using the strategy above of categorizing counties into the LISA typology, and then mapping. Here we introduce one last strategy, and then plot the three versions side by side below.</p>
</div>
<div id="local-morans-i-with-constant-risk-assumption" class="section level4" number="8.3.3.4">
<h4><span class="header-section-number">8.3.3.4</span> Local Moran’s I with constant risk assumption</h4>
<p>The functions built in to <code>spdep</code> provide helpful approaches for describing local spatial auto-correlation, but for some reason they do not extend (as the Global Moran’s I tests do) to allow for Poisson-distributed case event counts over population at risk. In other words they don’t allow us to use the <em>constant risk</em> hypothesis that the number of events can be <em>expected</em> based simply on a <em>reference rate</em> and the local <em>population at risk</em>.</p>
<p>While the functions are not automated, Bivand, et al<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> provide some code which itself is adapted from Waller &amp; Gotway, and is adapted below. We assume we already have a variable <code>expected</code> which is the product of the overall rate times the population of each county and reflects the expected count of <em>VLBW</em> babies in each county given the number of births. The designation in the steps below of <strong>CR</strong> refers to this being a <em>constant risk</em> or Poisson based hypothesis about local autocorrelation.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="spatial-structure-and-clustering-i.html#cb217-1"></a><span class="co"># Step 1 - Create the standardized deviation of observed from expected</span></span>
<span id="cb217-2"><a href="spatial-structure-and-clustering-i.html#cb217-2"></a>sdCR &lt;-<span class="st"> </span>(vlbw<span class="op">$</span>VLBW <span class="op">-</span><span class="st"> </span>vlbw<span class="op">$</span>expected) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(vlbw<span class="op">$</span>expected)</span>
<span id="cb217-3"><a href="spatial-structure-and-clustering-i.html#cb217-3"></a></span>
<span id="cb217-4"><a href="spatial-structure-and-clustering-i.html#cb217-4"></a><span class="co"># Step 2 - Create a spatially lagged version of standardized deviation of neighbors</span></span>
<span id="cb217-5"><a href="spatial-structure-and-clustering-i.html#cb217-5"></a>wsdCR &lt;-<span class="st"> </span><span class="kw">lag.listw</span>(q_listw, sdCR)</span>
<span id="cb217-6"><a href="spatial-structure-and-clustering-i.html#cb217-6"></a></span>
<span id="cb217-7"><a href="spatial-structure-and-clustering-i.html#cb217-7"></a><span class="co"># Step 3 - the local Moran&#39;s I is the product of step 1 and step 2</span></span>
<span id="cb217-8"><a href="spatial-structure-and-clustering-i.html#cb217-8"></a>vlbw_lm<span class="op">$</span>I_CR &lt;-<span class="st"> </span>sdCR <span class="op">*</span><span class="st"> </span>wsdCR</span></code></pre></div>
<p>But all we have with this <em>hand-made</em> local Moran’s I under the constant risk Poisson assumption, is the values of <span class="math inline">\(I_i\)</span>, but not the variance, or indicator of significance. Under the constant risk assumption, we can simulate the null hypothesis by generating random Poisson counts, based on local expected values, and comparing our observed event counts to the simulated distribution.</p>
<p>To conduct this simulation we must set up some parameters</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="spatial-structure-and-clustering-i.html#cb218-1"></a><span class="co"># Step 4 - setup parameters for simulation of the null distribution</span></span>
<span id="cb218-2"><a href="spatial-structure-and-clustering-i.html#cb218-2"></a></span>
<span id="cb218-3"><a href="spatial-structure-and-clustering-i.html#cb218-3"></a><span class="co"># for a random simulation, we often set a seed for random number generator</span></span>
<span id="cb218-4"><a href="spatial-structure-and-clustering-i.html#cb218-4"></a><span class="kw">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb218-5"><a href="spatial-structure-and-clustering-i.html#cb218-5"></a></span>
<span id="cb218-6"><a href="spatial-structure-and-clustering-i.html#cb218-6"></a><span class="co"># Specify number of simulations to run</span></span>
<span id="cb218-7"><a href="spatial-structure-and-clustering-i.html#cb218-7"></a>nsim &lt;-<span class="st"> </span><span class="dv">499</span></span>
<span id="cb218-8"><a href="spatial-structure-and-clustering-i.html#cb218-8"></a></span>
<span id="cb218-9"><a href="spatial-structure-and-clustering-i.html#cb218-9"></a><span class="co"># Specify dimensions of result based on number of regions</span></span>
<span id="cb218-10"><a href="spatial-structure-and-clustering-i.html#cb218-10"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(vlbw<span class="op">$</span>expected)</span>
<span id="cb218-11"><a href="spatial-structure-and-clustering-i.html#cb218-11"></a></span>
<span id="cb218-12"><a href="spatial-structure-and-clustering-i.html#cb218-12"></a><span class="co"># Create a matrix to hold results, with a row for each county, and a column for each simulation</span></span>
<span id="cb218-13"><a href="spatial-structure-and-clustering-i.html#cb218-13"></a>sims &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol =</span> nsim, <span class="dt">nrow =</span> N)</span></code></pre></div>
<p>The code below simulates the distribution under the null hypothesis of <em>constant risk</em>. In other words, what is being simulated here is not the geographic location of each value, but instead the amount of variation in rate for each county that could be expected simply due to chance and small numbers. This step is not for testing the significance of the local dependence, but instead to test the evidence for the observed rates being substantively ‘<em>unusual</em>’ as compared to expectation.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="spatial-structure-and-clustering-i.html#cb219-1"></a><span class="co"># Step 5 - Start a for-loop to iterate over simulation columns</span></span>
<span id="cb219-2"><a href="spatial-structure-and-clustering-i.html#cb219-2"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>nsim){</span>
<span id="cb219-3"><a href="spatial-structure-and-clustering-i.html#cb219-3"></a>  y &lt;-<span class="st"> </span><span class="kw">rpois</span>(N, <span class="dt">lambda =</span> vlbw<span class="op">$</span>expected) <span class="co"># generate a random event count, given expected</span></span>
<span id="cb219-4"><a href="spatial-structure-and-clustering-i.html#cb219-4"></a>  sdCRi &lt;-<span class="st"> </span>(y <span class="op">-</span><span class="st"> </span>vlbw<span class="op">$</span>expected) <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(vlbw<span class="op">$</span>expected) <span class="co"># standardized local measure</span></span>
<span id="cb219-5"><a href="spatial-structure-and-clustering-i.html#cb219-5"></a>  wsdCRi &lt;-<span class="st"> </span><span class="kw">lag.listw</span>(q_listw, sdCRi) <span class="co"># standardized spatially lagged measure</span></span>
<span id="cb219-6"><a href="spatial-structure-and-clustering-i.html#cb219-6"></a>  sims[, i] &lt;-<span class="st"> </span>sdCRi <span class="op">*</span><span class="st"> </span>wsdCRi <span class="co"># this is the I(i) statistic under this iteration of null</span></span>
<span id="cb219-7"><a href="spatial-structure-and-clustering-i.html#cb219-7"></a>}</span></code></pre></div>
<p>These next steps serve to organize the observed and simulated null results in order to characterize whether each counties <span class="math inline">\(I_i\)</span> statistic as calculated in <em>Step 3</em> above is significantly different from what we would have expected under Poisson variation.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="spatial-structure-and-clustering-i.html#cb220-1"></a><span class="co"># Step 6 - For each county, test where the observed value ranks with respect to the null simulations</span></span>
<span id="cb220-2"><a href="spatial-structure-and-clustering-i.html#cb220-2"></a>xrank &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="kw">cbind</span>(vlbw_lm<span class="op">$</span>I_CR, sims), <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="kw">rank</span>(x)[<span class="dv">1</span>])</span>
<span id="cb220-3"><a href="spatial-structure-and-clustering-i.html#cb220-3"></a></span>
<span id="cb220-4"><a href="spatial-structure-and-clustering-i.html#cb220-4"></a><span class="co"># Step 7 - Calculate the difference between observed rank and total possible (nsim)</span></span>
<span id="cb220-5"><a href="spatial-structure-and-clustering-i.html#cb220-5"></a>diff &lt;-<span class="st"> </span>nsim <span class="op">-</span><span class="st"> </span>xrank</span>
<span id="cb220-6"><a href="spatial-structure-and-clustering-i.html#cb220-6"></a>diff &lt;-<span class="st"> </span><span class="kw">ifelse</span>(diff <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, diff, <span class="dv">0</span>)</span>
<span id="cb220-7"><a href="spatial-structure-and-clustering-i.html#cb220-7"></a></span>
<span id="cb220-8"><a href="spatial-structure-and-clustering-i.html#cb220-8"></a><span class="co"># Step 8 - Assuming a uniform distribution of ranks, calculate p-value for observed</span></span>
<span id="cb220-9"><a href="spatial-structure-and-clustering-i.html#cb220-9"></a><span class="co"># given the null distribution generate from simulations</span></span>
<span id="cb220-10"><a href="spatial-structure-and-clustering-i.html#cb220-10"></a>vlbw_lm<span class="op">$</span>pvalCR &lt;-<span class="st"> </span><span class="kw">punif</span>((diff <span class="op">+</span><span class="st"> </span><span class="dv">1</span>) <span class="op">/</span><span class="st"> </span>(nsim <span class="op">+</span><span class="st"> </span><span class="dv">1</span>))</span></code></pre></div>
<p>Now we combine all of the p-values from these different strategies into a single dataset to facilitate mapping.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="spatial-structure-and-clustering-i.html#cb221-1"></a>vlbw_lm2 &lt;-<span class="st"> </span>vlbw_lm <span class="op">%&gt;%</span></span>
<span id="cb221-2"><a href="spatial-structure-and-clustering-i.html#cb221-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">lm_quad_exact =</span> <span class="kw">factor</span>(<span class="kw">case_when</span>(</span>
<span id="cb221-3"><a href="spatial-structure-and-clustering-i.html#cb221-3"></a>    <span class="co"># First, recode the LISA quadrant values using exact test</span></span>
<span id="cb221-4"><a href="spatial-structure-and-clustering-i.html#cb221-4"></a>           raw_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>pvalExact <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;High-High&#39;</span>,</span>
<span id="cb221-5"><a href="spatial-structure-and-clustering-i.html#cb221-5"></a>            raw_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>pvalExact <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;Low-Low&#39;</span>,</span>
<span id="cb221-6"><a href="spatial-structure-and-clustering-i.html#cb221-6"></a>            raw_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>pvalExact <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;Low-High&#39;</span>,</span>
<span id="cb221-7"><a href="spatial-structure-and-clustering-i.html#cb221-7"></a>            raw_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>pvalExact <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;High-Low&#39;</span>,</span>
<span id="cb221-8"><a href="spatial-structure-and-clustering-i.html#cb221-8"></a>            pvalExact <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;Non-significant&#39;</span>),</span>
<span id="cb221-9"><a href="spatial-structure-and-clustering-i.html#cb221-9"></a>           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&#39;High-High&#39;</span>,<span class="st">&#39;Low-Low&#39;</span>,<span class="st">&#39;Low-High&#39;</span>,<span class="st">&#39;High-Low&#39;</span>,<span class="st">&#39;Non-significant&#39;</span>)),</span>
<span id="cb221-10"><a href="spatial-structure-and-clustering-i.html#cb221-10"></a>    <span class="co"># Now recode the LISA quadrant values using the constant-risk simulation</span></span>
<span id="cb221-11"><a href="spatial-structure-and-clustering-i.html#cb221-11"></a>          <span class="dt">lm_quad_CR =</span> <span class="kw">factor</span>(<span class="kw">case_when</span>(</span>
<span id="cb221-12"><a href="spatial-structure-and-clustering-i.html#cb221-12"></a>           raw_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>pvalCR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;High-High&#39;</span>,</span>
<span id="cb221-13"><a href="spatial-structure-and-clustering-i.html#cb221-13"></a>            raw_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>pvalCR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;Low-Low&#39;</span>,</span>
<span id="cb221-14"><a href="spatial-structure-and-clustering-i.html#cb221-14"></a>            raw_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>pvalCR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;Low-High&#39;</span>,</span>
<span id="cb221-15"><a href="spatial-structure-and-clustering-i.html#cb221-15"></a>            raw_std <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>lag_std <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;</span><span class="st"> </span>pvalCR <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;High-Low&#39;</span>,</span>
<span id="cb221-16"><a href="spatial-structure-and-clustering-i.html#cb221-16"></a>            pvalCR <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">~</span><span class="st"> &#39;Non-significant&#39;</span>),</span>
<span id="cb221-17"><a href="spatial-structure-and-clustering-i.html#cb221-17"></a>           <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&#39;High-High&#39;</span>,<span class="st">&#39;Low-Low&#39;</span>,<span class="st">&#39;Low-High&#39;</span>,<span class="st">&#39;High-Low&#39;</span>,<span class="st">&#39;Non-significant&#39;</span>)))</span></code></pre></div>
<p>And this plot compares the three versions:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="spatial-structure-and-clustering-i.html#cb222-1"></a><span class="kw">tm_shape</span>(vlbw_lm2) <span class="op">+</span><span class="st"> </span></span>
<span id="cb222-2"><a href="spatial-structure-and-clustering-i.html#cb222-2"></a><span class="st">  </span><span class="kw">tm_fill</span>(<span class="kw">c</span>(<span class="st">&#39;lm_quad&#39;</span>, <span class="st">&#39;lm_quad_exact&#39;</span>, <span class="st">&#39;lm_quad_CR&#39;</span>),</span>
<span id="cb222-3"><a href="spatial-structure-and-clustering-i.html#cb222-3"></a>          <span class="dt">style =</span> <span class="st">&#39;cat&#39;</span>,</span>
<span id="cb222-4"><a href="spatial-structure-and-clustering-i.html#cb222-4"></a>          <span class="dt">palette =</span> <span class="kw">c</span>(<span class="st">&quot;#E41A1C&quot;</span>, <span class="st">&quot;#377EB8&quot;</span>, <span class="st">&quot;#4DAF4A&quot;</span>, <span class="st">&quot;#984EA3&quot;</span>, <span class="st">&quot;#ffffb3&quot;</span>),</span>
<span id="cb222-5"><a href="spatial-structure-and-clustering-i.html#cb222-5"></a>          <span class="dt">title =</span> <span class="kw">c</span>(<span class="st">&#39;Standard LISA&#39;</span>, <span class="st">&#39;Exact LISA&#39;</span>, <span class="st">&#39;Constant Risk&#39;</span>)) <span class="op">+</span></span>
<span id="cb222-6"><a href="spatial-structure-and-clustering-i.html#cb222-6"></a><span class="st">  </span><span class="kw">tm_borders</span>() <span class="op">+</span></span>
<span id="cb222-7"><a href="spatial-structure-and-clustering-i.html#cb222-7"></a><span class="st">  </span><span class="kw">tm_layout</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="st">&#39;RIGHT&#39;</span>,<span class="st">&#39;TOP&#39;</span>),</span>
<span id="cb222-8"><a href="spatial-structure-and-clustering-i.html#cb222-8"></a>            <span class="dt">inner.margins =</span> <span class="kw">c</span>(<span class="fl">0.02</span>,.<span class="dv">02</span>,<span class="fl">0.1</span>, <span class="fl">0.1</span>))</span></code></pre></div>
<p><img src="EPI563-SpatialEPI_files/figure-html/unnamed-chunk-228-1.png" width="672" /></p>
<p>As you can see there is some overlap among the methods, and also notable variations, with the most noticeable difference with the final simulated version under constant Poisson risk. While the <em>standard</em> and <em>exact</em> approach will remain the same each time you run the analysis, because of the random simulation, the <em>constant risk</em> approach could change with each instance, and in particular, there could be changes if you increase the <code>nsim</code> parameter to have more simulations of the null hypothesis.</p>
<p>Overall it seems that there is relatively consistent evidence of clustered high risk in Southwest Georgia, although the exact counties included varies. There is also evidence (especially in the exact and constant risk maps) of clustered low-risk counties in North Georgia. Although the discrepancy among methods could be disconcerting two things should be kept in mind when interpreting <strong>any</strong> local clustering analysis.</p>
<ol style="list-style-type: decimal">
<li>Local cluster detection is an exploratory process that is most useful for description, hypothesis generation, and guiding further investigation. Caution should be taken against strong inference about individual counties being <strong>in</strong> versus <strong>out</strong> of hotspots, instead using the tools to identify evidence of regional extremes.</li>
<li>LISA statistics (and all cluster strategies) rely heavily on null-hypothesis significance testing. We know as epidemiologists that too much weight can be put on the arbitrary achievement of a test statistic moving across a largely meaningless threshold value. If you align the maps above with past maps in Disease Mapping modules, the counties highlighted as high and low are not surprising. The differences among these strategies relies on statistical efficiency, power to detect true deviations, and alignment of the real world with statistical assumptions. Therefore, use these results as tools for understanding but be cautious about using them as strong decision tools.</li>
</ol>

</div>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Bivand RS, Pebesma E, Gomez-Rubio V. Applied Spatial Data Analysis with R, 2nd edition. 2013. New York. Springer<a href="spatial-structure-and-clustering-i.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="disease-mapping-iv.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-structure-and-clustering-ii.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mkram01/EPI563-SpatialEPI/edit/master/08-spatial-cluster-1.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"toc_depth": 2,
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
